{
    "errorCollection": {
        "errorMessages": [], 
        "errors": {}
    }, 
    "fields": [], 
    "removedContentIds": {}, 
    "atl_token": "APH4-RW9H-DTE9-IR2M|5220db4f7e1e7ad841d4a5a852e3f532a14ef3ce|lout", 
    "panels": {
        "leftPanels": [
            {
                "weight": 100, 
                "headerLinks": {
                    "groups": [], 
                    "links": []
                }, 
                "contentId": "e2fcce0d584fb4f3ac73b9d705958225", 
                "subpanelHtmls": [], 
                "label": "Details", 
                "completeKey": "com.atlassian.jira.jira-view-issue-plugin:details-module", 
                "prefix": "", 
                "html": "\n\n\n\n\n\n\n\n\n\n\n<ul id=\"issuedetails\" class=\"property-list two-cols\">\n                \n<li class=\"item\">\n    <div class=\"wrap\">\n        <strong class=\"name\">Type:</strong>\n        <span id=\"type-val\" class=\"value\">\n                        <img  alt=\"\" height=\"16\" src=\"/secure/viewavatar?size=xsmall&amp;avatarId=11103&amp;avatarType=issuetype\" title=\"Bug - A problem which impairs or prevents the functions of the product.\" width=\"16\" /> Bug\n        </span>\n    </div>\n</li>                    <li class=\"item item-right\">\n    <div class=\"wrap\">\n        <strong class=\"name\">Status:</strong>\n            <span id=\"status-val\" class=\"value\">\n                                <span class=\" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done jira-issue-status-lozenge-max-width-medium\" data-tooltip=\"&lt;span class=&quot;jira-issue-status-tooltip-title&quot;&gt;Resolved&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;jira-issue-status-tooltip-desc&quot;&gt;A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.&lt;/span&gt;\">Resolved</span>            </span>\n            </div>\n</li>    \n                        <li class=\"item new\">\n    <div class=\"wrap\">\n        <strong class=\"name\">Priority:</strong>\n        <span id=\"priority-val\" class=\"value\">\n                                        <img  alt=\"\" height=\"16\" src=\"/images/icons/priorities/major.svg\" title=\"Major - Major loss of function.\" width=\"16\" /> Major\n                    </span>\n    </div>\n</li>                                \n<li class=\"item item-right\">\n    <div class=\"wrap\">\n        <strong class=\"name\">Resolution:</strong>\n        <span id=\"resolution-val\" class=\"value resolved\" >\n                             Fixed\n                    </span>\n    </div>\n</li>                                \n\n<li class=\"item\">\n    <div class=\"wrap\">\n        <strong class=\"name\">Affects Version/s:</strong>\n        <span id=\"versions-val\" class=\"value\">\n                                        None\n                    </span>\n    </div>\n</li>                                \n<li class=\"item item-right\">\n    <div class=\"wrap\">\n        <strong class=\"name\">Fix Version/s:</strong>\n        <span id=\"fixfor-val\" class=\"value\">\n                                        None\n                    </span>\n    </div>\n</li>                                \n\n<li class=\"item\">\n    <div class=\"wrap\">\n        <strong class=\"name\">Component/s:</strong>\n        <span id=\"components-val\" class=\"value\">\n                                        <span class=\"shorten\" id=\"components-field\">\n                                            <a href=\"/issues/?jql=project+%3D+LOGBACK+AND+component+%3D+logback-core\" title=\"logback-core \">logback-core</a>                                    </span>\n                    </span>\n    </div>\n</li>                                    \n\n\n<li class=\"item full-width\">\n    <div class=\"wrap\" id=\"wrap-labels\">\n        <strong class=\"name\">Labels:</strong>\n                <div class=\"labels-wrap value\">\n            <span class=\"labels\" id=\"labels-10978-value\">None</span>\n            </div>\n    </div>\n</li>                                <li class=\"item full-width\">\n    <div class=\"wrap\">\n        <strong class=\"name\">Environment:</strong>\n        <div id=\"environment-val\" class=\"value\">\n                                          <p>Windows XP, Java 1.6.0_27</p>\n      \n                    </div>\n    </div>\n</li>        </ul>\n\n", 
                "renderHeader": true, 
                "styleClass": "", 
                "id": "details-module"
            }, 
            {
                "weight": 200, 
                "headerLinks": {
                    "groups": [], 
                    "links": []
                }, 
                "contentId": "d1b5b78d8134a38bf2220b0f44f955ab", 
                "subpanelHtmls": [], 
                "label": "Description", 
                "completeKey": "com.atlassian.jira.jira-view-issue-plugin:descriptionmodule", 
                "prefix": "", 
                "html": "<div id=\"description-val\" class=\"field-ignore-highlight\">\n    <div class=\"user-content-block\">\n                    <p>I am using the RollingFileAppender with TimeBasedRolliingPolicy. The application is a desktop utility that may be run several times per day but is almost never running at midnight when the roll would normally occur.<br/>\nThe log file naming is working correctly - each day's file is date stamped, but the MaxHistory is not working at all since it is not enforced at app startup.</p>\n\n<p>Pertinent config section:<br/>\n  &lt;appender name=\"FILE\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt;<br/>\n    &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.TimeBasedRollingPolicy\"&gt;<br/>\n      &lt;fileNamePattern&gt;MyApp_%d.log&lt;/fileNamePattern&gt;    &lt;!-- Daily rollover --&gt;<br/>\n      &lt;maxHistory&gt;7&lt;/maxHistory&gt;     &lt;!-- keep 1 week history --&gt;<br/>\n    &lt;/rollingPolicy&gt;<br/>\n    &lt;encoder&gt;<br/>\n      &lt;pattern&gt;%date %-5level <span class=\"error\">&#91;%thread&#93;</span> %logger</p>\n{10}\n<p> %msg%n&lt;/pattern&gt;<br/>\n    &lt;/encoder&gt;<br/>\n  &lt;/appender&gt;</p>\n\n<p>I found what I believe is the source of the issue in TimeBasedFileNamingAndTriggeringPolicyBase:<br/>\n  public void start() {<br/>\n    ...<br/>\n    setDateInCurrentPeriod(new Date(getCurrentTime()));<br/>\n    if (tbrp.getParentsRawFileProperty() != null) {<br/>\n      File currentFile = new File(tbrp.getParentsRawFileProperty());<br/>\n      if (currentFile.exists() &amp;&amp; currentFile.canRead()) </p>\n{\n        setDateInCurrentPeriod(new Date(currentFile.lastModified()));\n      }\n<p>    }</p>\n\n<p>    addInfo(\"Setting initial period to \" + dateInCurrentPeriod);<br/>\n    computeNextCheck();<br/>\n  }</p>\n\n<p>Since there is no parentsRawFileProperty, this uses the current time and sets the next check at midnight tonight. Therefore the check is not run at startup, and in my case is never run. This would work fine if dateInCurrentPeriod was set to anything before today. I would suggest the following change:</p>\n\n<p>  public void start() {<br/>\n    ...<br/>\n    File currentFile = new File(tbrp.getActiveFileName()); // Use same logic if ParentsRawFileProperty is set or not.<br/>\n    if (currentFile.exists() &amp;&amp; currentFile.canRead()) </p>\n{\n      setDateInCurrentPeriod(new Date(currentFile.lastModified()));\n    }\n<p> else </p>\n{\n      setDateInCurrentPeriod(0); // No current file found, force a triggering event\n      // or if the above is too brute-force: setDateInCurrentPeriod(rc.getRelativeDate(new Date(), -1));\n    }\n\n<p>    addInfo(\"Setting initial period to \" + dateInCurrentPeriod);<br/>\n    computeNextCheck();<br/>\n  }</p>\n\n<p>Note - this was originally reported as a comment on <a href=\"https://jira.qos.ch/browse/LOGBACK-162\" title=\"RollingPolicy MaxHistory not deleting old files\" class=\"issue-link\" data-issue-key=\"LOGBACK-162\"><del>LBCORE-147</del></a>; moved here to be tracked as a separate issue.</p>\n\n<p>Thanks,<br/>\n-Bruce</p>\n            </div>\n</div>\n", 
                "renderHeader": true, 
                "styleClass": "", 
                "id": "descriptionmodule"
            }, 
            {
                "weight": 300, 
                "headerLinks": {
                    "groups": [], 
                    "links": []
                }, 
                "contentId": "6d908a7160df2586b26e1d86a1ad3e4b", 
                "subpanelHtmls": [], 
                "label": "Attachments", 
                "completeKey": "com.atlassian.jira.plugins.jira-dnd-attachment-plugin:dnd-metadata", 
                "prefix": "", 
                "html": "<div id=\"dnd-metadata-webpanel\" data-can-attach=\"false\" data-project-type=\"software\" data-upload-limit=\"10485760\"></div>", 
                "renderHeader": true, 
                "styleClass": "", 
                "id": "dnd-metadata"
            }, 
            {
                "weight": 400, 
                "headerLinks": {
                    "groups": [], 
                    "links": []
                }, 
                "contentId": "17f4baf53898daa25874ce8d73e2a086", 
                "subpanelHtmls": [], 
                "label": "Issue Links", 
                "completeKey": "com.atlassian.jira.jira-view-issue-plugin:linkingmodule", 
                "prefix": "", 
                "html": "\n\n\n\n\n\n\n<div class=\"links-container\" data-default-link-icon=\"/images/icons/generic_link_16.png\">\n                <dl class=\"links-list \">\n            <dt title=\"depends on\">depends on</dt>\n                            <dd id=\"internal-10751_10000\"\n                                                                            >\n                    <div class=\"link-content\">\n                                                    \n\n\n\n<p>\n            <img src=\"/secure/viewavatar?size=xsmall&amp;avatarId=11103&amp;avatarType=issuetype\" width=\"16\" height=\"16\" title=\"Bug - A problem which impairs or prevents the functions of the product.\" alt=\"Bug - A problem which impairs or prevents the functions of the product.\" />\n        <span title=\"LOGBACK-162: RollingPolicy MaxHistory not deleting old files\">\n        <a href=\"/browse/LOGBACK-162\" data-issue-key=\"LOGBACK-162\" class=\"issue-link link-title resolution\">LOGBACK-162</a>\n        <span class=\"link-summary\">RollingPolicy MaxHistory not deleting old files</span>\n    </span>\n</p>\n<ul class=\"link-snapshot\">\n        <li class=\"priority\">        <img src=\"/images/icons/priorities/major.svg\" width=\"16\" height=\"16\" title=\"Major - Major loss of function.\" alt=\"Major - Major loss of function.\" />\n    </li>\n                <li class=\"status\">\n                        <span class=\" jira-issue-status-lozenge aui-lozenge jira-issue-status-lozenge-green jira-issue-status-lozenge-done aui-lozenge-subtle jira-issue-status-lozenge-max-width-short\" data-tooltip=\"&lt;span class=&quot;jira-issue-status-tooltip-title&quot;&gt;Resolved&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;jira-issue-status-tooltip-desc&quot;&gt;A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.&lt;/span&gt;\">Resolved</span>\n                    </li>\n    </ul>\n                                            </div>\n                                    </dd>\n                    </dl>\n        </div>\n", 
                "renderHeader": true, 
                "styleClass": "", 
                "id": "linkingmodule"
            }, 
            {
                "weight": 900, 
                "headerLinks": {
                    "groups": [], 
                    "links": []
                }, 
                "contentId": "7c3b6d5c4fb77e1e582c27fae34ebbbb", 
                "subpanelHtmls": [], 
                "label": "Activity", 
                "completeKey": "com.atlassian.jira.jira-view-issue-plugin:activitymodule", 
                "prefix": "", 
                "html": "\n<big-pipe data-id=\"activity-panel-pipe-id\" style=\"height: 70px\">\n    <div></div>\n</big-pipe>\n", 
                "renderHeader": true, 
                "styleClass": "", 
                "id": "activitymodule"
            }
        ], 
        "rightPanels": [
            {
                "weight": 10, 
                "headerLinks": {
                    "groups": [], 
                    "links": []
                }, 
                "contentId": "959043c3d44f634a88de12b09946de60", 
                "subpanelHtmls": [], 
                "label": "People", 
                "completeKey": "com.atlassian.jira.jira-view-issue-plugin:peoplemodule", 
                "prefix": "", 
                "html": "\n\n\n\n\n\n<ul class=\"item-details\" id=\"peopledetails\">\n    <li class=\"people-details\">\n                                \n<dl>\n    <dt>Assignee:</dt>\n    <dd>\n        <span id=\"assignee-val\" class=\"view-issue-field\">\n\n            <span class=\"user-hover\" id=\"issue_summary_assignee_ceki\" rel=\"ceki\" data-user='{&quot;avatarUrl&quot;:&quot;https://jira.qos.ch/secure/useravatar?size=xsmall&amp;avatarId=10122&quot;,&quot;displayName&quot;:&quot;Ceki G\u00fclc\u00fc&quot;,&quot;emailAddress&quot;:&quot;ceki+jira@qos.ch&quot;,&quot;username&quot;:&quot;ceki&quot;}'>\n            \n\n    <span class=\"aui-avatar aui-avatar-small\"><span class=\"aui-avatar-inner\"><img src=\"https://jira.qos.ch/secure/useravatar?size=small&amp;avatarId=10122\" alt=\"ceki\" /></span></span>\n            Ceki G\u00fclc\u00fc\n        </span>\n    </span>\n            </dd>\n</dl>                                            \n<dl>\n    <dt>Reporter:</dt>\n    <dd>\n        <span id=\"reporter-val\" class=\"view-issue-field\">\n\n            <span class=\"user-hover\" id=\"issue_summary_reporter_birving\" rel=\"birving\" data-user='{&quot;avatarUrl&quot;:&quot;https://jira.qos.ch/secure/useravatar?size=xsmall&amp;avatarId=10122&quot;,&quot;displayName&quot;:&quot;Bruce E. Irving&quot;,&quot;emailAddress&quot;:&quot;bei@brmw.com&quot;,&quot;username&quot;:&quot;birving&quot;}'>\n            \n\n    <span class=\"aui-avatar aui-avatar-small\"><span class=\"aui-avatar-inner\"><img src=\"https://jira.qos.ch/secure/useravatar?size=small&amp;avatarId=10122\" alt=\"birving\" /></span></span>\n            Bruce E. Irving\n        </span>\n    </span>\n    </dd>\n</dl>                        </li>\n</ul>\n    <ul class=\"item-details\">\n        <li>\n                            <dl>\n        <dt>Votes:</dt>\n        <dd>\n                                <span id=\"vote-data\" class=\"aui-badge vote-state-off\">0</span>\n            \n                                                <span id=\"vote-label\" title=\"You have to be logged in to vote for an issue.\">Vote for this issue</span>\n                    </dd>\n    </dl>\n                                <dl>\n        <dt>Watchers:</dt>\n        <dd>\n                                \n                                    <span id=\"watcher-data\" class=\"aui-badge watch-state-off\">3</span>\n            \n                                        <span id=\"watch-label\" title=\"You have to be logged in to watch an issue.\">Start watching this issue</span>\n                    </dd>\n    </dl>\n            </li>\n    </ul>\n", 
                "renderHeader": true, 
                "styleClass": "", 
                "id": "peoplemodule"
            }, 
            {
                "weight": 40, 
                "headerLinks": {
                    "groups": [], 
                    "links": []
                }, 
                "contentId": "3de7732a5e867b3bebeee7aaae4bd0fa", 
                "subpanelHtmls": [], 
                "label": "Dates", 
                "completeKey": "com.atlassian.jira.jira-view-issue-plugin:datesmodule", 
                "prefix": "", 
                "html": "\n<ul class=\"item-details\">\n    <li>\n            <dl class=\"dates\">\n            <dt>Created:</dt>\n            <dd class=\"date user-tz\"  title=\"28/Sep/11 4:58 PM\" >\n                <span data-name=\"Created\" id=\"created-val\"  data-fieldtype=\"datetime\"  >\n                                                                                                        <time class=\"livestamp\" datetime=\"2011-09-28T16:58:10+0200\">28/Sep/11 4:58 PM</time>                                                                                         </span>\n            </dd>\n        </dl>\n            <dl class=\"dates\">\n            <dt>Updated:</dt>\n            <dd class=\"date user-tz\"  title=\"12/Jun/12 11:59 AM\" >\n                <span data-name=\"Updated\" id=\"updated-val\"  data-fieldtype=\"datetime\"  >\n                                                                                                        <time class=\"livestamp\" datetime=\"2012-06-12T11:59:25+0200\">12/Jun/12 11:59 AM</time>                                                                                         </span>\n            </dd>\n        </dl>\n            <dl class=\"dates\">\n            <dt>Resolved:</dt>\n            <dd class=\"date user-tz\"  title=\"08/Nov/11 8:21 PM\" >\n                <span data-name=\"Resolved\" id=\"resolutiondate-val\"  data-fieldtype=\"datetime\"  >\n                                                                                                        <time class=\"livestamp\" datetime=\"2011-11-08T20:21:17+0100\">08/Nov/11 8:21 PM</time>                                                                                         </span>\n            </dd>\n        </dl>\n        </li>\n</ul>\n", 
                "renderHeader": true, 
                "styleClass": "", 
                "id": "datesmodule"
            }
        ], 
        "infoPanels": []
    }, 
    "issue": {
        "operations": {
            "linkGroups": [
                {
                    "groups": [
                        {
                            "groups": [], 
                            "id": "ops-login-lnk_container", 
                            "links": [
                                {
                                    "href": "/login.jsp?os_destination=%2Fsecure%2FAjaxIssueAction%21default.jspa%3FissueKey%3DLOGBACK-92%26decorator%3Dnone%26prefetch%3Dfalse%26shouldUpdateCurrentProject%3Dfalse%26loadFields%3Dfalse%26_%3D1541138840233", 
                                    "contentId": "2808440b9fa1047598d275e87398be8e", 
                                    "title": "Log In", 
                                    "id": "ops-login-lnk", 
                                    "label": "Log In"
                                }
                            ]
                        }
                    ], 
                    "id": "view.issue.opsbar", 
                    "links": []
                }, 
                {
                    "groups": [
                        {
                            "groups": [], 
                            "header": {
                                "iconClass": "icon-default aui-icon aui-icon-small aui-iconfont-export", 
                                "title": "Export this issue in another format", 
                                "id": "viewissue-export", 
                                "label": "Export"
                            }, 
                            "id": "view.issue.exports", 
                            "links": [
                                {
                                    "contentId": "d943aeefd73a7dcc5e646b457aaaa5e6", 
                                    "href": "/si/jira.issueviews:issue-xml/LOGBACK-92/LOGBACK-92.xml", 
                                    "id": "jira.issueviews:issue-xml", 
                                    "label": "XML"
                                }, 
                                {
                                    "contentId": "be4c1409620560d8addfa72142196c87", 
                                    "href": "/si/jira.issueviews:issue-word/LOGBACK-92/LOGBACK-92.doc", 
                                    "id": "jira.issueviews:issue-word", 
                                    "label": "Word"
                                }, 
                                {
                                    "contentId": "d9b25cabc8ed217a336d0911652ba2ce", 
                                    "href": "/si/jira.issueviews:issue-html/LOGBACK-92/LOGBACK-92.html", 
                                    "id": "jira.issueviews:issue-html", 
                                    "label": "Printable"
                                }
                            ]
                        }
                    ], 
                    "id": "jira.issue.tools", 
                    "links": []
                }
            ]
        }, 
        "status": {
            "id": "5", 
            "iconUrl": "/images/icons/statuses/resolved.png", 
            "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", 
            "name": "Resolved"
        }, 
        "isEditable": false, 
        "summaryContentId": "a3b2e0cdd061015772cb7815f0a4aaa7", 
        "summary": "TimeBasedRollingPolicy does not trigger at application startup - MaxHistory not working", 
        "project": {
            "projectType": "software", 
            "name": "logback", 
            "avatarUrls": {
                "24x24": "https://jira.qos.ch/secure/projectavatar?size=small&pid=10040&avatarId=10402", 
                "32x32": "https://jira.qos.ch/secure/projectavatar?size=medium&pid=10040&avatarId=10402", 
                "48x48": "https://jira.qos.ch/secure/projectavatar?pid=10040&avatarId=10402", 
                "16x16": "https://jira.qos.ch/secure/projectavatar?size=xsmall&pid=10040&avatarId=10402"
            }, 
            "key": "LOGBACK", 
            "systemAvatar": false, 
            "id": 10040
        }, 
        "key": "LOGBACK-92", 
        "id": 10978, 
        "metadata": {
            "issue-project-type": "software", 
            "issue-key": "LOGBACK-92", 
            "can-search-users": "false", 
            "default-avatar-url": "https://jira.qos.ch/secure/useravatar?size=xsmall&avatarId=10123", 
            "can-edit-watchers": "false"
        }
    }, 
    "readTime": 1552217388638
}